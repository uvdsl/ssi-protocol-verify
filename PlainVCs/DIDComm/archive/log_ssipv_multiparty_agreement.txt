File "ssipv_issuing.pv", line 141, characters 9-11:
Warning: identifier msg rebound.
File "ssipv_issuing.pv", line 147, characters 9-11:
Warning: identifier msg rebound.
File "ssipv_issuing.pv", line 157, character 10:
Warning: identifier x rebound.
File "ssipv_issuing.pv", line 160, characters 9-11:
Warning: identifier msg rebound.
File "ssipv_issuing.pv", line 179, character 10:
Warning: identifier x rebound.
File "ssipv_issuing.pv", line 226, characters 9-11:
Warning: identifier msg rebound.
File "ssipv_issuing.pv", line 236, character 10:
Warning: identifier x rebound.
File "ssipv_issuing.pv", line 239, characters 9-11:
Warning: identifier msg rebound.
File "ssipv_issuing.pv", line 249, characters 9-11:
Warning: identifier msg rebound.
File "ssipv_issuing.pv", line 259, character 10:
Warning: identifier x rebound.
File "ssipv_issuing.pv", line 289, characters 9-11:
Warning: identifier msg rebound.
File "ssipv_issuing.pv", line 347, characters 9-11:
Warning: identifier msg rebound.
File "ssipv_issuing.pv", line 353, characters 9-11:
Warning: identifier msg rebound.
File "ssipv_issuing.pv", line 366, character 10:
Warning: identifier x rebound.
File "ssipv_issuing.pv", line 423, character 10:
Warning: identifier x rebound.
File "ssipv_issuing.pv", line 426, characters 9-11:
Warning: identifier msg rebound.
File "ssipv_issuing.pv", line 443, characters 9-11:
Warning: identifier msg rebound.
Process 0 (that is, the initial process):
{1}new sk_prover: SecretKey;
{2}new sk_verifier: SecretKey;
{3}new sk_issuer: SecretKey;
{4}out(h, pk(sk_issuer));
{5}out(h, pk(sk_verifier));
{6}out(h, pk(sk_prover));
{7}out(h, genDID(pk(sk_prover),sk_prover));
{8}out(h, genDID(pk(sk_verifier),sk_verifier));
{9}out(h, genDID(pk(sk_issuer),sk_issuer));
{10}let acr: ACR = makeRule(genDID(pk(sk_prover),sk_prover),attr,genDID(pk(sk_issuer),sk_issuer)) in
{11}let acr_otherAgent: ACR = makeRule(genDID(pk(sk_otherAgent),sk_otherAgent),attr,genDID(pk(sk_issuer),sk_issuer)) in
{12}let acr_compromisedIssuer: ACR = makeRule(genDID(pk(sk_prover),sk_prover),attr,genDID(pk(sk_otherAgent),sk_otherAgent)) in
{13}let acr_compromised: ACR = makeRule(genDID(pk(sk_otherAgent),sk_otherAgent),attr,genDID(pk(sk_otherAgent),sk_otherAgent)) in
(
    {14}!
    {15}let sk: SecretKey = sk_issuer in
    {16}let attr_1: bitstring = attr in
    {17}let expectedDID: DID = genDID(pk(sk_prover),sk_prover) in
    {18}let talksOnlyToHonest: bool = true in
    {19}in(h, x: bitstring);
    {20}let msg_handshakeReq: bitstring = x in
    {21}let sgndMsg: bitstring = adec(x,sk) in
    {22}let (unauth_n_p: bitstring,unauth_spk_p: PublicKey) = getMsg(sgndMsg) in
    {23}let (n_p: bitstring,spk_p: PublicKey) = auth(sgndMsg,unauth_spk_p) in
    {24}new ssk: SecretKey;
    {25}new n_i: bitstring;
    {26}let msg: bitstring = (n_p,n_i,pk(ssk)) in
    {27}let msg_handshakeResp: bitstring = aenc(sign(msg,sk),spk_p) in
    {28}out(h, msg_handshakeResp);
    {29}in(h, x_1: bitstring);
    {30}let msg_did: bitstring = x_1 in
    {31}let sk_1: SecretKey = ssk in
    {32}let msg_1: bitstring = auth(adec(x_1,sk_1),spk_p) in
    {33}let (unauth_n'_i: bitstring,unauth_proverDID: DID,unauth_recipientDID: DID) = getMsg(msg_1) in
    {34}let pk_p: PublicKey = getPubKey(unauth_proverDID) in
    {35}let (n'_i: bitstring,proverDID: DID,recipientDID: DID) = auth(msg_1,pk_p) in
    {36}if (proverDID = expectedDID) then
    {37}if (n'_i = n_i) then
    {38}if (recipientDID = genDID(pk(sk),sk)) then
    {39}let cred: VC = issueVC(proverDID,attr_1,sk) in
    {40}new n_issuing: bitstring;
    {41}let msg_2: bitstring = (cred,proverDID,n_issuing) in
    {42}let sk_2: SecretKey = ssk in
    {43}let msg_cred: bitstring = aenc(sign(msg_2,sk_2),spk_p) in
    {44}event auth_IssuerSendsLastMessageToHolder(msg_handshakeReq,msg_handshakeResp,msg_did,msg_cred);
    {45}out(h, msg_cred);
    {46}if talksOnlyToHonest then
    (
        {47}event auth_IssuerCompletesProtocol(msg_handshakeReq,msg_handshakeResp,msg_did)
    ) | (
        {48}out(ch(n_p), n_p_fromIssuer)
    ) | (
        {49}out(chC(cred), cred_fromIssuer)
    ) | (
        {50}out(ch((cred,proverDID,n_issuing)), credIssuing_fromIssuer)
    )
) | (
    {51}!
    {52}let sk_3: SecretKey = sk_issuer in
    {53}let attr_2: bitstring = attr in
    {54}let expectedDID_1: DID = genDID(pk(sk_otherAgent),sk_otherAgent) in
    {55}let talksOnlyToHonest_1: bool = false in
    {56}in(h, x_2: bitstring);
    {57}let msg_handshakeReq_1: bitstring = x_2 in
    {58}let sgndMsg_1: bitstring = adec(x_2,sk_3) in
    {59}let (unauth_n_p_1: bitstring,unauth_spk_p_1: PublicKey) = getMsg(sgndMsg_1) in
    {60}let (n_p_1: bitstring,spk_p_1: PublicKey) = auth(sgndMsg_1,unauth_spk_p_1) in
    {61}new ssk_1: SecretKey;
    {62}new n_i_1: bitstring;
    {63}let msg_3: bitstring = (n_p_1,n_i_1,pk(ssk_1)) in
    {64}let msg_handshakeResp_1: bitstring = aenc(sign(msg_3,sk_3),spk_p_1) in
    {65}out(h, msg_handshakeResp_1);
    {66}in(h, x_3: bitstring);
    {67}let msg_did_1: bitstring = x_3 in
    {68}let sk_4: SecretKey = ssk_1 in
    {69}let msg_4: bitstring = auth(adec(x_3,sk_4),spk_p_1) in
    {70}let (unauth_n'_i_1: bitstring,unauth_proverDID_1: DID,unauth_recipientDID_1: DID) = getMsg(msg_4) in
    {71}let pk_p_1: PublicKey = getPubKey(unauth_proverDID_1) in
    {72}let (n'_i_1: bitstring,proverDID_1: DID,recipientDID_1: DID) = auth(msg_4,pk_p_1) in
    {73}if (proverDID_1 = expectedDID_1) then
    {74}if (n'_i_1 = n_i_1) then
    {75}if (recipientDID_1 = genDID(pk(sk_3),sk_3)) then
    {76}let cred_1: VC = issueVC(proverDID_1,attr_2,sk_3) in
    {77}new n_issuing_1: bitstring;
    {78}let msg_5: bitstring = (cred_1,proverDID_1,n_issuing_1) in
    {79}let sk_5: SecretKey = ssk_1 in
    {80}let msg_cred_1: bitstring = aenc(sign(msg_5,sk_5),spk_p_1) in
    {81}event auth_IssuerSendsLastMessageToHolder(msg_handshakeReq_1,msg_handshakeResp_1,msg_did_1,msg_cred_1);
    {82}out(h, msg_cred_1);
    {83}if talksOnlyToHonest_1 then
    (
        {84}event auth_IssuerCompletesProtocol(msg_handshakeReq_1,msg_handshakeResp_1,msg_did_1)
    ) | (
        {85}out(ch(n_p_1), n_p_fromIssuer)
    ) | (
        {86}out(chC(cred_1), cred_fromIssuer)
    ) | (
        {87}out(ch((cred_1,proverDID_1,n_issuing_1)), credIssuing_fromIssuer)
    )
) | (
    {88}!
    {89}let sk_6: SecretKey = sk_prover in
    {90}let issuerDID: DID = genDID(pk(sk_issuer),sk_issuer) in
    {91}let verifierDID: DID = genDID(pk(sk_verifier),sk_verifier) in
    {92}let talksOnlyToHonest_2: bool = true in
    {93}let pk_i: PublicKey = getPubKey(issuerDID) in
    {94}new ssk_2: SecretKey;
    {95}new n_p_2: bitstring;
    {96}let msg_6: bitstring = (n_p_2,pk(ssk_2)) in
    {97}let sk_7: SecretKey = ssk_2 in
    {98}let msg_handshakeReq_2: bitstring = aenc(sign(msg_6,sk_7),pk_i) in
    {99}out(h, msg_handshakeReq_2);
    {100}in(h, x_4: bitstring);
    {101}let msg_handshakeResp_2: bitstring = x_4 in
    {102}let sk_8: SecretKey = ssk_2 in
    {103}let msg_7: bitstring = auth(adec(x_4,sk_8),pk_i) in
    {104}let (n'_p: bitstring,n_i_2: bitstring,spk_i: PublicKey) = msg_7 in
    {105}if (n'_p = n_p_2) then
    {106}let msg_8: bitstring = sign((n_i_2,genDID(pk(sk_6),sk_6),issuerDID),sk_6) in
    {107}let sk_9: SecretKey = ssk_2 in
    {108}let msg_did_2: bitstring = aenc(sign(msg_8,sk_9),spk_i) in
    {109}event auth_HolderSendsLastMessageToIssuer(msg_handshakeReq_2,msg_handshakeResp_2,msg_did_2);
    {110}out(h, msg_did_2);
    {111}in(h, x_5: bitstring);
    {112}let msg_credential: bitstring = x_5 in
    {113}let sk_10: SecretKey = ssk_2 in
    {114}let (credential: VC,recipientDID_2: DID,n_issuing_2: bitstring) = auth(adec(x_5,sk_10),spk_i) in
    {115}if (recipientDID_2 = genDID(pk(sk_6),sk_6)) then
    (
        {116}!
        {117}let pk_v: PublicKey = getPubKey(verifierDID) in
        {118}new ssk_3: SecretKey;
        {119}new n_p_3: bitstring;
        {120}let msg_9: bitstring = (n_p_3,pk(ssk_3)) in
        {121}let sk_11: SecretKey = ssk_3 in
        {122}let msg_handshakeReq_3: bitstring = aenc(sign(msg_9,sk_11),pk_v) in
        {123}out(h, msg_handshakeReq_3);
        {124}in(h, x_6: bitstring);
        {125}let msg_handshakeResp_3: bitstring = x_6 in
        {126}let sk_12: SecretKey = ssk_3 in
        {127}let msg_10: bitstring = auth(adec(x_6,sk_12),pk_v) in
        {128}let (n'_p_1: bitstring,n_v: bitstring,spk_v: PublicKey) = msg_10 in
        {129}if (n'_p_1 = n_p_3) then
        {130}let msg_11: bitstring = (n_v,uri) in
        {131}let sk_13: SecretKey = ssk_3 in
        {132}let msg_uri: bitstring = aenc(sign(msg_11,sk_13),spk_v) in
        {133}out(h, msg_uri);
        {134}in(h, x_7: bitstring);
        {135}let msg_rule: bitstring = x_7 in
        {136}let sk_14: SecretKey = ssk_3 in
        {137}let msg_12: bitstring = auth(adec(x_7,sk_14),spk_v) in
        {138}let (n_c: bitstring,rule: ACR) = msg_12 in
        {139}if (getVcAsTuple(credential) = getRuleAsTuple(rule)) then
        {140}let vp: bitstring = sign((n_c,verifierDID,credential),sk_6) in
        {141}let sk_15: SecretKey = ssk_3 in
        {142}let msg_vp: bitstring = aenc(sign(vp,sk_15),spk_v) in
        {143}event auth_ProverSendsLastMessageToVerifier(msg_handshakeReq_3,msg_handshakeResp_3,msg_uri,msg_rule,msg_vp);
        {144}event auth_ProverSendsLastMessageToVerifierInProtocolFull(msg_handshakeReq_2,msg_handshakeResp_2,msg_did_2,msg_credential,msg_handshakeReq_3,msg_handshakeResp_3,msg_uri,msg_rule,msg_vp);
        {145}out(h, msg_vp);
        {146}in(h, x_8: bitstring);
        {147}let msg_accessToken: bitstring = x_8 in
        {148}let sk_16: SecretKey = ssk_3 in
        {149}let (access_token: bitstring,recipientDID_3: DID) = auth(adec(x_8,sk_16),spk_v) in
        {150}if (recipientDID_3 = genDID(pk(sk_6),sk_6)) then
        {151}if talksOnlyToHonest_2 then
        (
            {152}event auth_ProverCompletesProtocol(msg_handshakeReq_3,msg_handshakeResp_3,msg_uri,msg_rule,msg_vp,msg_accessToken)
        ) | (
            {153}out(ch(n_p_3), n_p_fromProver)
        ) | (
            {154}out(chR(rule), rule_fromProver)
        ) | (
            {155}out(ch((n_c,verifierDID,credential)), unsigned_vp_fromProver)
        ) | (
            {156}out(ch(vp), vp_fromProver)
        ) | (
            {157}out(chC(credential), cred_fromProver)
        ) | (
            {158}out(ch(access_token), access_token_fromProver)
        )
    ) | (
        {159}if talksOnlyToHonest_2 then
        (
            {160}event auth_HolderCompletesProtocol(msg_handshakeReq_2,msg_handshakeResp_2,msg_did_2,msg_credential)
        ) | (
            {161}out(ch(n_p_2), n_p_fromHolder)
        ) | (
            {162}out(ch(n_i_2), n_i_fromHolder)
        ) | (
            {163}out(ch((n_i_2,genDID(pk(sk_6),sk_6),issuerDID)), providingDID_fromHolder)
        ) | (
            {164}out(chC(credential), cred_fromHolder)
        )
    )
) | (
    {165}!
    {166}let sk_17: SecretKey = sk_prover in
    {167}let issuerDID_1: DID = genDID(pk(sk_issuer),sk_issuer) in
    {168}let verifierDID_1: DID = genDID(pk(sk_otherAgent),sk_otherAgent) in
    {169}let talksOnlyToHonest_3: bool = false in
    {170}let pk_i_1: PublicKey = getPubKey(issuerDID_1) in
    {171}new ssk_4: SecretKey;
    {172}new n_p_4: bitstring;
    {173}let msg_13: bitstring = (n_p_4,pk(ssk_4)) in
    {174}let sk_18: SecretKey = ssk_4 in
    {175}let msg_handshakeReq_4: bitstring = aenc(sign(msg_13,sk_18),pk_i_1) in
    {176}out(h, msg_handshakeReq_4);
    {177}in(h, x_9: bitstring);
    {178}let msg_handshakeResp_4: bitstring = x_9 in
    {179}let sk_19: SecretKey = ssk_4 in
    {180}let msg_14: bitstring = auth(adec(x_9,sk_19),pk_i_1) in
    {181}let (n'_p_2: bitstring,n_i_3: bitstring,spk_i_1: PublicKey) = msg_14 in
    {182}if (n'_p_2 = n_p_4) then
    {183}let msg_15: bitstring = sign((n_i_3,genDID(pk(sk_17),sk_17),issuerDID_1),sk_17) in
    {184}let sk_20: SecretKey = ssk_4 in
    {185}let msg_did_3: bitstring = aenc(sign(msg_15,sk_20),spk_i_1) in
    {186}event auth_HolderSendsLastMessageToIssuer(msg_handshakeReq_4,msg_handshakeResp_4,msg_did_3);
    {187}out(h, msg_did_3);
    {188}in(h, x_10: bitstring);
    {189}let msg_credential_1: bitstring = x_10 in
    {190}let sk_21: SecretKey = ssk_4 in
    {191}let (credential_1: VC,recipientDID_4: DID,n_issuing_3: bitstring) = auth(adec(x_10,sk_21),spk_i_1) in
    {192}if (recipientDID_4 = genDID(pk(sk_17),sk_17)) then
    (
        {193}!
        {194}let pk_v_1: PublicKey = getPubKey(verifierDID_1) in
        {195}new ssk_5: SecretKey;
        {196}new n_p_5: bitstring;
        {197}let msg_16: bitstring = (n_p_5,pk(ssk_5)) in
        {198}let sk_22: SecretKey = ssk_5 in
        {199}let msg_handshakeReq_5: bitstring = aenc(sign(msg_16,sk_22),pk_v_1) in
        {200}out(h, msg_handshakeReq_5);
        {201}in(h, x_11: bitstring);
        {202}let msg_handshakeResp_5: bitstring = x_11 in
        {203}let sk_23: SecretKey = ssk_5 in
        {204}let msg_17: bitstring = auth(adec(x_11,sk_23),pk_v_1) in
        {205}let (n'_p_3: bitstring,n_v_1: bitstring,spk_v_1: PublicKey) = msg_17 in
        {206}if (n'_p_3 = n_p_5) then
        {207}let msg_18: bitstring = (n_v_1,uri) in
        {208}let sk_24: SecretKey = ssk_5 in
        {209}let msg_uri_1: bitstring = aenc(sign(msg_18,sk_24),spk_v_1) in
        {210}out(h, msg_uri_1);
        {211}in(h, x_12: bitstring);
        {212}let msg_rule_1: bitstring = x_12 in
        {213}let sk_25: SecretKey = ssk_5 in
        {214}let msg_19: bitstring = auth(adec(x_12,sk_25),spk_v_1) in
        {215}let (n_c_1: bitstring,rule_1: ACR) = msg_19 in
        {216}if (getVcAsTuple(credential_1) = getRuleAsTuple(rule_1)) then
        {217}let vp_1: bitstring = sign((n_c_1,verifierDID_1,credential_1),sk_17) in
        {218}let sk_26: SecretKey = ssk_5 in
        {219}let msg_vp_1: bitstring = aenc(sign(vp_1,sk_26),spk_v_1) in
        {220}event auth_ProverSendsLastMessageToVerifier(msg_handshakeReq_5,msg_handshakeResp_5,msg_uri_1,msg_rule_1,msg_vp_1);
        {221}event auth_ProverSendsLastMessageToVerifierInProtocolFull(msg_handshakeReq_4,msg_handshakeResp_4,msg_did_3,msg_credential_1,msg_handshakeReq_5,msg_handshakeResp_5,msg_uri_1,msg_rule_1,msg_vp_1);
        {222}out(h, msg_vp_1);
        {223}in(h, x_13: bitstring);
        {224}let msg_accessToken_1: bitstring = x_13 in
        {225}let sk_27: SecretKey = ssk_5 in
        {226}let (access_token_1: bitstring,recipientDID_5: DID) = auth(adec(x_13,sk_27),spk_v_1) in
        {227}if (recipientDID_5 = genDID(pk(sk_17),sk_17)) then
        {228}if talksOnlyToHonest_3 then
        (
            {229}event auth_ProverCompletesProtocol(msg_handshakeReq_5,msg_handshakeResp_5,msg_uri_1,msg_rule_1,msg_vp_1,msg_accessToken_1)
        ) | (
            {230}out(ch(n_p_5), n_p_fromProver)
        ) | (
            {231}out(chR(rule_1), rule_fromProver)
        ) | (
            {232}out(ch((n_c_1,verifierDID_1,credential_1)), unsigned_vp_fromProver)
        ) | (
            {233}out(ch(vp_1), vp_fromProver)
        ) | (
            {234}out(chC(credential_1), cred_fromProver)
        ) | (
            {235}out(ch(access_token_1), access_token_fromProver)
        )
    ) | (
        {236}if talksOnlyToHonest_3 then
        (
            {237}event auth_HolderCompletesProtocol(msg_handshakeReq_4,msg_handshakeResp_4,msg_did_3,msg_credential_1)
        ) | (
            {238}out(ch(n_p_4), n_p_fromHolder)
        ) | (
            {239}out(ch(n_i_3), n_i_fromHolder)
        ) | (
            {240}out(ch((n_i_3,genDID(pk(sk_17),sk_17),issuerDID_1)), providingDID_fromHolder)
        ) | (
            {241}out(chC(credential_1), cred_fromHolder)
        )
    )
) | (
    {242}!
    {243}let sk_28: SecretKey = sk_prover in
    {244}let issuerDID_2: DID = genDID(pk(sk_otherAgent),sk_otherAgent) in
    {245}let verifierDID_2: DID = genDID(pk(sk_verifier),sk_verifier) in
    {246}let talksOnlyToHonest_4: bool = false in
    {247}let pk_i_2: PublicKey = getPubKey(issuerDID_2) in
    {248}new ssk_6: SecretKey;
    {249}new n_p_6: bitstring;
    {250}let msg_20: bitstring = (n_p_6,pk(ssk_6)) in
    {251}let sk_29: SecretKey = ssk_6 in
    {252}let msg_handshakeReq_6: bitstring = aenc(sign(msg_20,sk_29),pk_i_2) in
    {253}out(h, msg_handshakeReq_6);
    {254}in(h, x_14: bitstring);
    {255}let msg_handshakeResp_6: bitstring = x_14 in
    {256}let sk_30: SecretKey = ssk_6 in
    {257}let msg_21: bitstring = auth(adec(x_14,sk_30),pk_i_2) in
    {258}let (n'_p_4: bitstring,n_i_4: bitstring,spk_i_2: PublicKey) = msg_21 in
    {259}if (n'_p_4 = n_p_6) then
    {260}let msg_22: bitstring = sign((n_i_4,genDID(pk(sk_28),sk_28),issuerDID_2),sk_28) in
    {261}let sk_31: SecretKey = ssk_6 in
    {262}let msg_did_4: bitstring = aenc(sign(msg_22,sk_31),spk_i_2) in
    {263}event auth_HolderSendsLastMessageToIssuer(msg_handshakeReq_6,msg_handshakeResp_6,msg_did_4);
    {264}out(h, msg_did_4);
    {265}in(h, x_15: bitstring);
    {266}let msg_credential_2: bitstring = x_15 in
    {267}let sk_32: SecretKey = ssk_6 in
    {268}let (credential_2: VC,recipientDID_6: DID,n_issuing_4: bitstring) = auth(adec(x_15,sk_32),spk_i_2) in
    {269}if (recipientDID_6 = genDID(pk(sk_28),sk_28)) then
    (
        {270}!
        {271}let pk_v_2: PublicKey = getPubKey(verifierDID_2) in
        {272}new ssk_7: SecretKey;
        {273}new n_p_7: bitstring;
        {274}let msg_23: bitstring = (n_p_7,pk(ssk_7)) in
        {275}let sk_33: SecretKey = ssk_7 in
        {276}let msg_handshakeReq_7: bitstring = aenc(sign(msg_23,sk_33),pk_v_2) in
        {277}out(h, msg_handshakeReq_7);
        {278}in(h, x_16: bitstring);
        {279}let msg_handshakeResp_7: bitstring = x_16 in
        {280}let sk_34: SecretKey = ssk_7 in
        {281}let msg_24: bitstring = auth(adec(x_16,sk_34),pk_v_2) in
        {282}let (n'_p_5: bitstring,n_v_2: bitstring,spk_v_2: PublicKey) = msg_24 in
        {283}if (n'_p_5 = n_p_7) then
        {284}let msg_25: bitstring = (n_v_2,uri) in
        {285}let sk_35: SecretKey = ssk_7 in
        {286}let msg_uri_2: bitstring = aenc(sign(msg_25,sk_35),spk_v_2) in
        {287}out(h, msg_uri_2);
        {288}in(h, x_17: bitstring);
        {289}let msg_rule_2: bitstring = x_17 in
        {290}let sk_36: SecretKey = ssk_7 in
        {291}let msg_26: bitstring = auth(adec(x_17,sk_36),spk_v_2) in
        {292}let (n_c_2: bitstring,rule_2: ACR) = msg_26 in
        {293}if (getVcAsTuple(credential_2) = getRuleAsTuple(rule_2)) then
        {294}let vp_2: bitstring = sign((n_c_2,verifierDID_2,credential_2),sk_28) in
        {295}let sk_37: SecretKey = ssk_7 in
        {296}let msg_vp_2: bitstring = aenc(sign(vp_2,sk_37),spk_v_2) in
        {297}event auth_ProverSendsLastMessageToVerifier(msg_handshakeReq_7,msg_handshakeResp_7,msg_uri_2,msg_rule_2,msg_vp_2);
        {298}event auth_ProverSendsLastMessageToVerifierInProtocolFull(msg_handshakeReq_6,msg_handshakeResp_6,msg_did_4,msg_credential_2,msg_handshakeReq_7,msg_handshakeResp_7,msg_uri_2,msg_rule_2,msg_vp_2);
        {299}out(h, msg_vp_2);
        {300}in(h, x_18: bitstring);
        {301}let msg_accessToken_2: bitstring = x_18 in
        {302}let sk_38: SecretKey = ssk_7 in
        {303}let (access_token_2: bitstring,recipientDID_7: DID) = auth(adec(x_18,sk_38),spk_v_2) in
        {304}if (recipientDID_7 = genDID(pk(sk_28),sk_28)) then
        {305}if talksOnlyToHonest_4 then
        (
            {306}event auth_ProverCompletesProtocol(msg_handshakeReq_7,msg_handshakeResp_7,msg_uri_2,msg_rule_2,msg_vp_2,msg_accessToken_2)
        ) | (
            {307}out(ch(n_p_7), n_p_fromProver)
        ) | (
            {308}out(chR(rule_2), rule_fromProver)
        ) | (
            {309}out(ch((n_c_2,verifierDID_2,credential_2)), unsigned_vp_fromProver)
        ) | (
            {310}out(ch(vp_2), vp_fromProver)
        ) | (
            {311}out(chC(credential_2), cred_fromProver)
        ) | (
            {312}out(ch(access_token_2), access_token_fromProver)
        )
    ) | (
        {313}if talksOnlyToHonest_4 then
        (
            {314}event auth_HolderCompletesProtocol(msg_handshakeReq_6,msg_handshakeResp_6,msg_did_4,msg_credential_2)
        ) | (
            {315}out(ch(n_p_6), n_p_fromHolder)
        ) | (
            {316}out(ch(n_i_4), n_i_fromHolder)
        ) | (
            {317}out(ch((n_i_4,genDID(pk(sk_28),sk_28),issuerDID_2)), providingDID_fromHolder)
        ) | (
            {318}out(chC(credential_2), cred_fromHolder)
        )
    )
) | (
    {319}!
    {320}let sk_39: SecretKey = sk_prover in
    {321}let issuerDID_3: DID = genDID(pk(sk_otherAgent),sk_otherAgent) in
    {322}let verifierDID_3: DID = genDID(pk(sk_otherAgent),sk_otherAgent) in
    {323}let talksOnlyToHonest_5: bool = false in
    {324}let pk_i_3: PublicKey = getPubKey(issuerDID_3) in
    {325}new ssk_8: SecretKey;
    {326}new n_p_8: bitstring;
    {327}let msg_27: bitstring = (n_p_8,pk(ssk_8)) in
    {328}let sk_40: SecretKey = ssk_8 in
    {329}let msg_handshakeReq_8: bitstring = aenc(sign(msg_27,sk_40),pk_i_3) in
    {330}out(h, msg_handshakeReq_8);
    {331}in(h, x_19: bitstring);
    {332}let msg_handshakeResp_8: bitstring = x_19 in
    {333}let sk_41: SecretKey = ssk_8 in
    {334}let msg_28: bitstring = auth(adec(x_19,sk_41),pk_i_3) in
    {335}let (n'_p_6: bitstring,n_i_5: bitstring,spk_i_3: PublicKey) = msg_28 in
    {336}if (n'_p_6 = n_p_8) then
    {337}let msg_29: bitstring = sign((n_i_5,genDID(pk(sk_39),sk_39),issuerDID_3),sk_39) in
    {338}let sk_42: SecretKey = ssk_8 in
    {339}let msg_did_5: bitstring = aenc(sign(msg_29,sk_42),spk_i_3) in
    {340}event auth_HolderSendsLastMessageToIssuer(msg_handshakeReq_8,msg_handshakeResp_8,msg_did_5);
    {341}out(h, msg_did_5);
    {342}in(h, x_20: bitstring);
    {343}let msg_credential_3: bitstring = x_20 in
    {344}let sk_43: SecretKey = ssk_8 in
    {345}let (credential_3: VC,recipientDID_8: DID,n_issuing_5: bitstring) = auth(adec(x_20,sk_43),spk_i_3) in
    {346}if (recipientDID_8 = genDID(pk(sk_39),sk_39)) then
    (
        {347}!
        {348}let pk_v_3: PublicKey = getPubKey(verifierDID_3) in
        {349}new ssk_9: SecretKey;
        {350}new n_p_9: bitstring;
        {351}let msg_30: bitstring = (n_p_9,pk(ssk_9)) in
        {352}let sk_44: SecretKey = ssk_9 in
        {353}let msg_handshakeReq_9: bitstring = aenc(sign(msg_30,sk_44),pk_v_3) in
        {354}out(h, msg_handshakeReq_9);
        {355}in(h, x_21: bitstring);
        {356}let msg_handshakeResp_9: bitstring = x_21 in
        {357}let sk_45: SecretKey = ssk_9 in
        {358}let msg_31: bitstring = auth(adec(x_21,sk_45),pk_v_3) in
        {359}let (n'_p_7: bitstring,n_v_3: bitstring,spk_v_3: PublicKey) = msg_31 in
        {360}if (n'_p_7 = n_p_9) then
        {361}let msg_32: bitstring = (n_v_3,uri) in
        {362}let sk_46: SecretKey = ssk_9 in
        {363}let msg_uri_3: bitstring = aenc(sign(msg_32,sk_46),spk_v_3) in
        {364}out(h, msg_uri_3);
        {365}in(h, x_22: bitstring);
        {366}let msg_rule_3: bitstring = x_22 in
        {367}let sk_47: SecretKey = ssk_9 in
        {368}let msg_33: bitstring = auth(adec(x_22,sk_47),spk_v_3) in
        {369}let (n_c_3: bitstring,rule_3: ACR) = msg_33 in
        {370}if (getVcAsTuple(credential_3) = getRuleAsTuple(rule_3)) then
        {371}let vp_3: bitstring = sign((n_c_3,verifierDID_3,credential_3),sk_39) in
        {372}let sk_48: SecretKey = ssk_9 in
        {373}let msg_vp_3: bitstring = aenc(sign(vp_3,sk_48),spk_v_3) in
        {374}event auth_ProverSendsLastMessageToVerifier(msg_handshakeReq_9,msg_handshakeResp_9,msg_uri_3,msg_rule_3,msg_vp_3);
        {375}event auth_ProverSendsLastMessageToVerifierInProtocolFull(msg_handshakeReq_8,msg_handshakeResp_8,msg_did_5,msg_credential_3,msg_handshakeReq_9,msg_handshakeResp_9,msg_uri_3,msg_rule_3,msg_vp_3);
        {376}out(h, msg_vp_3);
        {377}in(h, x_23: bitstring);
        {378}let msg_accessToken_3: bitstring = x_23 in
        {379}let sk_49: SecretKey = ssk_9 in
        {380}let (access_token_3: bitstring,recipientDID_9: DID) = auth(adec(x_23,sk_49),spk_v_3) in
        {381}if (recipientDID_9 = genDID(pk(sk_39),sk_39)) then
        {382}if talksOnlyToHonest_5 then
        (
            {383}event auth_ProverCompletesProtocol(msg_handshakeReq_9,msg_handshakeResp_9,msg_uri_3,msg_rule_3,msg_vp_3,msg_accessToken_3)
        ) | (
            {384}out(ch(n_p_9), n_p_fromProver)
        ) | (
            {385}out(chR(rule_3), rule_fromProver)
        ) | (
            {386}out(ch((n_c_3,verifierDID_3,credential_3)), unsigned_vp_fromProver)
        ) | (
            {387}out(ch(vp_3), vp_fromProver)
        ) | (
            {388}out(chC(credential_3), cred_fromProver)
        ) | (
            {389}out(ch(access_token_3), access_token_fromProver)
        )
    ) | (
        {390}if talksOnlyToHonest_5 then
        (
            {391}event auth_HolderCompletesProtocol(msg_handshakeReq_8,msg_handshakeResp_8,msg_did_5,msg_credential_3)
        ) | (
            {392}out(ch(n_p_8), n_p_fromHolder)
        ) | (
            {393}out(ch(n_i_5), n_i_fromHolder)
        ) | (
            {394}out(ch((n_i_5,genDID(pk(sk_39),sk_39),issuerDID_3)), providingDID_fromHolder)
        ) | (
            {395}out(chC(credential_3), cred_fromHolder)
        )
    )
) | (
    {396}!
    {397}let sk_50: SecretKey = sk_verifier in
    {398}let talksOnlyToHonest_6: bool = true in
    {399}in(h, x_24: bitstring);
    {400}let msg_handshakeReq_10: bitstring = x_24 in
    {401}let sgndMsg_2: bitstring = adec(x_24,sk_50) in
    {402}let msg_34: bitstring = sgndMsg_2 in
    {403}let (unauth_n_p_2: bitstring,unauth_spk_p_2: PublicKey) = getMsg(sgndMsg_2) in
    {404}let (n_p_10: bitstring,spk_p_2: PublicKey) = auth(sgndMsg_2,unauth_spk_p_2) in
    {405}new ssk_10: SecretKey;
    {406}new n_v_4: bitstring;
    {407}let msg_35: bitstring = (n_p_10,n_v_4,pk(ssk_10)) in
    {408}let msg_handshakeResp_10: bitstring = aenc(sign(msg_35,sk_50),spk_p_2) in
    {409}out(h, msg_handshakeResp_10);
    {410}in(h, x_25: bitstring);
    {411}let msg_uri_4: bitstring = x_25 in
    {412}let sk_51: SecretKey = ssk_10 in
    {413}let msg_36: bitstring = auth(adec(x_25,sk_51),spk_p_2) in
    {414}let (n'_v: bitstring,u: bitstring) = msg_36 in
    {415}if (n'_v = n_v_4) then
    {416}if (u = uri) then
    {417}new n_c_4: bitstring;
    {418}let msg_37: bitstring = (n_c_4,acr) in
    {419}let sk_52: SecretKey = ssk_10 in
    {420}let msg_rule_4: bitstring = aenc(sign(msg_37,sk_52),spk_p_2) in
    {421}out(h, msg_rule_4);
    {422}in(h, x_26: bitstring);
    {423}let msg_vp_4: bitstring = x_26 in
    {424}let sk_53: SecretKey = ssk_10 in
    {425}let unauth_vp: bitstring = auth(adec(x_26,sk_53),spk_p_2) in
    {426}let (unauth_n'_c: bitstring,unauth_recipient: DID,unauth_cred: VC) = getMsg(unauth_vp) in
    {427}let cred_subject: DID = getSubjectFromVC(unauth_cred) in
    {428}if (cred_subject = getSubjectFromRule(acr)) then
    {429}let pk_subject: PublicKey = getPubKey(cred_subject) in
    {430}let (n'_c: bitstring,recipientDID_10: DID,cred_2: VC) = auth(unauth_vp,pk_subject) in
    {431}if (recipientDID_10 = genDID(pk(sk_50),sk_50)) then
    {432}if (n'_c = n_c_4) then
    {433}if (getIssuerFromVC(cred_2) = getIssuerFromRule(acr)) then
    {434}let (subjectDID: DID,asserted_attr: bitstring,issuerDID_4: DID) = verify(cred_2,getPubKey(getIssuerFromVC(cred_2))) in
    {435}if (asserted_attr = getAttrFromRule(acr)) then
    {436}new access_token_4: bitstring;
    {437}let msg_38: bitstring = (subjectDID,access_token_4) in
    {438}let sk_54: SecretKey = ssk_10 in
    {439}let msg_accessToken_4: bitstring = aenc(sign(msg_38,sk_54),spk_p_2) in
    {440}event auth_VerifierSendsLastMessageToProver(msg_handshakeReq_10,msg_handshakeResp_10,msg_uri_4,msg_rule_4,msg_vp_4,msg_accessToken_4);
    {441}out(h, msg_accessToken_4);
    {442}if talksOnlyToHonest_6 then
    (
        {443}event auth_VerifierCompletesProtocol(msg_handshakeReq_10,msg_handshakeResp_10,msg_uri_4,msg_rule_4,msg_vp_4)
    ) | (
        {444}out(ch(n_p_10), n_p_fromVerifier)
    ) | (
        {445}out(chR(acr), rule_fromVerifier)
    ) | (
        {446}out(ch((n_c_4,acr)), credRequest_fromVerifier)
    ) | (
        {447}out(ch(unauth_vp), unauth_vp_fromVerifier)
    ) | (
        {448}out(ch((n'_c,recipientDID_10,cred_2)), vp_fromVerifier)
    ) | (
        {449}out(chC(cred_2), cred_fromVerifier)
    ) | (
        {450}out(ch(access_token_4), access_token_fromVerifier)
    )
) | (
    {451}!
    {452}let sk_55: SecretKey = sk_verifier in
    {453}let talksOnlyToHonest_7: bool = false in
    {454}in(h, x_27: bitstring);
    {455}let msg_handshakeReq_11: bitstring = x_27 in
    {456}let sgndMsg_3: bitstring = adec(x_27,sk_55) in
    {457}let msg_39: bitstring = sgndMsg_3 in
    {458}let (unauth_n_p_3: bitstring,unauth_spk_p_3: PublicKey) = getMsg(sgndMsg_3) in
    {459}let (n_p_11: bitstring,spk_p_3: PublicKey) = auth(sgndMsg_3,unauth_spk_p_3) in
    {460}new ssk_11: SecretKey;
    {461}new n_v_5: bitstring;
    {462}let msg_40: bitstring = (n_p_11,n_v_5,pk(ssk_11)) in
    {463}let msg_handshakeResp_11: bitstring = aenc(sign(msg_40,sk_55),spk_p_3) in
    {464}out(h, msg_handshakeResp_11);
    {465}in(h, x_28: bitstring);
    {466}let msg_uri_5: bitstring = x_28 in
    {467}let sk_56: SecretKey = ssk_11 in
    {468}let msg_41: bitstring = auth(adec(x_28,sk_56),spk_p_3) in
    {469}let (n'_v_1: bitstring,u_1: bitstring) = msg_41 in
    {470}if (n'_v_1 = n_v_5) then
    {471}if (u_1 = uri) then
    {472}new n_c_5: bitstring;
    {473}let msg_42: bitstring = (n_c_5,acr_otherAgent) in
    {474}let sk_57: SecretKey = ssk_11 in
    {475}let msg_rule_5: bitstring = aenc(sign(msg_42,sk_57),spk_p_3) in
    {476}out(h, msg_rule_5);
    {477}in(h, x_29: bitstring);
    {478}let msg_vp_5: bitstring = x_29 in
    {479}let sk_58: SecretKey = ssk_11 in
    {480}let unauth_vp_1: bitstring = auth(adec(x_29,sk_58),spk_p_3) in
    {481}let (unauth_n'_c_1: bitstring,unauth_recipient_1: DID,unauth_cred_1: VC) = getMsg(unauth_vp_1) in
    {482}let cred_subject_1: DID = getSubjectFromVC(unauth_cred_1) in
    {483}if (cred_subject_1 = getSubjectFromRule(acr_otherAgent)) then
    {484}let pk_subject_1: PublicKey = getPubKey(cred_subject_1) in
    {485}let (n'_c_1: bitstring,recipientDID_11: DID,cred_3: VC) = auth(unauth_vp_1,pk_subject_1) in
    {486}if (recipientDID_11 = genDID(pk(sk_55),sk_55)) then
    {487}if (n'_c_1 = n_c_5) then
    {488}if (getIssuerFromVC(cred_3) = getIssuerFromRule(acr_otherAgent)) then
    {489}let (subjectDID_1: DID,asserted_attr_1: bitstring,issuerDID_5: DID) = verify(cred_3,getPubKey(getIssuerFromVC(cred_3))) in
    {490}if (asserted_attr_1 = getAttrFromRule(acr_otherAgent)) then
    {491}new access_token_5: bitstring;
    {492}let msg_43: bitstring = (subjectDID_1,access_token_5) in
    {493}let sk_59: SecretKey = ssk_11 in
    {494}let msg_accessToken_5: bitstring = aenc(sign(msg_43,sk_59),spk_p_3) in
    {495}event auth_VerifierSendsLastMessageToProver(msg_handshakeReq_11,msg_handshakeResp_11,msg_uri_5,msg_rule_5,msg_vp_5,msg_accessToken_5);
    {496}out(h, msg_accessToken_5);
    {497}if talksOnlyToHonest_7 then
    (
        {498}event auth_VerifierCompletesProtocol(msg_handshakeReq_11,msg_handshakeResp_11,msg_uri_5,msg_rule_5,msg_vp_5)
    ) | (
        {499}out(ch(n_p_11), n_p_fromVerifier)
    ) | (
        {500}out(chR(acr_otherAgent), rule_fromVerifier)
    ) | (
        {501}out(ch((n_c_5,acr_otherAgent)), credRequest_fromVerifier)
    ) | (
        {502}out(ch(unauth_vp_1), unauth_vp_fromVerifier)
    ) | (
        {503}out(ch((n'_c_1,recipientDID_11,cred_3)), vp_fromVerifier)
    ) | (
        {504}out(chC(cred_3), cred_fromVerifier)
    ) | (
        {505}out(ch(access_token_5), access_token_fromVerifier)
    )
) | (
    {506}!
    {507}let sk_60: SecretKey = sk_verifier in
    {508}let talksOnlyToHonest_8: bool = false in
    {509}in(h, x_30: bitstring);
    {510}let msg_handshakeReq_12: bitstring = x_30 in
    {511}let sgndMsg_4: bitstring = adec(x_30,sk_60) in
    {512}let msg_44: bitstring = sgndMsg_4 in
    {513}let (unauth_n_p_4: bitstring,unauth_spk_p_4: PublicKey) = getMsg(sgndMsg_4) in
    {514}let (n_p_12: bitstring,spk_p_4: PublicKey) = auth(sgndMsg_4,unauth_spk_p_4) in
    {515}new ssk_12: SecretKey;
    {516}new n_v_6: bitstring;
    {517}let msg_45: bitstring = (n_p_12,n_v_6,pk(ssk_12)) in
    {518}let msg_handshakeResp_12: bitstring = aenc(sign(msg_45,sk_60),spk_p_4) in
    {519}out(h, msg_handshakeResp_12);
    {520}in(h, x_31: bitstring);
    {521}let msg_uri_6: bitstring = x_31 in
    {522}let sk_61: SecretKey = ssk_12 in
    {523}let msg_46: bitstring = auth(adec(x_31,sk_61),spk_p_4) in
    {524}let (n'_v_2: bitstring,u_2: bitstring) = msg_46 in
    {525}if (n'_v_2 = n_v_6) then
    {526}if (u_2 = uri) then
    {527}new n_c_6: bitstring;
    {528}let msg_47: bitstring = (n_c_6,acr_compromisedIssuer) in
    {529}let sk_62: SecretKey = ssk_12 in
    {530}let msg_rule_6: bitstring = aenc(sign(msg_47,sk_62),spk_p_4) in
    {531}out(h, msg_rule_6);
    {532}in(h, x_32: bitstring);
    {533}let msg_vp_6: bitstring = x_32 in
    {534}let sk_63: SecretKey = ssk_12 in
    {535}let unauth_vp_2: bitstring = auth(adec(x_32,sk_63),spk_p_4) in
    {536}let (unauth_n'_c_2: bitstring,unauth_recipient_2: DID,unauth_cred_2: VC) = getMsg(unauth_vp_2) in
    {537}let cred_subject_2: DID = getSubjectFromVC(unauth_cred_2) in
    {538}if (cred_subject_2 = getSubjectFromRule(acr_compromisedIssuer)) then
    {539}let pk_subject_2: PublicKey = getPubKey(cred_subject_2) in
    {540}let (n'_c_2: bitstring,recipientDID_12: DID,cred_4: VC) = auth(unauth_vp_2,pk_subject_2) in
    {541}if (recipientDID_12 = genDID(pk(sk_60),sk_60)) then
    {542}if (n'_c_2 = n_c_6) then
    {543}if (getIssuerFromVC(cred_4) = getIssuerFromRule(acr_compromisedIssuer)) then
    {544}let (subjectDID_2: DID,asserted_attr_2: bitstring,issuerDID_6: DID) = verify(cred_4,getPubKey(getIssuerFromVC(cred_4))) in
    {545}if (asserted_attr_2 = getAttrFromRule(acr_compromisedIssuer)) then
    {546}new access_token_6: bitstring;
    {547}let msg_48: bitstring = (subjectDID_2,access_token_6) in
    {548}let sk_64: SecretKey = ssk_12 in
    {549}let msg_accessToken_6: bitstring = aenc(sign(msg_48,sk_64),spk_p_4) in
    {550}event auth_VerifierSendsLastMessageToProver(msg_handshakeReq_12,msg_handshakeResp_12,msg_uri_6,msg_rule_6,msg_vp_6,msg_accessToken_6);
    {551}out(h, msg_accessToken_6);
    {552}if talksOnlyToHonest_8 then
    (
        {553}event auth_VerifierCompletesProtocol(msg_handshakeReq_12,msg_handshakeResp_12,msg_uri_6,msg_rule_6,msg_vp_6)
    ) | (
        {554}out(ch(n_p_12), n_p_fromVerifier)
    ) | (
        {555}out(chR(acr_compromisedIssuer), rule_fromVerifier)
    ) | (
        {556}out(ch((n_c_6,acr_compromisedIssuer)), credRequest_fromVerifier)
    ) | (
        {557}out(ch(unauth_vp_2), unauth_vp_fromVerifier)
    ) | (
        {558}out(ch((n'_c_2,recipientDID_12,cred_4)), vp_fromVerifier)
    ) | (
        {559}out(chC(cred_4), cred_fromVerifier)
    ) | (
        {560}out(ch(access_token_6), access_token_fromVerifier)
    )
) | (
    {561}!
    {562}let sk_65: SecretKey = sk_verifier in
    {563}let talksOnlyToHonest_9: bool = false in
    {564}in(h, x_33: bitstring);
    {565}let msg_handshakeReq_13: bitstring = x_33 in
    {566}let sgndMsg_5: bitstring = adec(x_33,sk_65) in
    {567}let msg_49: bitstring = sgndMsg_5 in
    {568}let (unauth_n_p_5: bitstring,unauth_spk_p_5: PublicKey) = getMsg(sgndMsg_5) in
    {569}let (n_p_13: bitstring,spk_p_5: PublicKey) = auth(sgndMsg_5,unauth_spk_p_5) in
    {570}new ssk_13: SecretKey;
    {571}new n_v_7: bitstring;
    {572}let msg_50: bitstring = (n_p_13,n_v_7,pk(ssk_13)) in
    {573}let msg_handshakeResp_13: bitstring = aenc(sign(msg_50,sk_65),spk_p_5) in
    {574}out(h, msg_handshakeResp_13);
    {575}in(h, x_34: bitstring);
    {576}let msg_uri_7: bitstring = x_34 in
    {577}let sk_66: SecretKey = ssk_13 in
    {578}let msg_51: bitstring = auth(adec(x_34,sk_66),spk_p_5) in
    {579}let (n'_v_3: bitstring,u_3: bitstring) = msg_51 in
    {580}if (n'_v_3 = n_v_7) then
    {581}if (u_3 = uri) then
    {582}new n_c_7: bitstring;
    {583}let msg_52: bitstring = (n_c_7,acr_compromised) in
    {584}let sk_67: SecretKey = ssk_13 in
    {585}let msg_rule_7: bitstring = aenc(sign(msg_52,sk_67),spk_p_5) in
    {586}out(h, msg_rule_7);
    {587}in(h, x_35: bitstring);
    {588}let msg_vp_7: bitstring = x_35 in
    {589}let sk_68: SecretKey = ssk_13 in
    {590}let unauth_vp_3: bitstring = auth(adec(x_35,sk_68),spk_p_5) in
    {591}let (unauth_n'_c_3: bitstring,unauth_recipient_3: DID,unauth_cred_3: VC) = getMsg(unauth_vp_3) in
    {592}let cred_subject_3: DID = getSubjectFromVC(unauth_cred_3) in
    {593}if (cred_subject_3 = getSubjectFromRule(acr_compromised)) then
    {594}let pk_subject_3: PublicKey = getPubKey(cred_subject_3) in
    {595}let (n'_c_3: bitstring,recipientDID_13: DID,cred_5: VC) = auth(unauth_vp_3,pk_subject_3) in
    {596}if (recipientDID_13 = genDID(pk(sk_65),sk_65)) then
    {597}if (n'_c_3 = n_c_7) then
    {598}if (getIssuerFromVC(cred_5) = getIssuerFromRule(acr_compromised)) then
    {599}let (subjectDID_3: DID,asserted_attr_3: bitstring,issuerDID_7: DID) = verify(cred_5,getPubKey(getIssuerFromVC(cred_5))) in
    {600}if (asserted_attr_3 = getAttrFromRule(acr_compromised)) then
    {601}new access_token_7: bitstring;
    {602}let msg_53: bitstring = (subjectDID_3,access_token_7) in
    {603}let sk_69: SecretKey = ssk_13 in
    {604}let msg_accessToken_7: bitstring = aenc(sign(msg_53,sk_69),spk_p_5) in
    {605}event auth_VerifierSendsLastMessageToProver(msg_handshakeReq_13,msg_handshakeResp_13,msg_uri_7,msg_rule_7,msg_vp_7,msg_accessToken_7);
    {606}out(h, msg_accessToken_7);
    {607}if talksOnlyToHonest_9 then
    (
        {608}event auth_VerifierCompletesProtocol(msg_handshakeReq_13,msg_handshakeResp_13,msg_uri_7,msg_rule_7,msg_vp_7)
    ) | (
        {609}out(ch(n_p_13), n_p_fromVerifier)
    ) | (
        {610}out(chR(acr_compromised), rule_fromVerifier)
    ) | (
        {611}out(ch((n_c_7,acr_compromised)), credRequest_fromVerifier)
    ) | (
        {612}out(ch(unauth_vp_3), unauth_vp_fromVerifier)
    ) | (
        {613}out(ch((n'_c_3,recipientDID_13,cred_5)), vp_fromVerifier)
    ) | (
        {614}out(chC(cred_5), cred_fromVerifier)
    ) | (
        {615}out(ch(access_token_7), access_token_fromVerifier)
    )
)

--  Process 1 (that is, process 0, with let moved downwards):
{1}new sk_prover: SecretKey;
{2}new sk_verifier: SecretKey;
{3}new sk_issuer: SecretKey;
{4}out(h, pk(sk_issuer));
{5}out(h, pk(sk_verifier));
{6}out(h, pk(sk_prover));
{7}out(h, genDID(pk(sk_prover),sk_prover));
{8}out(h, genDID(pk(sk_verifier),sk_verifier));
{9}out(h, genDID(pk(sk_issuer),sk_issuer));
(
    {14}!
    {19}in(h, x: bitstring);
    {15}let sk: SecretKey = sk_issuer in
    {21}let sgndMsg: bitstring = adec(x,sk) in
    {22}let (unauth_n_p: bitstring,unauth_spk_p: PublicKey) = getMsg(sgndMsg) in
    {23}let (n_p: bitstring,spk_p: PublicKey) = auth(sgndMsg,unauth_spk_p) in
    {24}new ssk: SecretKey;
    {25}new n_i: bitstring;
    {26}let msg: bitstring = (n_p,n_i,pk(ssk)) in
    {27}let msg_handshakeResp: bitstring = aenc(sign(msg,sk),spk_p) in
    {28}out(h, msg_handshakeResp);
    {29}in(h, x_1: bitstring);
    {31}let sk_1: SecretKey = ssk in
    {32}let msg_1: bitstring = auth(adec(x_1,sk_1),spk_p) in
    {33}let (unauth_n'_i: bitstring,unauth_proverDID: DID,unauth_recipientDID: DID) = getMsg(msg_1) in
    {34}let pk_p: PublicKey = getPubKey(unauth_proverDID) in
    {35}let (n'_i: bitstring,proverDID: DID,recipientDID: DID) = auth(msg_1,pk_p) in
    {17}let expectedDID: DID = genDID(pk(sk_prover),sk_prover) in
    {36}if (proverDID = expectedDID) then
    {37}if (n'_i = n_i) then
    {38}if (recipientDID = genDID(pk(sk),sk)) then
    {40}new n_issuing: bitstring;
    {42}let sk_2: SecretKey = ssk in
    {16}let attr_1: bitstring = attr in
    {39}let cred: VC = issueVC(proverDID,attr_1,sk) in
    {41}let msg_2: bitstring = (cred,proverDID,n_issuing) in
    {43}let msg_cred: bitstring = aenc(sign(msg_2,sk_2),spk_p) in
    {30}let msg_did: bitstring = x_1 in
    {20}let msg_handshakeReq: bitstring = x in
    {44}event auth_IssuerSendsLastMessageToHolder(msg_handshakeReq,msg_handshakeResp,msg_did,msg_cred);
    {45}out(h, msg_cred);
    {18}let talksOnlyToHonest: bool = true in
    {46}if talksOnlyToHonest then
    (
        {47}event auth_IssuerCompletesProtocol(msg_handshakeReq,msg_handshakeResp,msg_did)
    ) | (
        {48}out(ch(n_p), n_p_fromIssuer)
    ) | (
        {49}out(chC(cred), cred_fromIssuer)
    ) | (
        {50}out(ch((cred,proverDID,n_issuing)), credIssuing_fromIssuer)
    )
) | (
    {51}!
    {56}in(h, x_2: bitstring);
    {52}let sk_3: SecretKey = sk_issuer in
    {58}let sgndMsg_1: bitstring = adec(x_2,sk_3) in
    {59}let (unauth_n_p_1: bitstring,unauth_spk_p_1: PublicKey) = getMsg(sgndMsg_1) in
    {60}let (n_p_1: bitstring,spk_p_1: PublicKey) = auth(sgndMsg_1,unauth_spk_p_1) in
    {61}new ssk_1: SecretKey;
    {62}new n_i_1: bitstring;
    {63}let msg_3: bitstring = (n_p_1,n_i_1,pk(ssk_1)) in
    {64}let msg_handshakeResp_1: bitstring = aenc(sign(msg_3,sk_3),spk_p_1) in
    {65}out(h, msg_handshakeResp_1);
    {66}in(h, x_3: bitstring);
    {68}let sk_4: SecretKey = ssk_1 in
    {69}let msg_4: bitstring = auth(adec(x_3,sk_4),spk_p_1) in
    {70}let (unauth_n'_i_1: bitstring,unauth_proverDID_1: DID,unauth_recipientDID_1: DID) = getMsg(msg_4) in
    {71}let pk_p_1: PublicKey = getPubKey(unauth_proverDID_1) in
    {72}let (n'_i_1: bitstring,proverDID_1: DID,recipientDID_1: DID) = auth(msg_4,pk_p_1) in
    {54}let expectedDID_1: DID = genDID(pk(sk_otherAgent),sk_otherAgent) in
    {73}if (proverDID_1 = expectedDID_1) then
    {74}if (n'_i_1 = n_i_1) then
    {75}if (recipientDID_1 = genDID(pk(sk_3),sk_3)) then
    {77}new n_issuing_1: bitstring;
    {79}let sk_5: SecretKey = ssk_1 in
    {53}let attr_2: bitstring = attr in
    {76}let cred_1: VC = issueVC(proverDID_1,attr_2,sk_3) in
    {78}let msg_5: bitstring = (cred_1,proverDID_1,n_issuing_1) in
    {80}let msg_cred_1: bitstring = aenc(sign(msg_5,sk_5),spk_p_1) in
    {67}let msg_did_1: bitstring = x_3 in
    {57}let msg_handshakeReq_1: bitstring = x_2 in
    {81}event auth_IssuerSendsLastMessageToHolder(msg_handshakeReq_1,msg_handshakeResp_1,msg_did_1,msg_cred_1);
    {82}out(h, msg_cred_1);
    {55}let talksOnlyToHonest_1: bool = false in
    {83}if talksOnlyToHonest_1 then
    (
        {84}event auth_IssuerCompletesProtocol(msg_handshakeReq_1,msg_handshakeResp_1,msg_did_1)
    ) | (
        {85}out(ch(n_p_1), n_p_fromIssuer)
    ) | (
        {86}out(chC(cred_1), cred_fromIssuer)
    ) | (
        {87}out(ch((cred_1,proverDID_1,n_issuing_1)), credIssuing_fromIssuer)
    )
) | (
    {88}!
    {90}let issuerDID: DID = genDID(pk(sk_issuer),sk_issuer) in
    {93}let pk_i: PublicKey = getPubKey(issuerDID) in
    {94}new ssk_2: SecretKey;
    {95}new n_p_2: bitstring;
    {97}let sk_7: SecretKey = ssk_2 in
    {96}let msg_6: bitstring = (n_p_2,pk(ssk_2)) in
    {98}let msg_handshakeReq_2: bitstring = aenc(sign(msg_6,sk_7),pk_i) in
    {99}out(h, msg_handshakeReq_2);
    {100}in(h, x_4: bitstring);
    {102}let sk_8: SecretKey = ssk_2 in
    {103}let msg_7: bitstring = auth(adec(x_4,sk_8),pk_i) in
    {104}let (n'_p: bitstring,n_i_2: bitstring,spk_i: PublicKey) = msg_7 in
    {105}if (n'_p = n_p_2) then
    {107}let sk_9: SecretKey = ssk_2 in
    {89}let sk_6: SecretKey = sk_prover in
    {106}let msg_8: bitstring = sign((n_i_2,genDID(pk(sk_6),sk_6),issuerDID),sk_6) in
    {108}let msg_did_2: bitstring = aenc(sign(msg_8,sk_9),spk_i) in
    {101}let msg_handshakeResp_2: bitstring = x_4 in
    {109}event auth_HolderSendsLastMessageToIssuer(msg_handshakeReq_2,msg_handshakeResp_2,msg_did_2);
    {110}out(h, msg_did_2);
    {111}in(h, x_5: bitstring);
    {113}let sk_10: SecretKey = ssk_2 in
    {114}let (credential: VC,recipientDID_2: DID,n_issuing_2: bitstring) = auth(adec(x_5,sk_10),spk_i) in
    {115}if (recipientDID_2 = genDID(pk(sk_6),sk_6)) then
    {112}let msg_credential: bitstring = x_5 in
    {92}let talksOnlyToHonest_2: bool = true in
    (
        {116}!
        {91}let verifierDID: DID = genDID(pk(sk_verifier),sk_verifier) in
        {117}let pk_v: PublicKey = getPubKey(verifierDID) in
        {118}new ssk_3: SecretKey;
        {119}new n_p_3: bitstring;
        {121}let sk_11: SecretKey = ssk_3 in
        {120}let msg_9: bitstring = (n_p_3,pk(ssk_3)) in
        {122}let msg_handshakeReq_3: bitstring = aenc(sign(msg_9,sk_11),pk_v) in
        {123}out(h, msg_handshakeReq_3);
        {124}in(h, x_6: bitstring);
        {126}let sk_12: SecretKey = ssk_3 in
        {127}let msg_10: bitstring = auth(adec(x_6,sk_12),pk_v) in
        {128}let (n'_p_1: bitstring,n_v: bitstring,spk_v: PublicKey) = msg_10 in
        {129}if (n'_p_1 = n_p_3) then
        {131}let sk_13: SecretKey = ssk_3 in
        {130}let msg_11: bitstring = (n_v,uri) in
        {132}let msg_uri: bitstring = aenc(sign(msg_11,sk_13),spk_v) in
        {133}out(h, msg_uri);
        {134}in(h, x_7: bitstring);
        {136}let sk_14: SecretKey = ssk_3 in
        {137}let msg_12: bitstring = auth(adec(x_7,sk_14),spk_v) in
        {138}let (n_c: bitstring,rule: ACR) = msg_12 in
        {139}if (getVcAsTuple(credential) = getRuleAsTuple(rule)) then
        {141}let sk_15: SecretKey = ssk_3 in
        {140}let vp: bitstring = sign((n_c,verifierDID,credential),sk_6) in
        {142}let msg_vp: bitstring = aenc(sign(vp,sk_15),spk_v) in
        {135}let msg_rule: bitstring = x_7 in
        {125}let msg_handshakeResp_3: bitstring = x_6 in
        {143}event auth_ProverSendsLastMessageToVerifier(msg_handshakeReq_3,msg_handshakeResp_3,msg_uri,msg_rule,msg_vp);
        {144}event auth_ProverSendsLastMessageToVerifierInProtocolFull(msg_handshakeReq_2,msg_handshakeResp_2,msg_did_2,msg_credential,msg_handshakeReq_3,msg_handshakeResp_3,msg_uri,msg_rule,msg_vp);
        {145}out(h, msg_vp);
        {146}in(h, x_8: bitstring);
        {148}let sk_16: SecretKey = ssk_3 in
        {149}let (access_token: bitstring,recipientDID_3: DID) = auth(adec(x_8,sk_16),spk_v) in
        {150}if (recipientDID_3 = genDID(pk(sk_6),sk_6)) then
        {151}if talksOnlyToHonest_2 then
        (
            {147}let msg_accessToken: bitstring = x_8 in
            {152}event auth_ProverCompletesProtocol(msg_handshakeReq_3,msg_handshakeResp_3,msg_uri,msg_rule,msg_vp,msg_accessToken)
        ) | (
            {153}out(ch(n_p_3), n_p_fromProver)
        ) | (
            {154}out(chR(rule), rule_fromProver)
        ) | (
            {155}out(ch((n_c,verifierDID,credential)), unsigned_vp_fromProver)
        ) | (
            {156}out(ch(vp), vp_fromProver)
        ) | (
            {157}out(chC(credential), cred_fromProver)
        ) | (
            {158}out(ch(access_token), access_token_fromProver)
        )
    ) | (
        {159}if talksOnlyToHonest_2 then
        (
            {160}event auth_HolderCompletesProtocol(msg_handshakeReq_2,msg_handshakeResp_2,msg_did_2,msg_credential)
        ) | (
            {161}out(ch(n_p_2), n_p_fromHolder)
        ) | (
            {162}out(ch(n_i_2), n_i_fromHolder)
        ) | (
            {163}out(ch((n_i_2,genDID(pk(sk_6),sk_6),issuerDID)), providingDID_fromHolder)
        ) | (
            {164}out(chC(credential), cred_fromHolder)
        )
    )
) | (
    {165}!
    {167}let issuerDID_1: DID = genDID(pk(sk_issuer),sk_issuer) in
    {170}let pk_i_1: PublicKey = getPubKey(issuerDID_1) in
    {171}new ssk_4: SecretKey;
    {172}new n_p_4: bitstring;
    {174}let sk_18: SecretKey = ssk_4 in
    {173}let msg_13: bitstring = (n_p_4,pk(ssk_4)) in
    {175}let msg_handshakeReq_4: bitstring = aenc(sign(msg_13,sk_18),pk_i_1) in
    {176}out(h, msg_handshakeReq_4);
    {177}in(h, x_9: bitstring);
    {179}let sk_19: SecretKey = ssk_4 in
    {180}let msg_14: bitstring = auth(adec(x_9,sk_19),pk_i_1) in
    {181}let (n'_p_2: bitstring,n_i_3: bitstring,spk_i_1: PublicKey) = msg_14 in
    {182}if (n'_p_2 = n_p_4) then
    {184}let sk_20: SecretKey = ssk_4 in
    {166}let sk_17: SecretKey = sk_prover in
    {183}let msg_15: bitstring = sign((n_i_3,genDID(pk(sk_17),sk_17),issuerDID_1),sk_17) in
    {185}let msg_did_3: bitstring = aenc(sign(msg_15,sk_20),spk_i_1) in
    {178}let msg_handshakeResp_4: bitstring = x_9 in
    {186}event auth_HolderSendsLastMessageToIssuer(msg_handshakeReq_4,msg_handshakeResp_4,msg_did_3);
    {187}out(h, msg_did_3);
    {188}in(h, x_10: bitstring);
    {190}let sk_21: SecretKey = ssk_4 in
    {191}let (credential_1: VC,recipientDID_4: DID,n_issuing_3: bitstring) = auth(adec(x_10,sk_21),spk_i_1) in
    {192}if (recipientDID_4 = genDID(pk(sk_17),sk_17)) then
    {189}let msg_credential_1: bitstring = x_10 in
    {169}let talksOnlyToHonest_3: bool = false in
    (
        {193}!
        {168}let verifierDID_1: DID = genDID(pk(sk_otherAgent),sk_otherAgent) in
        {194}let pk_v_1: PublicKey = getPubKey(verifierDID_1) in
        {195}new ssk_5: SecretKey;
        {196}new n_p_5: bitstring;
        {198}let sk_22: SecretKey = ssk_5 in
        {197}let msg_16: bitstring = (n_p_5,pk(ssk_5)) in
        {199}let msg_handshakeReq_5: bitstring = aenc(sign(msg_16,sk_22),pk_v_1) in
        {200}out(h, msg_handshakeReq_5);
        {201}in(h, x_11: bitstring);
        {203}let sk_23: SecretKey = ssk_5 in
        {204}let msg_17: bitstring = auth(adec(x_11,sk_23),pk_v_1) in
        {205}let (n'_p_3: bitstring,n_v_1: bitstring,spk_v_1: PublicKey) = msg_17 in
        {206}if (n'_p_3 = n_p_5) then
        {208}let sk_24: SecretKey = ssk_5 in
        {207}let msg_18: bitstring = (n_v_1,uri) in
        {209}let msg_uri_1: bitstring = aenc(sign(msg_18,sk_24),spk_v_1) in
        {210}out(h, msg_uri_1);
        {211}in(h, x_12: bitstring);
        {213}let sk_25: SecretKey = ssk_5 in
        {214}let msg_19: bitstring = auth(adec(x_12,sk_25),spk_v_1) in
        {215}let (n_c_1: bitstring,rule_1: ACR) = msg_19 in
        {216}if (getVcAsTuple(credential_1) = getRuleAsTuple(rule_1)) then
        {218}let sk_26: SecretKey = ssk_5 in
        {217}let vp_1: bitstring = sign((n_c_1,verifierDID_1,credential_1),sk_17) in
        {219}let msg_vp_1: bitstring = aenc(sign(vp_1,sk_26),spk_v_1) in
        {212}let msg_rule_1: bitstring = x_12 in
        {202}let msg_handshakeResp_5: bitstring = x_11 in
        {220}event auth_ProverSendsLastMessageToVerifier(msg_handshakeReq_5,msg_handshakeResp_5,msg_uri_1,msg_rule_1,msg_vp_1);
        {221}event auth_ProverSendsLastMessageToVerifierInProtocolFull(msg_handshakeReq_4,msg_handshakeResp_4,msg_did_3,msg_credential_1,msg_handshakeReq_5,msg_handshakeResp_5,msg_uri_1,msg_rule_1,msg_vp_1);
        {222}out(h, msg_vp_1);
        {223}in(h, x_13: bitstring);
        {225}let sk_27: SecretKey = ssk_5 in
        {226}let (access_token_1: bitstring,recipientDID_5: DID) = auth(adec(x_13,sk_27),spk_v_1) in
        {227}if (recipientDID_5 = genDID(pk(sk_17),sk_17)) then
        {228}if talksOnlyToHonest_3 then
        (
            {224}let msg_accessToken_1: bitstring = x_13 in
            {229}event auth_ProverCompletesProtocol(msg_handshakeReq_5,msg_handshakeResp_5,msg_uri_1,msg_rule_1,msg_vp_1,msg_accessToken_1)
        ) | (
            {230}out(ch(n_p_5), n_p_fromProver)
        ) | (
            {231}out(chR(rule_1), rule_fromProver)
        ) | (
            {232}out(ch((n_c_1,verifierDID_1,credential_1)), unsigned_vp_fromProver)
        ) | (
            {233}out(ch(vp_1), vp_fromProver)
        ) | (
            {234}out(chC(credential_1), cred_fromProver)
        ) | (
            {235}out(ch(access_token_1), access_token_fromProver)
        )
    ) | (
        {236}if talksOnlyToHonest_3 then
        (
            {237}event auth_HolderCompletesProtocol(msg_handshakeReq_4,msg_handshakeResp_4,msg_did_3,msg_credential_1)
        ) | (
            {238}out(ch(n_p_4), n_p_fromHolder)
        ) | (
            {239}out(ch(n_i_3), n_i_fromHolder)
        ) | (
            {240}out(ch((n_i_3,genDID(pk(sk_17),sk_17),issuerDID_1)), providingDID_fromHolder)
        ) | (
            {241}out(chC(credential_1), cred_fromHolder)
        )
    )
) | (
    {242}!
    {244}let issuerDID_2: DID = genDID(pk(sk_otherAgent),sk_otherAgent) in
    {247}let pk_i_2: PublicKey = getPubKey(issuerDID_2) in
    {248}new ssk_6: SecretKey;
    {249}new n_p_6: bitstring;
    {251}let sk_29: SecretKey = ssk_6 in
    {250}let msg_20: bitstring = (n_p_6,pk(ssk_6)) in
    {252}let msg_handshakeReq_6: bitstring = aenc(sign(msg_20,sk_29),pk_i_2) in
    {253}out(h, msg_handshakeReq_6);
    {254}in(h, x_14: bitstring);
    {256}let sk_30: SecretKey = ssk_6 in
    {257}let msg_21: bitstring = auth(adec(x_14,sk_30),pk_i_2) in
    {258}let (n'_p_4: bitstring,n_i_4: bitstring,spk_i_2: PublicKey) = msg_21 in
    {259}if (n'_p_4 = n_p_6) then
    {261}let sk_31: SecretKey = ssk_6 in
    {243}let sk_28: SecretKey = sk_prover in
    {260}let msg_22: bitstring = sign((n_i_4,genDID(pk(sk_28),sk_28),issuerDID_2),sk_28) in
    {262}let msg_did_4: bitstring = aenc(sign(msg_22,sk_31),spk_i_2) in
    {255}let msg_handshakeResp_6: bitstring = x_14 in
    {263}event auth_HolderSendsLastMessageToIssuer(msg_handshakeReq_6,msg_handshakeResp_6,msg_did_4);
    {264}out(h, msg_did_4);
    {265}in(h, x_15: bitstring);
    {267}let sk_32: SecretKey = ssk_6 in
    {268}let (credential_2: VC,recipientDID_6: DID,n_issuing_4: bitstring) = auth(adec(x_15,sk_32),spk_i_2) in
    {269}if (recipientDID_6 = genDID(pk(sk_28),sk_28)) then
    {266}let msg_credential_2: bitstring = x_15 in
    {246}let talksOnlyToHonest_4: bool = false in
    (
        {270}!
        {245}let verifierDID_2: DID = genDID(pk(sk_verifier),sk_verifier) in
        {271}let pk_v_2: PublicKey = getPubKey(verifierDID_2) in
        {272}new ssk_7: SecretKey;
        {273}new n_p_7: bitstring;
        {275}let sk_33: SecretKey = ssk_7 in
        {274}let msg_23: bitstring = (n_p_7,pk(ssk_7)) in
        {276}let msg_handshakeReq_7: bitstring = aenc(sign(msg_23,sk_33),pk_v_2) in
        {277}out(h, msg_handshakeReq_7);
        {278}in(h, x_16: bitstring);
        {280}let sk_34: SecretKey = ssk_7 in
        {281}let msg_24: bitstring = auth(adec(x_16,sk_34),pk_v_2) in
        {282}let (n'_p_5: bitstring,n_v_2: bitstring,spk_v_2: PublicKey) = msg_24 in
        {283}if (n'_p_5 = n_p_7) then
        {285}let sk_35: SecretKey = ssk_7 in
        {284}let msg_25: bitstring = (n_v_2,uri) in
        {286}let msg_uri_2: bitstring = aenc(sign(msg_25,sk_35),spk_v_2) in
        {287}out(h, msg_uri_2);
        {288}in(h, x_17: bitstring);
        {290}let sk_36: SecretKey = ssk_7 in
        {291}let msg_26: bitstring = auth(adec(x_17,sk_36),spk_v_2) in
        {292}let (n_c_2: bitstring,rule_2: ACR) = msg_26 in
        {293}if (getVcAsTuple(credential_2) = getRuleAsTuple(rule_2)) then
        {295}let sk_37: SecretKey = ssk_7 in
        {294}let vp_2: bitstring = sign((n_c_2,verifierDID_2,credential_2),sk_28) in
        {296}let msg_vp_2: bitstring = aenc(sign(vp_2,sk_37),spk_v_2) in
        {289}let msg_rule_2: bitstring = x_17 in
        {279}let msg_handshakeResp_7: bitstring = x_16 in
        {297}event auth_ProverSendsLastMessageToVerifier(msg_handshakeReq_7,msg_handshakeResp_7,msg_uri_2,msg_rule_2,msg_vp_2);
        {298}event auth_ProverSendsLastMessageToVerifierInProtocolFull(msg_handshakeReq_6,msg_handshakeResp_6,msg_did_4,msg_credential_2,msg_handshakeReq_7,msg_handshakeResp_7,msg_uri_2,msg_rule_2,msg_vp_2);
        {299}out(h, msg_vp_2);
        {300}in(h, x_18: bitstring);
        {302}let sk_38: SecretKey = ssk_7 in
        {303}let (access_token_2: bitstring,recipientDID_7: DID) = auth(adec(x_18,sk_38),spk_v_2) in
        {304}if (recipientDID_7 = genDID(pk(sk_28),sk_28)) then
        {305}if talksOnlyToHonest_4 then
        (
            {301}let msg_accessToken_2: bitstring = x_18 in
            {306}event auth_ProverCompletesProtocol(msg_handshakeReq_7,msg_handshakeResp_7,msg_uri_2,msg_rule_2,msg_vp_2,msg_accessToken_2)
        ) | (
            {307}out(ch(n_p_7), n_p_fromProver)
        ) | (
            {308}out(chR(rule_2), rule_fromProver)
        ) | (
            {309}out(ch((n_c_2,verifierDID_2,credential_2)), unsigned_vp_fromProver)
        ) | (
            {310}out(ch(vp_2), vp_fromProver)
        ) | (
            {311}out(chC(credential_2), cred_fromProver)
        ) | (
            {312}out(ch(access_token_2), access_token_fromProver)
        )
    ) | (
        {313}if talksOnlyToHonest_4 then
        (
            {314}event auth_HolderCompletesProtocol(msg_handshakeReq_6,msg_handshakeResp_6,msg_did_4,msg_credential_2)
        ) | (
            {315}out(ch(n_p_6), n_p_fromHolder)
        ) | (
            {316}out(ch(n_i_4), n_i_fromHolder)
        ) | (
            {317}out(ch((n_i_4,genDID(pk(sk_28),sk_28),issuerDID_2)), providingDID_fromHolder)
        ) | (
            {318}out(chC(credential_2), cred_fromHolder)
        )
    )
) | (
    {319}!
    {321}let issuerDID_3: DID = genDID(pk(sk_otherAgent),sk_otherAgent) in
    {324}let pk_i_3: PublicKey = getPubKey(issuerDID_3) in
    {325}new ssk_8: SecretKey;
    {326}new n_p_8: bitstring;
    {328}let sk_40: SecretKey = ssk_8 in
    {327}let msg_27: bitstring = (n_p_8,pk(ssk_8)) in
    {329}let msg_handshakeReq_8: bitstring = aenc(sign(msg_27,sk_40),pk_i_3) in
    {330}out(h, msg_handshakeReq_8);
    {331}in(h, x_19: bitstring);
    {333}let sk_41: SecretKey = ssk_8 in
    {334}let msg_28: bitstring = auth(adec(x_19,sk_41),pk_i_3) in
    {335}let (n'_p_6: bitstring,n_i_5: bitstring,spk_i_3: PublicKey) = msg_28 in
    {336}if (n'_p_6 = n_p_8) then
    {338}let sk_42: SecretKey = ssk_8 in
    {320}let sk_39: SecretKey = sk_prover in
    {337}let msg_29: bitstring = sign((n_i_5,genDID(pk(sk_39),sk_39),issuerDID_3),sk_39) in
    {339}let msg_did_5: bitstring = aenc(sign(msg_29,sk_42),spk_i_3) in
    {332}let msg_handshakeResp_8: bitstring = x_19 in
    {340}event auth_HolderSendsLastMessageToIssuer(msg_handshakeReq_8,msg_handshakeResp_8,msg_did_5);
    {341}out(h, msg_did_5);
    {342}in(h, x_20: bitstring);
    {344}let sk_43: SecretKey = ssk_8 in
    {345}let (credential_3: VC,recipientDID_8: DID,n_issuing_5: bitstring) = auth(adec(x_20,sk_43),spk_i_3) in
    {346}if (recipientDID_8 = genDID(pk(sk_39),sk_39)) then
    {343}let msg_credential_3: bitstring = x_20 in
    {323}let talksOnlyToHonest_5: bool = false in
    (
        {347}!
        {322}let verifierDID_3: DID = genDID(pk(sk_otherAgent),sk_otherAgent) in
        {348}let pk_v_3: PublicKey = getPubKey(verifierDID_3) in
        {349}new ssk_9: SecretKey;
        {350}new n_p_9: bitstring;
        {352}let sk_44: SecretKey = ssk_9 in
        {351}let msg_30: bitstring = (n_p_9,pk(ssk_9)) in
        {353}let msg_handshakeReq_9: bitstring = aenc(sign(msg_30,sk_44),pk_v_3) in
        {354}out(h, msg_handshakeReq_9);
        {355}in(h, x_21: bitstring);
        {357}let sk_45: SecretKey = ssk_9 in
        {358}let msg_31: bitstring = auth(adec(x_21,sk_45),pk_v_3) in
        {359}let (n'_p_7: bitstring,n_v_3: bitstring,spk_v_3: PublicKey) = msg_31 in
        {360}if (n'_p_7 = n_p_9) then
        {362}let sk_46: SecretKey = ssk_9 in
        {361}let msg_32: bitstring = (n_v_3,uri) in
        {363}let msg_uri_3: bitstring = aenc(sign(msg_32,sk_46),spk_v_3) in
        {364}out(h, msg_uri_3);
        {365}in(h, x_22: bitstring);
        {367}let sk_47: SecretKey = ssk_9 in
        {368}let msg_33: bitstring = auth(adec(x_22,sk_47),spk_v_3) in
        {369}let (n_c_3: bitstring,rule_3: ACR) = msg_33 in
        {370}if (getVcAsTuple(credential_3) = getRuleAsTuple(rule_3)) then
        {372}let sk_48: SecretKey = ssk_9 in
        {371}let vp_3: bitstring = sign((n_c_3,verifierDID_3,credential_3),sk_39) in
        {373}let msg_vp_3: bitstring = aenc(sign(vp_3,sk_48),spk_v_3) in
        {366}let msg_rule_3: bitstring = x_22 in
        {356}let msg_handshakeResp_9: bitstring = x_21 in
        {374}event auth_ProverSendsLastMessageToVerifier(msg_handshakeReq_9,msg_handshakeResp_9,msg_uri_3,msg_rule_3,msg_vp_3);
        {375}event auth_ProverSendsLastMessageToVerifierInProtocolFull(msg_handshakeReq_8,msg_handshakeResp_8,msg_did_5,msg_credential_3,msg_handshakeReq_9,msg_handshakeResp_9,msg_uri_3,msg_rule_3,msg_vp_3);
        {376}out(h, msg_vp_3);
        {377}in(h, x_23: bitstring);
        {379}let sk_49: SecretKey = ssk_9 in
        {380}let (access_token_3: bitstring,recipientDID_9: DID) = auth(adec(x_23,sk_49),spk_v_3) in
        {381}if (recipientDID_9 = genDID(pk(sk_39),sk_39)) then
        {382}if talksOnlyToHonest_5 then
        (
            {378}let msg_accessToken_3: bitstring = x_23 in
            {383}event auth_ProverCompletesProtocol(msg_handshakeReq_9,msg_handshakeResp_9,msg_uri_3,msg_rule_3,msg_vp_3,msg_accessToken_3)
        ) | (
            {384}out(ch(n_p_9), n_p_fromProver)
        ) | (
            {385}out(chR(rule_3), rule_fromProver)
        ) | (
            {386}out(ch((n_c_3,verifierDID_3,credential_3)), unsigned_vp_fromProver)
        ) | (
            {387}out(ch(vp_3), vp_fromProver)
        ) | (
            {388}out(chC(credential_3), cred_fromProver)
        ) | (
            {389}out(ch(access_token_3), access_token_fromProver)
        )
    ) | (
        {390}if talksOnlyToHonest_5 then
        (
            {391}event auth_HolderCompletesProtocol(msg_handshakeReq_8,msg_handshakeResp_8,msg_did_5,msg_credential_3)
        ) | (
            {392}out(ch(n_p_8), n_p_fromHolder)
        ) | (
            {393}out(ch(n_i_5), n_i_fromHolder)
        ) | (
            {394}out(ch((n_i_5,genDID(pk(sk_39),sk_39),issuerDID_3)), providingDID_fromHolder)
        ) | (
            {395}out(chC(credential_3), cred_fromHolder)
        )
    )
) | (
    {396}!
    {399}in(h, x_24: bitstring);
    {397}let sk_50: SecretKey = sk_verifier in
    {401}let sgndMsg_2: bitstring = adec(x_24,sk_50) in
    {403}let (unauth_n_p_2: bitstring,unauth_spk_p_2: PublicKey) = getMsg(sgndMsg_2) in
    {404}let (n_p_10: bitstring,spk_p_2: PublicKey) = auth(sgndMsg_2,unauth_spk_p_2) in
    {405}new ssk_10: SecretKey;
    {406}new n_v_4: bitstring;
    {407}let msg_35: bitstring = (n_p_10,n_v_4,pk(ssk_10)) in
    {408}let msg_handshakeResp_10: bitstring = aenc(sign(msg_35,sk_50),spk_p_2) in
    {409}out(h, msg_handshakeResp_10);
    {410}in(h, x_25: bitstring);
    {412}let sk_51: SecretKey = ssk_10 in
    {413}let msg_36: bitstring = auth(adec(x_25,sk_51),spk_p_2) in
    {414}let (n'_v: bitstring,u: bitstring) = msg_36 in
    {415}if (n'_v = n_v_4) then
    {416}if (u = uri) then
    {417}new n_c_4: bitstring;
    {419}let sk_52: SecretKey = ssk_10 in
    {10}let acr: ACR = makeRule(genDID(pk(sk_prover),sk_prover),attr,genDID(pk(sk_issuer),sk_issuer)) in
    {418}let msg_37: bitstring = (n_c_4,acr) in
    {420}let msg_rule_4: bitstring = aenc(sign(msg_37,sk_52),spk_p_2) in
    {421}out(h, msg_rule_4);
    {422}in(h, x_26: bitstring);
    {424}let sk_53: SecretKey = ssk_10 in
    {425}let unauth_vp: bitstring = auth(adec(x_26,sk_53),spk_p_2) in
    {426}let (unauth_n'_c: bitstring,unauth_recipient: DID,unauth_cred: VC) = getMsg(unauth_vp) in
    {427}let cred_subject: DID = getSubjectFromVC(unauth_cred) in
    {428}if (cred_subject = getSubjectFromRule(acr)) then
    {429}let pk_subject: PublicKey = getPubKey(cred_subject) in
    {430}let (n'_c: bitstring,recipientDID_10: DID,cred_2: VC) = auth(unauth_vp,pk_subject) in
    {431}if (recipientDID_10 = genDID(pk(sk_50),sk_50)) then
    {432}if (n'_c = n_c_4) then
    {433}if (getIssuerFromVC(cred_2) = getIssuerFromRule(acr)) then
    {434}let (subjectDID: DID,asserted_attr: bitstring,issuerDID_4: DID) = verify(cred_2,getPubKey(getIssuerFromVC(cred_2))) in
    {435}if (asserted_attr = getAttrFromRule(acr)) then
    {436}new access_token_4: bitstring;
    {438}let sk_54: SecretKey = ssk_10 in
    {437}let msg_38: bitstring = (subjectDID,access_token_4) in
    {439}let msg_accessToken_4: bitstring = aenc(sign(msg_38,sk_54),spk_p_2) in
    {423}let msg_vp_4: bitstring = x_26 in
    {411}let msg_uri_4: bitstring = x_25 in
    {400}let msg_handshakeReq_10: bitstring = x_24 in
    {440}event auth_VerifierSendsLastMessageToProver(msg_handshakeReq_10,msg_handshakeResp_10,msg_uri_4,msg_rule_4,msg_vp_4,msg_accessToken_4);
    {441}out(h, msg_accessToken_4);
    {398}let talksOnlyToHonest_6: bool = true in
    {442}if talksOnlyToHonest_6 then
    (
        {443}event auth_VerifierCompletesProtocol(msg_handshakeReq_10,msg_handshakeResp_10,msg_uri_4,msg_rule_4,msg_vp_4)
    ) | (
        {444}out(ch(n_p_10), n_p_fromVerifier)
    ) | (
        {445}out(chR(acr), rule_fromVerifier)
    ) | (
        {446}out(ch((n_c_4,acr)), credRequest_fromVerifier)
    ) | (
        {447}out(ch(unauth_vp), unauth_vp_fromVerifier)
    ) | (
        {448}out(ch((n'_c,recipientDID_10,cred_2)), vp_fromVerifier)
    ) | (
        {449}out(chC(cred_2), cred_fromVerifier)
    ) | (
        {450}out(ch(access_token_4), access_token_fromVerifier)
    )
) | (
    {451}!
    {454}in(h, x_27: bitstring);
    {452}let sk_55: SecretKey = sk_verifier in
    {456}let sgndMsg_3: bitstring = adec(x_27,sk_55) in
    {458}let (unauth_n_p_3: bitstring,unauth_spk_p_3: PublicKey) = getMsg(sgndMsg_3) in
    {459}let (n_p_11: bitstring,spk_p_3: PublicKey) = auth(sgndMsg_3,unauth_spk_p_3) in
    {460}new ssk_11: SecretKey;
    {461}new n_v_5: bitstring;
    {462}let msg_40: bitstring = (n_p_11,n_v_5,pk(ssk_11)) in
    {463}let msg_handshakeResp_11: bitstring = aenc(sign(msg_40,sk_55),spk_p_3) in
    {464}out(h, msg_handshakeResp_11);
    {465}in(h, x_28: bitstring);
    {467}let sk_56: SecretKey = ssk_11 in
    {468}let msg_41: bitstring = auth(adec(x_28,sk_56),spk_p_3) in
    {469}let (n'_v_1: bitstring,u_1: bitstring) = msg_41 in
    {470}if (n'_v_1 = n_v_5) then
    {471}if (u_1 = uri) then
    {472}new n_c_5: bitstring;
    {474}let sk_57: SecretKey = ssk_11 in
    {11}let acr_otherAgent: ACR = makeRule(genDID(pk(sk_otherAgent),sk_otherAgent),attr,genDID(pk(sk_issuer),sk_issuer)) in
    {473}let msg_42: bitstring = (n_c_5,acr_otherAgent) in
    {475}let msg_rule_5: bitstring = aenc(sign(msg_42,sk_57),spk_p_3) in
    {476}out(h, msg_rule_5);
    {477}in(h, x_29: bitstring);
    {479}let sk_58: SecretKey = ssk_11 in
    {480}let unauth_vp_1: bitstring = auth(adec(x_29,sk_58),spk_p_3) in
    {481}let (unauth_n'_c_1: bitstring,unauth_recipient_1: DID,unauth_cred_1: VC) = getMsg(unauth_vp_1) in
    {482}let cred_subject_1: DID = getSubjectFromVC(unauth_cred_1) in
    {483}if (cred_subject_1 = getSubjectFromRule(acr_otherAgent)) then
    {484}let pk_subject_1: PublicKey = getPubKey(cred_subject_1) in
    {485}let (n'_c_1: bitstring,recipientDID_11: DID,cred_3: VC) = auth(unauth_vp_1,pk_subject_1) in
    {486}if (recipientDID_11 = genDID(pk(sk_55),sk_55)) then
    {487}if (n'_c_1 = n_c_5) then
    {488}if (getIssuerFromVC(cred_3) = getIssuerFromRule(acr_otherAgent)) then
    {489}let (subjectDID_1: DID,asserted_attr_1: bitstring,issuerDID_5: DID) = verify(cred_3,getPubKey(getIssuerFromVC(cred_3))) in
    {490}if (asserted_attr_1 = getAttrFromRule(acr_otherAgent)) then
    {491}new access_token_5: bitstring;
    {493}let sk_59: SecretKey = ssk_11 in
    {492}let msg_43: bitstring = (subjectDID_1,access_token_5) in
    {494}let msg_accessToken_5: bitstring = aenc(sign(msg_43,sk_59),spk_p_3) in
    {478}let msg_vp_5: bitstring = x_29 in
    {466}let msg_uri_5: bitstring = x_28 in
    {455}let msg_handshakeReq_11: bitstring = x_27 in
    {495}event auth_VerifierSendsLastMessageToProver(msg_handshakeReq_11,msg_handshakeResp_11,msg_uri_5,msg_rule_5,msg_vp_5,msg_accessToken_5);
    {496}out(h, msg_accessToken_5);
    {453}let talksOnlyToHonest_7: bool = false in
    {497}if talksOnlyToHonest_7 then
    (
        {498}event auth_VerifierCompletesProtocol(msg_handshakeReq_11,msg_handshakeResp_11,msg_uri_5,msg_rule_5,msg_vp_5)
    ) | (
        {499}out(ch(n_p_11), n_p_fromVerifier)
    ) | (
        {500}out(chR(acr_otherAgent), rule_fromVerifier)
    ) | (
        {501}out(ch((n_c_5,acr_otherAgent)), credRequest_fromVerifier)
    ) | (
        {502}out(ch(unauth_vp_1), unauth_vp_fromVerifier)
    ) | (
        {503}out(ch((n'_c_1,recipientDID_11,cred_3)), vp_fromVerifier)
    ) | (
        {504}out(chC(cred_3), cred_fromVerifier)
    ) | (
        {505}out(ch(access_token_5), access_token_fromVerifier)
    )
) | (
    {506}!
    {509}in(h, x_30: bitstring);
    {507}let sk_60: SecretKey = sk_verifier in
    {511}let sgndMsg_4: bitstring = adec(x_30,sk_60) in
    {513}let (unauth_n_p_4: bitstring,unauth_spk_p_4: PublicKey) = getMsg(sgndMsg_4) in
    {514}let (n_p_12: bitstring,spk_p_4: PublicKey) = auth(sgndMsg_4,unauth_spk_p_4) in
    {515}new ssk_12: SecretKey;
    {516}new n_v_6: bitstring;
    {517}let msg_45: bitstring = (n_p_12,n_v_6,pk(ssk_12)) in
    {518}let msg_handshakeResp_12: bitstring = aenc(sign(msg_45,sk_60),spk_p_4) in
    {519}out(h, msg_handshakeResp_12);
    {520}in(h, x_31: bitstring);
    {522}let sk_61: SecretKey = ssk_12 in
    {523}let msg_46: bitstring = auth(adec(x_31,sk_61),spk_p_4) in
    {524}let (n'_v_2: bitstring,u_2: bitstring) = msg_46 in
    {525}if (n'_v_2 = n_v_6) then
    {526}if (u_2 = uri) then
    {527}new n_c_6: bitstring;
    {529}let sk_62: SecretKey = ssk_12 in
    {12}let acr_compromisedIssuer: ACR = makeRule(genDID(pk(sk_prover),sk_prover),attr,genDID(pk(sk_otherAgent),sk_otherAgent)) in
    {528}let msg_47: bitstring = (n_c_6,acr_compromisedIssuer) in
    {530}let msg_rule_6: bitstring = aenc(sign(msg_47,sk_62),spk_p_4) in
    {531}out(h, msg_rule_6);
    {532}in(h, x_32: bitstring);
    {534}let sk_63: SecretKey = ssk_12 in
    {535}let unauth_vp_2: bitstring = auth(adec(x_32,sk_63),spk_p_4) in
    {536}let (unauth_n'_c_2: bitstring,unauth_recipient_2: DID,unauth_cred_2: VC) = getMsg(unauth_vp_2) in
    {537}let cred_subject_2: DID = getSubjectFromVC(unauth_cred_2) in
    {538}if (cred_subject_2 = getSubjectFromRule(acr_compromisedIssuer)) then
    {539}let pk_subject_2: PublicKey = getPubKey(cred_subject_2) in
    {540}let (n'_c_2: bitstring,recipientDID_12: DID,cred_4: VC) = auth(unauth_vp_2,pk_subject_2) in
    {541}if (recipientDID_12 = genDID(pk(sk_60),sk_60)) then
    {542}if (n'_c_2 = n_c_6) then
    {543}if (getIssuerFromVC(cred_4) = getIssuerFromRule(acr_compromisedIssuer)) then
    {544}let (subjectDID_2: DID,asserted_attr_2: bitstring,issuerDID_6: DID) = verify(cred_4,getPubKey(getIssuerFromVC(cred_4))) in
    {545}if (asserted_attr_2 = getAttrFromRule(acr_compromisedIssuer)) then
    {546}new access_token_6: bitstring;
    {548}let sk_64: SecretKey = ssk_12 in
    {547}let msg_48: bitstring = (subjectDID_2,access_token_6) in
    {549}let msg_accessToken_6: bitstring = aenc(sign(msg_48,sk_64),spk_p_4) in
    {533}let msg_vp_6: bitstring = x_32 in
    {521}let msg_uri_6: bitstring = x_31 in
    {510}let msg_handshakeReq_12: bitstring = x_30 in
    {550}event auth_VerifierSendsLastMessageToProver(msg_handshakeReq_12,msg_handshakeResp_12,msg_uri_6,msg_rule_6,msg_vp_6,msg_accessToken_6);
    {551}out(h, msg_accessToken_6);
    {508}let talksOnlyToHonest_8: bool = false in
    {552}if talksOnlyToHonest_8 then
    (
        {553}event auth_VerifierCompletesProtocol(msg_handshakeReq_12,msg_handshakeResp_12,msg_uri_6,msg_rule_6,msg_vp_6)
    ) | (
        {554}out(ch(n_p_12), n_p_fromVerifier)
    ) | (
        {555}out(chR(acr_compromisedIssuer), rule_fromVerifier)
    ) | (
        {556}out(ch((n_c_6,acr_compromisedIssuer)), credRequest_fromVerifier)
    ) | (
        {557}out(ch(unauth_vp_2), unauth_vp_fromVerifier)
    ) | (
        {558}out(ch((n'_c_2,recipientDID_12,cred_4)), vp_fromVerifier)
    ) | (
        {559}out(chC(cred_4), cred_fromVerifier)
    ) | (
        {560}out(ch(access_token_6), access_token_fromVerifier)
    )
) | (
    {561}!
    {564}in(h, x_33: bitstring);
    {562}let sk_65: SecretKey = sk_verifier in
    {566}let sgndMsg_5: bitstring = adec(x_33,sk_65) in
    {568}let (unauth_n_p_5: bitstring,unauth_spk_p_5: PublicKey) = getMsg(sgndMsg_5) in
    {569}let (n_p_13: bitstring,spk_p_5: PublicKey) = auth(sgndMsg_5,unauth_spk_p_5) in
    {570}new ssk_13: SecretKey;
    {571}new n_v_7: bitstring;
    {572}let msg_50: bitstring = (n_p_13,n_v_7,pk(ssk_13)) in
    {573}let msg_handshakeResp_13: bitstring = aenc(sign(msg_50,sk_65),spk_p_5) in
    {574}out(h, msg_handshakeResp_13);
    {575}in(h, x_34: bitstring);
    {577}let sk_66: SecretKey = ssk_13 in
    {578}let msg_51: bitstring = auth(adec(x_34,sk_66),spk_p_5) in
    {579}let (n'_v_3: bitstring,u_3: bitstring) = msg_51 in
    {580}if (n'_v_3 = n_v_7) then
    {581}if (u_3 = uri) then
    {582}new n_c_7: bitstring;
    {584}let sk_67: SecretKey = ssk_13 in
    {13}let acr_compromised: ACR = makeRule(genDID(pk(sk_otherAgent),sk_otherAgent),attr,genDID(pk(sk_otherAgent),sk_otherAgent)) in
    {583}let msg_52: bitstring = (n_c_7,acr_compromised) in
    {585}let msg_rule_7: bitstring = aenc(sign(msg_52,sk_67),spk_p_5) in
    {586}out(h, msg_rule_7);
    {587}in(h, x_35: bitstring);
    {589}let sk_68: SecretKey = ssk_13 in
    {590}let unauth_vp_3: bitstring = auth(adec(x_35,sk_68),spk_p_5) in
    {591}let (unauth_n'_c_3: bitstring,unauth_recipient_3: DID,unauth_cred_3: VC) = getMsg(unauth_vp_3) in
    {592}let cred_subject_3: DID = getSubjectFromVC(unauth_cred_3) in
    {593}if (cred_subject_3 = getSubjectFromRule(acr_compromised)) then
    {594}let pk_subject_3: PublicKey = getPubKey(cred_subject_3) in
    {595}let (n'_c_3: bitstring,recipientDID_13: DID,cred_5: VC) = auth(unauth_vp_3,pk_subject_3) in
    {596}if (recipientDID_13 = genDID(pk(sk_65),sk_65)) then
    {597}if (n'_c_3 = n_c_7) then
    {598}if (getIssuerFromVC(cred_5) = getIssuerFromRule(acr_compromised)) then
    {599}let (subjectDID_3: DID,asserted_attr_3: bitstring,issuerDID_7: DID) = verify(cred_5,getPubKey(getIssuerFromVC(cred_5))) in
    {600}if (asserted_attr_3 = getAttrFromRule(acr_compromised)) then
    {601}new access_token_7: bitstring;
    {603}let sk_69: SecretKey = ssk_13 in
    {602}let msg_53: bitstring = (subjectDID_3,access_token_7) in
    {604}let msg_accessToken_7: bitstring = aenc(sign(msg_53,sk_69),spk_p_5) in
    {588}let msg_vp_7: bitstring = x_35 in
    {576}let msg_uri_7: bitstring = x_34 in
    {565}let msg_handshakeReq_13: bitstring = x_33 in
    {605}event auth_VerifierSendsLastMessageToProver(msg_handshakeReq_13,msg_handshakeResp_13,msg_uri_7,msg_rule_7,msg_vp_7,msg_accessToken_7);
    {606}out(h, msg_accessToken_7);
    {563}let talksOnlyToHonest_9: bool = false in
    {607}if talksOnlyToHonest_9 then
    (
        {608}event auth_VerifierCompletesProtocol(msg_handshakeReq_13,msg_handshakeResp_13,msg_uri_7,msg_rule_7,msg_vp_7)
    ) | (
        {609}out(ch(n_p_13), n_p_fromVerifier)
    ) | (
        {610}out(chR(acr_compromised), rule_fromVerifier)
    ) | (
        {611}out(ch((n_c_7,acr_compromised)), credRequest_fromVerifier)
    ) | (
        {612}out(ch(unauth_vp_3), unauth_vp_fromVerifier)
    ) | (
        {613}out(ch((n'_c_3,recipientDID_13,cred_5)), vp_fromVerifier)
    ) | (
        {614}out(chC(cred_5), cred_fromVerifier)
    ) | (
        {615}out(ch(access_token_7), access_token_fromVerifier)
    )
)

-- Query not attacker(n_p_fromHolder[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(n_p_fromHolder[])
RESULT not attacker(n_p_fromHolder[]) is true.
-- Query not attacker(n_i_fromHolder[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(n_i_fromHolder[])
RESULT not attacker(n_i_fromHolder[]) is true.
-- Query not attacker(providingDID_fromHolder[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(providingDID_fromHolder[])
RESULT not attacker(providingDID_fromHolder[]) is true.
-- Query not attacker(n_p_fromIssuer[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(n_p_fromIssuer[])
RESULT not attacker(n_p_fromIssuer[]) is true.
-- Query not attacker(credIssuing_fromIssuer[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(credIssuing_fromIssuer[])
RESULT not attacker(credIssuing_fromIssuer[]) is true.
-- Query not attacker(n_p_fromProver[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(n_p_fromProver[])
RESULT not attacker(n_p_fromProver[]) is true.
-- Query not attacker(unsigned_vp_fromProver[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(unsigned_vp_fromProver[])
RESULT not attacker(unsigned_vp_fromProver[]) is true.
-- Query not attacker(vp_fromProver[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(vp_fromProver[])
RESULT not attacker(vp_fromProver[]) is true.
-- Query not attacker(cred_fromProver[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(cred_fromProver[])
RESULT not attacker(cred_fromProver[]) is true.
-- Query not attacker(access_token_fromProver[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(access_token_fromProver[])
RESULT not attacker(access_token_fromProver[]) is true.
-- Query not attacker(n_p_fromVerifier[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(n_p_fromVerifier[])
RESULT not attacker(n_p_fromVerifier[]) is true.
-- Query not attacker(rule_fromVerifier[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(rule_fromVerifier[])
goal reachable: attacker(rule_fromVerifier[])

Derivation:
Abbreviations:
n_p_14 = n_p_2[!1 = @sid]
ssk_14 = ssk_2[!1 = @sid]
n_i_6 = n_i[x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
ssk_15 = ssk[x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
n_issuing_6 = n_issuing[x_1 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)),x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
n_p_15 = n_p_3[!2 = @sid_2,x_5 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14)),x_4 = aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)),!1 = @sid]
ssk_16 = ssk_3[!2 = @sid_2,x_5 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14)),x_4 = aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)),!1 = @sid]
n_v_8 = n_v_4[x_24 = aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[])),!1 = @sid_3]
ssk_17 = ssk_10[x_24 = aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[])),!1 = @sid_3]
n_c_8 = n_c_4[x_25 = aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17)),x_24 = aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[])),!1 = @sid_3]

1. The message genDID(pk(sk_issuer[]),sk_issuer[]) may be sent to the attacker at output {9}.
attacker(genDID(pk(sk_issuer[]),sk_issuer[])).

2. Using the function attr the attacker may obtain attr.
attacker(attr).

3. The message genDID(pk(sk_prover[]),sk_prover[]) may be sent to the attacker at output {7}.
attacker(genDID(pk(sk_prover[]),sk_prover[])).

4. By 3, the attacker may know genDID(pk(sk_prover[]),sk_prover[]).
By 2, the attacker may know attr.
By 1, the attacker may know genDID(pk(sk_issuer[]),sk_issuer[]).
Using the function makeRule the attacker may obtain makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[])).
attacker(makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))).

5. By 4, the attacker may know makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[])).
Using the function chR the attacker may obtain chR(makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))).
attacker(chR(makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[])))).

6. The message aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])) may be sent to the attacker at output {99}.
attacker(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[]))).

7. The message aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])) that the attacker may have by 6 may be received at input {19}.
So the message aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)) may be sent to the attacker at output {28}.
attacker(aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14))).

8. The message aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)) that the attacker may have by 7 may be received at input {100}.
So the message aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)) may be sent to the attacker at output {110}.
attacker(aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15))).

9. The message aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])) that the attacker may have by 6 may be received at input {19}.
The message aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)) that the attacker may have by 8 may be received at input {29}.
So the message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14)) may be sent to the attacker at output {45}.
attacker(aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14))).

10. The message aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)) that the attacker may have by 7 may be received at input {100}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14)) that the attacker may have by 9 may be received at input {111}.
So the message aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[])) may be sent to the attacker at output {123}.
attacker(aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[]))).

11. The message aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[])) that the attacker may have by 10 may be received at input {399}.
So the message aenc(sign((n_p_15,n_v_8,pk(ssk_17)),sk_verifier[]),pk(ssk_16)) may be sent to the attacker at output {409}.
attacker(aenc(sign((n_p_15,n_v_8,pk(ssk_17)),sk_verifier[]),pk(ssk_16))).

12. The message aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)) that the attacker may have by 7 may be received at input {100}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14)) that the attacker may have by 9 may be received at input {111}.
The message aenc(sign((n_p_15,n_v_8,pk(ssk_17)),sk_verifier[]),pk(ssk_16)) that the attacker may have by 11 may be received at input {124}.
So the message aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17)) may be sent to the attacker at output {133}.
attacker(aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17))).

13. The message aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[])) that the attacker may have by 10 may be received at input {399}.
The message aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17)) that the attacker may have by 12 may be received at input {410}.
So the message aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_17),pk(ssk_16)) may be sent to the attacker at output {421}.
attacker(aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_17),pk(ssk_16))).

14. The message aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)) that the attacker may have by 7 may be received at input {100}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14)) that the attacker may have by 9 may be received at input {111}.
The message aenc(sign((n_p_15,n_v_8,pk(ssk_17)),sk_verifier[]),pk(ssk_16)) that the attacker may have by 11 may be received at input {124}.
The message aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_17),pk(ssk_16)) that the attacker may have by 13 may be received at input {134}.
So the message aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_16),pk(ssk_17)) may be sent to the attacker at output {145}.
attacker(aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_16),pk(ssk_17))).

15. The message aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[])) that the attacker may have by 10 may be received at input {399}.
The message aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17)) that the attacker may have by 12 may be received at input {410}.
The message aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_16),pk(ssk_17)) that the attacker may have by 14 may be received at input {422}.
So the message rule_fromVerifier[] may be sent on channel chR(makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))) at output {445}.
mess(chR(makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),rule_fromVerifier[]).

16. By 5, the attacker may have the channel chR(makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))).
By 15, the message rule_fromVerifier[] may be sent on this channel.
So the attacker may obtain the message rule_fromVerifier[] by listening on this channel.
attacker(rule_fromVerifier[]).

17. By 16, attacker(rule_fromVerifier[]).
The goal is reached, represented in the following fact:
attacker(rule_fromVerifier[]).


A more detailed output of the traces is available with
  set traceDisplay = long.

new sk_prover: SecretKey creating sk_prover_1 at {1}

new sk_verifier: SecretKey creating sk_verifier_1 at {2}

new sk_issuer: SecretKey creating sk_issuer_1 at {3}

out(h, ~M) with ~M = pk(sk_issuer_1) at {4}

out(h, ~M_1) with ~M_1 = pk(sk_verifier_1) at {5}

out(h, ~M_2) with ~M_2 = pk(sk_prover_1) at {6}

out(h, ~M_3) with ~M_3 = genDID(pk(sk_prover_1),sk_prover_1) at {7}

out(h, ~M_4) with ~M_4 = genDID(pk(sk_verifier_1),sk_verifier_1) at {8}

out(h, ~M_5) with ~M_5 = genDID(pk(sk_issuer_1),sk_issuer_1) at {9}

new ssk_2: SecretKey creating ssk_14 at {94} in copy a

new n_p_2: bitstring creating n_p_14 at {95} in copy a

out(h, ~M_6) with ~M_6 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer_1)) at {99} in copy a

in(h, ~M_6) with ~M_6 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer_1)) at {19} in copy a_1

new ssk: SecretKey creating ssk_15 at {24} in copy a_1

new n_i: bitstring creating n_i_6 at {25} in copy a_1

out(h, ~M_7) with ~M_7 = aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer_1),pk(ssk_14)) at {28} in copy a_1

in(h, ~M_7) with ~M_7 = aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer_1),pk(ssk_14)) at {100} in copy a

event auth_HolderSendsLastMessageToIssuer(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer_1)),aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer_1),pk(ssk_14)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_14),pk(ssk_15))) at {109} in copy a

out(h, ~M_8) with ~M_8 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_14),pk(ssk_15)) at {110} in copy a

in(h, ~M_8) with ~M_8 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_14),pk(ssk_15)) at {29} in copy a_1

new n_issuing: bitstring creating n_issuing_6 at {40} in copy a_1

event auth_IssuerSendsLastMessageToHolder(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer_1)),aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer_1),pk(ssk_14)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_14),pk(ssk_15)),aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_15),pk(ssk_14))) at {44} in copy a_1

out(h, ~M_9) with ~M_9 = aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_15),pk(ssk_14)) at {45} in copy a_1

event auth_IssuerCompletesProtocol(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer_1)),aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer_1),pk(ssk_14)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_14),pk(ssk_15))) at {47} in copy a_1

in(h, ~M_9) with ~M_9 = aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_15),pk(ssk_14)) at {111} in copy a

event auth_HolderCompletesProtocol(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer_1)),aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer_1),pk(ssk_14)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_14),pk(ssk_15)),aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_15),pk(ssk_14))) at {160} in copy a

new ssk_3: SecretKey creating ssk_16 at {118} in copy a, a_2

new n_p_3: bitstring creating n_p_15 at {119} in copy a, a_2

out(h, ~M_10) with ~M_10 = aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier_1)) at {123} in copy a, a_2

in(h, ~M_10) with ~M_10 = aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier_1)) at {399} in copy a_3

new ssk_10: SecretKey creating ssk_17 at {405} in copy a_3

new n_v_4: bitstring creating n_v_8 at {406} in copy a_3

out(h, ~M_11) with ~M_11 = aenc(sign((n_p_15,n_v_8,pk(ssk_17)),sk_verifier_1),pk(ssk_16)) at {409} in copy a_3

in(h, ~M_11) with ~M_11 = aenc(sign((n_p_15,n_v_8,pk(ssk_17)),sk_verifier_1),pk(ssk_16)) at {124} in copy a, a_2

out(h, ~M_12) with ~M_12 = aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17)) at {133} in copy a, a_2

in(h, ~M_12) with ~M_12 = aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17)) at {410} in copy a_3

new n_c_4: bitstring creating n_c_8 at {417} in copy a_3

out(h, ~M_13) with ~M_13 = aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_17),pk(ssk_16)) at {421} in copy a_3

in(h, ~M_13) with ~M_13 = aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_17),pk(ssk_16)) at {134} in copy a, a_2

event auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier_1)),aenc(sign((n_p_15,n_v_8,pk(ssk_17)),sk_verifier_1),pk(ssk_16)),aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_17),pk(ssk_16)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_16),pk(ssk_17))) at {143} in copy a, a_2

event auth_ProverSendsLastMessageToVerifierInProtocolFull(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer_1)),aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer_1),pk(ssk_14)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_14),pk(ssk_15)),aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_15),pk(ssk_14)),aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier_1)),aenc(sign((n_p_15,n_v_8,pk(ssk_17)),sk_verifier_1),pk(ssk_16)),aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_17),pk(ssk_16)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_16),pk(ssk_17))) at {144} in copy a, a_2

out(h, ~M_14) with ~M_14 = aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_16),pk(ssk_17)) at {145} in copy a, a_2

in(h, ~M_14) with ~M_14 = aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_16),pk(ssk_17)) at {422} in copy a_3

new access_token_4: bitstring creating access_token_8 at {436} in copy a_3

event auth_VerifierSendsLastMessageToProver(aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier_1)),aenc(sign((n_p_15,n_v_8,pk(ssk_17)),sk_verifier_1),pk(ssk_16)),aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_17),pk(ssk_16)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_16),pk(ssk_17)),aenc(sign((genDID(pk(sk_prover_1),sk_prover_1),access_token_8),ssk_17),pk(ssk_16))) at {440} in copy a_3

out(h, ~M_15) with ~M_15 = aenc(sign((genDID(pk(sk_prover_1),sk_prover_1),access_token_8),ssk_17),pk(ssk_16)) at {441} in copy a_3

out(chR(makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))), ~M_16) with ~M_16 = rule_fromVerifier at {445} in copy a_3

event auth_VerifierCompletesProtocol(aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier_1)),aenc(sign((n_p_15,n_v_8,pk(ssk_17)),sk_verifier_1),pk(ssk_16)),aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_17),pk(ssk_16)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_16),pk(ssk_17))) at {443} in copy a_3

The attacker has the message ~M_16 = rule_fromVerifier.
A trace has been found.
RESULT not attacker(rule_fromVerifier[]) is false.
-- Query not attacker(credRequest_fromVerifier[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(credRequest_fromVerifier[])
RESULT not attacker(credRequest_fromVerifier[]) is true.
-- Query not attacker(unauth_vp_fromVerifier[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(unauth_vp_fromVerifier[])
RESULT not attacker(unauth_vp_fromVerifier[]) is true.
-- Query not attacker(vp_fromVerifier[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(vp_fromVerifier[])
RESULT not attacker(vp_fromVerifier[]) is true.
-- Query not attacker(cred_fromVerifier[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(cred_fromVerifier[])
goal reachable: attacker(cred_fromVerifier[])

Derivation:
Abbreviations:
n_p_14 = n_p_2[!1 = @sid]
ssk_14 = ssk_2[!1 = @sid]
n_i_6 = n_i[x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
ssk_15 = ssk[x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
n_issuing_6 = n_issuing[x_1 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)),x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
n_p_15 = n_p_3[!2 = @sid_2,x_5 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14)),x_4 = aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)),!1 = @sid]
ssk_16 = ssk_3[!2 = @sid_2,x_5 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14)),x_4 = aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)),!1 = @sid]
n_v_8 = n_v_4[x_24 = aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[])),!1 = @sid_3]
ssk_17 = ssk_10[x_24 = aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[])),!1 = @sid_3]
n_c_8 = n_c_4[x_25 = aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17)),x_24 = aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[])),!1 = @sid_3]
n_p_16 = n_p_4[!1 = @sid_4]
ssk_18 = ssk_4[!1 = @sid_4]
n_i_7 = n_i[x = aenc(sign((n_p_16,pk(ssk_18)),ssk_18),pk(sk_issuer[])),!1 = @sid_5]
ssk_19 = ssk[x = aenc(sign((n_p_16,pk(ssk_18)),ssk_18),pk(sk_issuer[])),!1 = @sid_5]
n_issuing_7 = n_issuing[x_1 = aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_18),pk(ssk_19)),x = aenc(sign((n_p_16,pk(ssk_18)),ssk_18),pk(sk_issuer[])),!1 = @sid_5]
ssk_20 = ssk_5[!2 = @sid_6,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_19),pk(ssk_18)),x_9 = aenc(sign((n_p_16,n_i_7,pk(ssk_19)),sk_issuer[]),pk(ssk_18)),!1 = @sid_4]
n_p_17 = n_p_5[!2 = @sid_6,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_19),pk(ssk_18)),x_9 = aenc(sign((n_p_16,n_i_7,pk(ssk_19)),sk_issuer[]),pk(ssk_18)),!1 = @sid_4]

1. The attacker has some term sk_70.
attacker(sk_70).

2. The message aenc(sign((n_p_16,pk(ssk_18)),ssk_18),pk(sk_issuer[])) may be sent to the attacker at output {176}.
attacker(aenc(sign((n_p_16,pk(ssk_18)),ssk_18),pk(sk_issuer[]))).

3. The message aenc(sign((n_p_16,pk(ssk_18)),ssk_18),pk(sk_issuer[])) that the attacker may have by 2 may be received at input {19}.
So the message aenc(sign((n_p_16,n_i_7,pk(ssk_19)),sk_issuer[]),pk(ssk_18)) may be sent to the attacker at output {28}.
attacker(aenc(sign((n_p_16,n_i_7,pk(ssk_19)),sk_issuer[]),pk(ssk_18))).

4. The message aenc(sign((n_p_16,n_i_7,pk(ssk_19)),sk_issuer[]),pk(ssk_18)) that the attacker may have by 3 may be received at input {177}.
So the message aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_18),pk(ssk_19)) may be sent to the attacker at output {187}.
attacker(aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_18),pk(ssk_19))).

5. The message aenc(sign((n_p_16,pk(ssk_18)),ssk_18),pk(sk_issuer[])) that the attacker may have by 2 may be received at input {19}.
The message aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_18),pk(ssk_19)) that the attacker may have by 4 may be received at input {29}.
So the message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_19),pk(ssk_18)) may be sent to the attacker at output {45}.
attacker(aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_19),pk(ssk_18))).

6. The attacker initially knows sk_otherAgent[].
attacker(sk_otherAgent[]).

7. The message aenc(sign((n_p_16,n_i_7,pk(ssk_19)),sk_issuer[]),pk(ssk_18)) that the attacker may have by 3 may be received at input {177}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_19),pk(ssk_18)) that the attacker may have by 5 may be received at input {188}.
So the message aenc(sign((n_p_17,pk(ssk_20)),ssk_20),pk(sk_otherAgent[])) may be sent to the attacker at output {200}.
attacker(aenc(sign((n_p_17,pk(ssk_20)),ssk_20),pk(sk_otherAgent[]))).

8. By 7, the attacker may know aenc(sign((n_p_17,pk(ssk_20)),ssk_20),pk(sk_otherAgent[])).
By 6, the attacker may know sk_otherAgent[].
Using the function adec the attacker may obtain sign((n_p_17,pk(ssk_20)),ssk_20).
attacker(sign((n_p_17,pk(ssk_20)),ssk_20)).

9. By 8, the attacker may know sign((n_p_17,pk(ssk_20)),ssk_20).
Using the function getMsg the attacker may obtain (n_p_17,pk(ssk_20)).
attacker((n_p_17,pk(ssk_20))).

10. By 9, the attacker may know (n_p_17,pk(ssk_20)).
Using the function 2-proj-2-tuple the attacker may obtain pk(ssk_20).
attacker(pk(ssk_20)).

11. By 1, the attacker may know sk_70.
Using the function pk the attacker may obtain pk(sk_70).
attacker(pk(sk_70)).

12. The attacker has some term n_v_9.
attacker(n_v_9).

13. By 9, the attacker may know (n_p_17,pk(ssk_20)).
Using the function 1-proj-2-tuple the attacker may obtain n_p_17.
attacker(n_p_17).

14. By 13, the attacker may know n_p_17.
By 12, the attacker may know n_v_9.
By 11, the attacker may know pk(sk_70).
Using the function 3-tuple the attacker may obtain (n_p_17,n_v_9,pk(sk_70)).
attacker((n_p_17,n_v_9,pk(sk_70))).

15. By 14, the attacker may know (n_p_17,n_v_9,pk(sk_70)).
By 6, the attacker may know sk_otherAgent[].
Using the function sign the attacker may obtain sign((n_p_17,n_v_9,pk(sk_70)),sk_otherAgent[]).
attacker(sign((n_p_17,n_v_9,pk(sk_70)),sk_otherAgent[])).

16. By 15, the attacker may know sign((n_p_17,n_v_9,pk(sk_70)),sk_otherAgent[]).
By 10, the attacker may know pk(ssk_20).
Using the function aenc the attacker may obtain aenc(sign((n_p_17,n_v_9,pk(sk_70)),sk_otherAgent[]),pk(ssk_20)).
attacker(aenc(sign((n_p_17,n_v_9,pk(sk_70)),sk_otherAgent[]),pk(ssk_20))).

17. The message genDID(pk(sk_issuer[]),sk_issuer[]) may be sent to the attacker at output {9}.
attacker(genDID(pk(sk_issuer[]),sk_issuer[])).

18. Using the function attr the attacker may obtain attr.
attacker(attr).

19. The message genDID(pk(sk_prover[]),sk_prover[]) may be sent to the attacker at output {7}.
attacker(genDID(pk(sk_prover[]),sk_prover[])).

20. By 19, the attacker may know genDID(pk(sk_prover[]),sk_prover[]).
By 18, the attacker may know attr.
By 17, the attacker may know genDID(pk(sk_issuer[]),sk_issuer[]).
Using the function makeRule the attacker may obtain makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[])).
attacker(makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))).

21. The attacker has some term n_c_9.
attacker(n_c_9).

22. By 21, the attacker may know n_c_9.
By 20, the attacker may know makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[])).
Using the function 2-tuple the attacker may obtain (n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))).
attacker((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[])))).

23. By 22, the attacker may know (n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))).
By 1, the attacker may know sk_70.
Using the function sign the attacker may obtain sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_70).
attacker(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_70)).

24. By 23, the attacker may know sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_70).
By 10, the attacker may know pk(ssk_20).
Using the function aenc the attacker may obtain aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_70),pk(ssk_20)).
attacker(aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_70),pk(ssk_20))).

25. The message aenc(sign((n_p_16,n_i_7,pk(ssk_19)),sk_issuer[]),pk(ssk_18)) that the attacker may have by 3 may be received at input {177}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_19),pk(ssk_18)) that the attacker may have by 5 may be received at input {188}.
The message aenc(sign((n_p_17,n_v_9,pk(sk_70)),sk_otherAgent[]),pk(ssk_20)) that the attacker may have by 16 may be received at input {201}.
The message aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_70),pk(ssk_20)) that the attacker may have by 24 may be received at input {211}.
So the message aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_20),pk(sk_70)) may be sent to the attacker at output {222}.
attacker(aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_20),pk(sk_70))).

26. By 25, the attacker may know aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_20),pk(sk_70)).
By 1, the attacker may know sk_70.
Using the function adec the attacker may obtain sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_20).
attacker(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_20)).

27. By 26, the attacker may know sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_20).
Using the function getMsg the attacker may obtain sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]).
attacker(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[])).

28. By 27, the attacker may know sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]).
Using the function getMsg the attacker may obtain (n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])).
attacker((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]))).

29. By 28, the attacker may know (n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])).
Using the function 3-proj-3-tuple the attacker may obtain issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]).
attacker(issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])).

30. By 29, the attacker may know issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]).
Using the function chC the attacker may obtain chC(issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])).
attacker(chC(issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]))).

31. The message aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])) may be sent to the attacker at output {99}.
attacker(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[]))).

32. The message aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])) that the attacker may have by 31 may be received at input {19}.
So the message aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)) may be sent to the attacker at output {28}.
attacker(aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14))).

33. The message aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)) that the attacker may have by 32 may be received at input {100}.
So the message aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)) may be sent to the attacker at output {110}.
attacker(aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15))).

34. The message aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])) that the attacker may have by 31 may be received at input {19}.
The message aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)) that the attacker may have by 33 may be received at input {29}.
So the message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14)) may be sent to the attacker at output {45}.
attacker(aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14))).

35. The message aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)) that the attacker may have by 32 may be received at input {100}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14)) that the attacker may have by 34 may be received at input {111}.
So the message aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[])) may be sent to the attacker at output {123}.
attacker(aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[]))).

36. The message aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[])) that the attacker may have by 35 may be received at input {399}.
So the message aenc(sign((n_p_15,n_v_8,pk(ssk_17)),sk_verifier[]),pk(ssk_16)) may be sent to the attacker at output {409}.
attacker(aenc(sign((n_p_15,n_v_8,pk(ssk_17)),sk_verifier[]),pk(ssk_16))).

37. The message aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)) that the attacker may have by 32 may be received at input {100}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14)) that the attacker may have by 34 may be received at input {111}.
The message aenc(sign((n_p_15,n_v_8,pk(ssk_17)),sk_verifier[]),pk(ssk_16)) that the attacker may have by 36 may be received at input {124}.
So the message aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17)) may be sent to the attacker at output {133}.
attacker(aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17))).

38. The message aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[])) that the attacker may have by 35 may be received at input {399}.
The message aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17)) that the attacker may have by 37 may be received at input {410}.
So the message aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_17),pk(ssk_16)) may be sent to the attacker at output {421}.
attacker(aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_17),pk(ssk_16))).

39. The message aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)) that the attacker may have by 32 may be received at input {100}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14)) that the attacker may have by 34 may be received at input {111}.
The message aenc(sign((n_p_15,n_v_8,pk(ssk_17)),sk_verifier[]),pk(ssk_16)) that the attacker may have by 36 may be received at input {124}.
The message aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_17),pk(ssk_16)) that the attacker may have by 38 may be received at input {134}.
So the message aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_16),pk(ssk_17)) may be sent to the attacker at output {145}.
attacker(aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_16),pk(ssk_17))).

40. The message aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_verifier[])) that the attacker may have by 35 may be received at input {399}.
The message aenc(sign((n_v_8,uri),ssk_16),pk(ssk_17)) that the attacker may have by 37 may be received at input {410}.
The message aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_16),pk(ssk_17)) that the attacker may have by 39 may be received at input {422}.
So the message cred_fromVerifier[] may be sent on channel chC(issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])) at output {449}.
mess(chC(issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),cred_fromVerifier[]).

41. By 30, the attacker may have the channel chC(issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])).
By 40, the message cred_fromVerifier[] may be sent on this channel.
So the attacker may obtain the message cred_fromVerifier[] by listening on this channel.
attacker(cred_fromVerifier[]).

42. By 41, attacker(cred_fromVerifier[]).
The goal is reached, represented in the following fact:
attacker(cred_fromVerifier[]).


A more detailed output of the traces is available with
  set traceDisplay = long.

new sk_prover: SecretKey creating sk_prover_1 at {1}

new sk_verifier: SecretKey creating sk_verifier_1 at {2}

new sk_issuer: SecretKey creating sk_issuer_1 at {3}

out(h, ~M) with ~M = pk(sk_issuer_1) at {4}

out(h, ~M_1) with ~M_1 = pk(sk_verifier_1) at {5}

out(h, ~M_2) with ~M_2 = pk(sk_prover_1) at {6}

out(h, ~M_3) with ~M_3 = genDID(pk(sk_prover_1),sk_prover_1) at {7}

out(h, ~M_4) with ~M_4 = genDID(pk(sk_verifier_1),sk_verifier_1) at {8}

out(h, ~M_5) with ~M_5 = genDID(pk(sk_issuer_1),sk_issuer_1) at {9}

new ssk_4: SecretKey creating ssk_14 at {171} in copy a

new n_p_4: bitstring creating n_p_14 at {172} in copy a

out(h, ~M_6) with ~M_6 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer_1)) at {176} in copy a

new ssk_2: SecretKey creating ssk_15 at {94} in copy a_1

new n_p_2: bitstring creating n_p_15 at {95} in copy a_1

out(h, ~M_7) with ~M_7 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)) at {99} in copy a_1

in(h, ~M_7) with ~M_7 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)) at {19} in copy a_2

new ssk: SecretKey creating ssk_16 at {24} in copy a_2

new n_i: bitstring creating n_i_6 at {25} in copy a_2

out(h, ~M_8) with ~M_8 = aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)) at {28} in copy a_2

in(h, ~M_6) with ~M_6 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer_1)) at {19} in copy a_3

new ssk: SecretKey creating ssk_17 at {24} in copy a_3

new n_i: bitstring creating n_i_7 at {25} in copy a_3

out(h, ~M_9) with ~M_9 = aenc(sign((n_p_14,n_i_7,pk(ssk_17)),sk_issuer_1),pk(ssk_14)) at {28} in copy a_3

in(h, ~M_8) with ~M_8 = aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)) at {100} in copy a_1

event auth_HolderSendsLastMessageToIssuer(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)),aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16))) at {109} in copy a_1

out(h, ~M_10) with ~M_10 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16)) at {110} in copy a_1

in(h, ~M_10) with ~M_10 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16)) at {29} in copy a_2

new n_issuing: bitstring creating n_issuing_6 at {40} in copy a_2

event auth_IssuerSendsLastMessageToHolder(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)),aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16)),aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_16),pk(ssk_15))) at {44} in copy a_2

out(h, ~M_11) with ~M_11 = aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_16),pk(ssk_15)) at {45} in copy a_2

event auth_IssuerCompletesProtocol(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)),aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16))) at {47} in copy a_2

in(h, ~M_11) with ~M_11 = aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_16),pk(ssk_15)) at {111} in copy a_1

event auth_HolderCompletesProtocol(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)),aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16)),aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_16),pk(ssk_15))) at {160} in copy a_1

new ssk_3: SecretKey creating ssk_18 at {118} in copy a_1, a_4

new n_p_3: bitstring creating n_p_16 at {119} in copy a_1, a_4

out(h, ~M_12) with ~M_12 = aenc(sign((n_p_16,pk(ssk_18)),ssk_18),pk(sk_verifier_1)) at {123} in copy a_1, a_4

in(h, ~M_9) with ~M_9 = aenc(sign((n_p_14,n_i_7,pk(ssk_17)),sk_issuer_1),pk(ssk_14)) at {177} in copy a

event auth_HolderSendsLastMessageToIssuer(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer_1)),aenc(sign((n_p_14,n_i_7,pk(ssk_17)),sk_issuer_1),pk(ssk_14)),aenc(sign(sign((n_i_7,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_14),pk(ssk_17))) at {186} in copy a

out(h, ~M_13) with ~M_13 = aenc(sign(sign((n_i_7,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_14),pk(ssk_17)) at {187} in copy a

in(h, ~M_13) with ~M_13 = aenc(sign(sign((n_i_7,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_14),pk(ssk_17)) at {29} in copy a_3

new n_issuing: bitstring creating n_issuing_7 at {40} in copy a_3

event auth_IssuerSendsLastMessageToHolder(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer_1)),aenc(sign((n_p_14,n_i_7,pk(ssk_17)),sk_issuer_1),pk(ssk_14)),aenc(sign(sign((n_i_7,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_14),pk(ssk_17)),aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_7),ssk_17),pk(ssk_14))) at {44} in copy a_3

out(h, ~M_14) with ~M_14 = aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_7),ssk_17),pk(ssk_14)) at {45} in copy a_3

event auth_IssuerCompletesProtocol(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer_1)),aenc(sign((n_p_14,n_i_7,pk(ssk_17)),sk_issuer_1),pk(ssk_14)),aenc(sign(sign((n_i_7,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_14),pk(ssk_17))) at {47} in copy a_3

in(h, ~M_14) with ~M_14 = aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_7),ssk_17),pk(ssk_14)) at {188} in copy a

new ssk_5: SecretKey creating ssk_19 at {195} in copy a, a_5

new n_p_5: bitstring creating n_p_17 at {196} in copy a, a_5

out(h, ~M_15) with ~M_15 = aenc(sign((n_p_17,pk(ssk_19)),ssk_19),pk(sk_otherAgent)) at {200} in copy a, a_5

in(h, aenc(sign((1-proj-2-tuple(getMsg(adec(~M_15,sk_otherAgent))),a_6,pk(a_7)),sk_otherAgent),2-proj-2-tuple(getMsg(adec(~M_15,sk_otherAgent))))) with aenc(sign((1-proj-2-tuple(getMsg(adec(~M_15,sk_otherAgent))),a_6,pk(a_7)),sk_otherAgent),2-proj-2-tuple(getMsg(adec(~M_15,sk_otherAgent)))) = aenc(sign((n_p_17,a_6,pk(a_7)),sk_otherAgent),pk(ssk_19)) at {201} in copy a, a_5

out(h, ~M_16) with ~M_16 = aenc(sign((a_6,uri),ssk_19),pk(a_7)) at {210} in copy a, a_5

in(h, aenc(sign((a_8,makeRule(~M_3,attr,~M_5)),a_7),2-proj-2-tuple(getMsg(adec(~M_15,sk_otherAgent))))) with aenc(sign((a_8,makeRule(~M_3,attr,~M_5)),a_7),2-proj-2-tuple(getMsg(adec(~M_15,sk_otherAgent)))) = aenc(sign((a_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),a_7),pk(ssk_19)) at {211} in copy a, a_5

event auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_17,pk(ssk_19)),ssk_19),pk(sk_otherAgent)),aenc(sign((n_p_17,a_6,pk(a_7)),sk_otherAgent),pk(ssk_19)),aenc(sign((a_6,uri),ssk_19),pk(a_7)),aenc(sign((a_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),a_7),pk(ssk_19)),aenc(sign(sign((a_8,genDID(pk(sk_otherAgent),sk_otherAgent),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_19),pk(a_7))) at {220} in copy a, a_5

event auth_ProverSendsLastMessageToVerifierInProtocolFull(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer_1)),aenc(sign((n_p_14,n_i_7,pk(ssk_17)),sk_issuer_1),pk(ssk_14)),aenc(sign(sign((n_i_7,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_14),pk(ssk_17)),aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_7),ssk_17),pk(ssk_14)),aenc(sign((n_p_17,pk(ssk_19)),ssk_19),pk(sk_otherAgent)),aenc(sign((n_p_17,a_6,pk(a_7)),sk_otherAgent),pk(ssk_19)),aenc(sign((a_6,uri),ssk_19),pk(a_7)),aenc(sign((a_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),a_7),pk(ssk_19)),aenc(sign(sign((a_8,genDID(pk(sk_otherAgent),sk_otherAgent),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_19),pk(a_7))) at {221} in copy a, a_5

out(h, ~M_17) with ~M_17 = aenc(sign(sign((a_8,genDID(pk(sk_otherAgent),sk_otherAgent),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_19),pk(a_7)) at {222} in copy a, a_5

out(chC(issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)), ~M_18) with ~M_18 = cred_fromIssuer at {49} in copy a_2

out(chC(issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)), ~M_19) with ~M_19 = cred_fromIssuer at {49} in copy a_3

out(chC(issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)), ~M_20) with ~M_20 = cred_fromHolder at {164} in copy a_1

in(h, ~M_12) with ~M_12 = aenc(sign((n_p_16,pk(ssk_18)),ssk_18),pk(sk_verifier_1)) at {399} in copy a_9

new ssk_10: SecretKey creating ssk_20 at {405} in copy a_9

new n_v_4: bitstring creating n_v_8 at {406} in copy a_9

out(h, ~M_21) with ~M_21 = aenc(sign((n_p_16,n_v_8,pk(ssk_20)),sk_verifier_1),pk(ssk_18)) at {409} in copy a_9

in(h, ~M_21) with ~M_21 = aenc(sign((n_p_16,n_v_8,pk(ssk_20)),sk_verifier_1),pk(ssk_18)) at {124} in copy a_1, a_4

out(h, ~M_22) with ~M_22 = aenc(sign((n_v_8,uri),ssk_18),pk(ssk_20)) at {133} in copy a_1, a_4

in(h, ~M_22) with ~M_22 = aenc(sign((n_v_8,uri),ssk_18),pk(ssk_20)) at {410} in copy a_9

new n_c_4: bitstring creating n_c_8 at {417} in copy a_9

out(h, ~M_23) with ~M_23 = aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_20),pk(ssk_18)) at {421} in copy a_9

in(h, ~M_23) with ~M_23 = aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_20),pk(ssk_18)) at {134} in copy a_1, a_4

event auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_16,pk(ssk_18)),ssk_18),pk(sk_verifier_1)),aenc(sign((n_p_16,n_v_8,pk(ssk_20)),sk_verifier_1),pk(ssk_18)),aenc(sign((n_v_8,uri),ssk_18),pk(ssk_20)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_20),pk(ssk_18)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_20))) at {143} in copy a_1, a_4

event auth_ProverSendsLastMessageToVerifierInProtocolFull(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)),aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16)),aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_16),pk(ssk_15)),aenc(sign((n_p_16,pk(ssk_18)),ssk_18),pk(sk_verifier_1)),aenc(sign((n_p_16,n_v_8,pk(ssk_20)),sk_verifier_1),pk(ssk_18)),aenc(sign((n_v_8,uri),ssk_18),pk(ssk_20)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_20),pk(ssk_18)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_20))) at {144} in copy a_1, a_4

out(h, ~M_24) with ~M_24 = aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_20)) at {145} in copy a_1, a_4

in(h, ~M_24) with ~M_24 = aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_20)) at {422} in copy a_9

new access_token_4: bitstring creating access_token_8 at {436} in copy a_9

event auth_VerifierSendsLastMessageToProver(aenc(sign((n_p_16,pk(ssk_18)),ssk_18),pk(sk_verifier_1)),aenc(sign((n_p_16,n_v_8,pk(ssk_20)),sk_verifier_1),pk(ssk_18)),aenc(sign((n_v_8,uri),ssk_18),pk(ssk_20)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_20),pk(ssk_18)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_20)),aenc(sign((genDID(pk(sk_prover_1),sk_prover_1),access_token_8),ssk_20),pk(ssk_18))) at {440} in copy a_9

out(h, ~M_25) with ~M_25 = aenc(sign((genDID(pk(sk_prover_1),sk_prover_1),access_token_8),ssk_20),pk(ssk_18)) at {441} in copy a_9

out(chC(issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)), ~M_26) with ~M_26 = cred_fromVerifier at {449} in copy a_9

event auth_VerifierCompletesProtocol(aenc(sign((n_p_16,pk(ssk_18)),ssk_18),pk(sk_verifier_1)),aenc(sign((n_p_16,n_v_8,pk(ssk_20)),sk_verifier_1),pk(ssk_18)),aenc(sign((n_v_8,uri),ssk_18),pk(ssk_20)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_20),pk(ssk_18)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_20))) at {443} in copy a_9

The attacker has the message ~M_26 = cred_fromVerifier.
A trace has been found.
RESULT not attacker(cred_fromVerifier[]) is false.
-- Query not attacker(access_token_fromVerifier[]) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (43 with conclusion selected). Queue: 89 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 91 rules.
600 rules inserted. Base: 523 rules (105 with conclusion selected). Queue: 104 rules.
800 rules inserted. Base: 684 rules (115 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 803 rules (134 with conclusion selected). Queue: 85 rules.
1200 rules inserted. Base: 946 rules (153 with conclusion selected). Queue: 124 rules.
1400 rules inserted. Base: 1075 rules (172 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 1148 rules (174 with conclusion selected). Queue: 58 rules.
1800 rules inserted. Base: 1197 rules (194 with conclusion selected). Queue: 115 rules.
2000 rules inserted. Base: 1239 rules (204 with conclusion selected). Queue: 83 rules.
2200 rules inserted. Base: 1292 rules (214 with conclusion selected). Queue: 71 rules.
2400 rules inserted. Base: 1361 rules (245 with conclusion selected). Queue: 34 rules.
Starting query not attacker(access_token_fromVerifier[])
RESULT not attacker(access_token_fromVerifier[]) is true.
-- Query inj-event(auth_ProverCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp,m_accessToken)) ==> inj-event(auth_VerifierSendsLastMessageToProver(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp,m_accessToken)) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (42 with conclusion selected). Queue: 91 rules.
400 rules inserted. Base: 347 rules (77 with conclusion selected). Queue: 100 rules.
600 rules inserted. Base: 528 rules (101 with conclusion selected). Queue: 77 rules.
800 rules inserted. Base: 688 rules (111 with conclusion selected). Queue: 81 rules.
1000 rules inserted. Base: 820 rules (128 with conclusion selected). Queue: 99 rules.
1200 rules inserted. Base: 946 rules (151 with conclusion selected). Queue: 132 rules.
1400 rules inserted. Base: 1104 rules (162 with conclusion selected). Queue: 118 rules.
1600 rules inserted. Base: 1207 rules (173 with conclusion selected). Queue: 88 rules.
1800 rules inserted. Base: 1290 rules (188 with conclusion selected). Queue: 70 rules.
2000 rules inserted. Base: 1306 rules (201 with conclusion selected). Queue: 102 rules.
2200 rules inserted. Base: 1369 rules (211 with conclusion selected). Queue: 61 rules.
2400 rules inserted. Base: 1441 rules (217 with conclusion selected). Queue: 28 rules.
2600 rules inserted. Base: 1470 rules (249 with conclusion selected). Queue: 32 rules.
Starting query inj-event(auth_ProverCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp,m_accessToken)) ==> inj-event(auth_VerifierSendsLastMessageToProver(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp,m_accessToken))
RESULT inj-event(auth_ProverCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp,m_accessToken)) ==> inj-event(auth_VerifierSendsLastMessageToProver(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp,m_accessToken)) is true.
-- Query inj-event(auth_VerifierCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) ==> inj-event(auth_ProverSendsLastMessageToVerifier(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (42 with conclusion selected). Queue: 91 rules.
400 rules inserted. Base: 338 rules (77 with conclusion selected). Queue: 92 rules.
600 rules inserted. Base: 523 rules (103 with conclusion selected). Queue: 88 rules.
800 rules inserted. Base: 684 rules (111 with conclusion selected). Queue: 76 rules.
1000 rules inserted. Base: 808 rules (134 with conclusion selected). Queue: 87 rules.
1200 rules inserted. Base: 962 rules (153 with conclusion selected). Queue: 132 rules.
1400 rules inserted. Base: 1107 rules (172 with conclusion selected). Queue: 107 rules.
1600 rules inserted. Base: 1210 rules (173 with conclusion selected). Queue: 79 rules.
1800 rules inserted. Base: 1276 rules (189 with conclusion selected). Queue: 77 rules.
2000 rules inserted. Base: 1345 rules (202 with conclusion selected). Queue: 127 rules.
2200 rules inserted. Base: 1451 rules (210 with conclusion selected). Queue: 100 rules.
2400 rules inserted. Base: 1517 rules (213 with conclusion selected). Queue: 157 rules.
2600 rules inserted. Base: 1651 rules (221 with conclusion selected). Queue: 38 rules.
2800 rules inserted. Base: 1693 rules (250 with conclusion selected). Queue: 46 rules.
Starting query inj-event(auth_VerifierCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) ==> inj-event(auth_ProverSendsLastMessageToVerifier(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp))
goal reachable: begin(auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),aenc(sign((n_p_14,n_v_8,pk(ssk_15)),sk_verifier[]),pk(ssk_14)),aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_15),pk(ssk_14)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15))),@occ297_1) && begin(auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_otherAgent[])),aenc(sign((n_p_15,n_v_9,pk(sk_70)),sk_otherAgent[]),pk(ssk_16)),aenc(sign((n_v_9,uri),ssk_16),pk(sk_70)),aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_70),pk(ssk_16)),aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_16),pk(sk_70))),@occ220_1) && attacker(n_c_9) && attacker(n_v_9) && attacker(sk_70) && attacker(n_issuing_6) && attacker(n_i_6) && attacker(sk_71) -> end(@occ443_1,auth_VerifierCompletesProtocol(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),aenc(sign((n_p_14,n_v_8,pk(ssk_15)),sk_verifier[]),pk(ssk_14)),aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_15),pk(ssk_14)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15))))
The 1st, 2nd hypotheses occur strictly before the conclusion.
The 3rd, 4th, 5th, 6th, 7th, 8th hypotheses occur before the conclusion.
Abbreviations:
ssk_17 = ssk_6[!1 = @sid]
n_p_16 = n_p_6[!1 = @sid]
n_p_14 = n_p_7[!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_71),pk(ssk_17)),x_14 = aenc(sign((n_p_16,n_i_6,pk(sk_71)),sk_otherAgent[]),pk(ssk_17)),!1 = @sid]
ssk_14 = ssk_7[!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_71),pk(ssk_17)),x_14 = aenc(sign((n_p_16,n_i_6,pk(sk_71)),sk_otherAgent[]),pk(ssk_17)),!1 = @sid]
n_v_8 = n_v_4[x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_2]
ssk_15 = ssk_10[x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_2]
n_c_8 = n_c_4[x_25 = aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_2]
@occ443_1 = @occ443[x_26 = aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)),x_25 = aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_2]
@occ297_1 = @occ297[x_17 = aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_15),pk(ssk_14)),x_16 = aenc(sign((n_p_14,n_v_8,pk(ssk_15)),sk_verifier[]),pk(ssk_14)),!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_71),pk(ssk_17)),x_14 = aenc(sign((n_p_16,n_i_6,pk(sk_71)),sk_otherAgent[]),pk(ssk_17)),!1 = @sid]
n_p_17 = n_p_4[!1 = @sid_3]
ssk_18 = ssk_4[!1 = @sid_3]
n_i_7 = n_i[x = aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_issuer[])),!1 = @sid_4]
ssk_19 = ssk[x = aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_issuer[])),!1 = @sid_4]
n_issuing_7 = n_issuing[x_1 = aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_18),pk(ssk_19)),x = aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_issuer[])),!1 = @sid_4]
n_p_15 = n_p_5[!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_19),pk(ssk_18)),x_9 = aenc(sign((n_p_17,n_i_7,pk(ssk_19)),sk_issuer[]),pk(ssk_18)),!1 = @sid_3]
ssk_16 = ssk_5[!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_19),pk(ssk_18)),x_9 = aenc(sign((n_p_17,n_i_7,pk(ssk_19)),sk_issuer[]),pk(ssk_18)),!1 = @sid_3]
@occ220_1 = @occ220[x_12 = aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_70),pk(ssk_16)),x_11 = aenc(sign((n_p_15,n_v_9,pk(sk_70)),sk_otherAgent[]),pk(ssk_16)),!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_19),pk(ssk_18)),x_9 = aenc(sign((n_p_17,n_i_7,pk(ssk_19)),sk_issuer[]),pk(ssk_18)),!1 = @sid_3]
goal reachable: begin(auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),aenc(sign((n_p_14,n_v_8,pk(ssk_15)),sk_verifier[]),pk(ssk_14)),aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_15),pk(ssk_14)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15))),@occ297_1) && begin(auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_otherAgent[])),aenc(sign((n_p_15,n_v_9,pk(sk_70)),sk_otherAgent[]),pk(ssk_16)),aenc(sign((n_v_9,uri),ssk_16),pk(sk_70)),aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_70),pk(ssk_16)),aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_16),pk(sk_70))),@occ220_1) && attacker(n_c_9) && attacker(n_v_9) && attacker(sk_70) && attacker(n_i_6) -> end(@occ443_1,auth_VerifierCompletesProtocol(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),aenc(sign((n_p_14,n_v_8,pk(ssk_15)),sk_verifier[]),pk(ssk_14)),aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_15),pk(ssk_14)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15))))
The 1st, 2nd hypotheses occur strictly before the conclusion.
The 3rd, 4th, 5th, 6th hypotheses occur before the conclusion.
Abbreviations:
ssk_17 = ssk_6[!1 = @sid]
n_p_16 = n_p_6[!1 = @sid]
n_p_14 = n_p_7[!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_otherAgent[]),sk_otherAgent[])),sk_prover[]),pk(ssk_17)),x_14 = aenc(sign((n_p_16,n_i_6,pk(sk_prover[])),sk_otherAgent[]),pk(ssk_17)),!1 = @sid]
ssk_14 = ssk_7[!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_otherAgent[]),sk_otherAgent[])),sk_prover[]),pk(ssk_17)),x_14 = aenc(sign((n_p_16,n_i_6,pk(sk_prover[])),sk_otherAgent[]),pk(ssk_17)),!1 = @sid]
n_v_8 = n_v_4[x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_2]
ssk_15 = ssk_10[x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_2]
n_c_8 = n_c_4[x_25 = aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_2]
@occ443_1 = @occ443[x_26 = aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)),x_25 = aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_2]
@occ297_1 = @occ297[x_17 = aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_15),pk(ssk_14)),x_16 = aenc(sign((n_p_14,n_v_8,pk(ssk_15)),sk_verifier[]),pk(ssk_14)),!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_otherAgent[]),sk_otherAgent[])),sk_prover[]),pk(ssk_17)),x_14 = aenc(sign((n_p_16,n_i_6,pk(sk_prover[])),sk_otherAgent[]),pk(ssk_17)),!1 = @sid]
n_p_17 = n_p_4[!1 = @sid_3]
ssk_18 = ssk_4[!1 = @sid_3]
n_i_7 = n_i[x = aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_issuer[])),!1 = @sid_4]
ssk_19 = ssk[x = aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_issuer[])),!1 = @sid_4]
n_issuing_6 = n_issuing[x_1 = aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_18),pk(ssk_19)),x = aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_issuer[])),!1 = @sid_4]
n_p_15 = n_p_5[!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_19),pk(ssk_18)),x_9 = aenc(sign((n_p_17,n_i_7,pk(ssk_19)),sk_issuer[]),pk(ssk_18)),!1 = @sid_3]
ssk_16 = ssk_5[!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_19),pk(ssk_18)),x_9 = aenc(sign((n_p_17,n_i_7,pk(ssk_19)),sk_issuer[]),pk(ssk_18)),!1 = @sid_3]
@occ220_1 = @occ220[x_12 = aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_70),pk(ssk_16)),x_11 = aenc(sign((n_p_15,n_v_9,pk(sk_70)),sk_otherAgent[]),pk(ssk_16)),!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_19),pk(ssk_18)),x_9 = aenc(sign((n_p_17,n_i_7,pk(ssk_19)),sk_issuer[]),pk(ssk_18)),!1 = @sid_3]
goal reachable: begin(auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),aenc(sign((n_p_14,n_v_8,pk(ssk_15)),sk_verifier[]),pk(ssk_14)),aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_15),pk(ssk_14)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15))),@occ143_1) -> end(@occ443_1,auth_VerifierCompletesProtocol(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),aenc(sign((n_p_14,n_v_8,pk(ssk_15)),sk_verifier[]),pk(ssk_14)),aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_15),pk(ssk_14)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15))))
The hypothesis occurs strictly before the conclusion.
Abbreviations:
n_p_15 = n_p_2[!1 = @sid]
ssk_16 = ssk_2[!1 = @sid]
n_i_6 = n_i[x = aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_issuer[])),!1 = @sid_1]
ssk_17 = ssk[x = aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_issuer[])),!1 = @sid_1]
n_issuing_6 = n_issuing[x_1 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_16),pk(ssk_17)),x = aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_issuer[])),!1 = @sid_1]
n_p_14 = n_p_3[!2 = @sid_2,x_5 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_17),pk(ssk_16)),x_4 = aenc(sign((n_p_15,n_i_6,pk(ssk_17)),sk_issuer[]),pk(ssk_16)),!1 = @sid]
ssk_14 = ssk_3[!2 = @sid_2,x_5 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_17),pk(ssk_16)),x_4 = aenc(sign((n_p_15,n_i_6,pk(ssk_17)),sk_issuer[]),pk(ssk_16)),!1 = @sid]
n_v_8 = n_v_4[x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_3]
ssk_15 = ssk_10[x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_3]
n_c_8 = n_c_4[x_25 = aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_3]
@occ443_1 = @occ443[x_26 = aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)),x_25 = aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_3]
@occ143_1 = @occ143[x_7 = aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_15),pk(ssk_14)),x_6 = aenc(sign((n_p_14,n_v_8,pk(ssk_15)),sk_verifier[]),pk(ssk_14)),!2 = @sid_2,x_5 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_17),pk(ssk_16)),x_4 = aenc(sign((n_p_15,n_i_6,pk(ssk_17)),sk_issuer[]),pk(ssk_16)),!1 = @sid]
RESULT inj-event(auth_VerifierCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) ==> inj-event(auth_ProverSendsLastMessageToVerifier(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) is true.
-- Query inj-event(auth_HolderCompletesProtocol(m_handshakeReq,m_handshakeResp,m_did,m_cred)) ==> inj-event(auth_IssuerSendsLastMessageToHolder(m_handshakeReq,m_handshakeResp,m_did,m_cred)) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (42 with conclusion selected). Queue: 93 rules.
400 rules inserted. Base: 354 rules (77 with conclusion selected). Queue: 88 rules.
600 rules inserted. Base: 546 rules (103 with conclusion selected). Queue: 82 rules.
800 rules inserted. Base: 699 rules (113 with conclusion selected). Queue: 80 rules.
1000 rules inserted. Base: 824 rules (130 with conclusion selected). Queue: 103 rules.
1200 rules inserted. Base: 944 rules (153 with conclusion selected). Queue: 123 rules.
1400 rules inserted. Base: 1100 rules (164 with conclusion selected). Queue: 106 rules.
1600 rules inserted. Base: 1207 rules (175 with conclusion selected). Queue: 73 rules.
1800 rules inserted. Base: 1280 rules (190 with conclusion selected). Queue: 83 rules.
2000 rules inserted. Base: 1345 rules (203 with conclusion selected). Queue: 101 rules.
2200 rules inserted. Base: 1447 rules (213 with conclusion selected). Queue: 115 rules.
2400 rules inserted. Base: 1471 rules (216 with conclusion selected). Queue: 128 rules.
2600 rules inserted. Base: 1597 rules (236 with conclusion selected). Queue: 15 rules.
Starting query inj-event(auth_HolderCompletesProtocol(m_handshakeReq,m_handshakeResp,m_did,m_cred)) ==> inj-event(auth_IssuerSendsLastMessageToHolder(m_handshakeReq,m_handshakeResp,m_did,m_cred))
goal reachable: begin(auth_IssuerSendsLastMessageToHolder(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)),aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14))),@occ44_1) -> end(@occ160_1,auth_HolderCompletesProtocol(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)),aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14))))
The hypothesis occurs strictly before the conclusion.
Abbreviations:
n_p_14 = n_p_2[!1 = @sid]
ssk_14 = ssk_2[!1 = @sid]
n_i_6 = n_i[x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
ssk_15 = ssk[x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
n_issuing_6 = n_issuing[x_1 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)),x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
@occ160_1 = @occ160[x_5 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_15),pk(ssk_14)),x_4 = aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)),!1 = @sid]
@occ44_1 = @occ44[x_1 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)),x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
RESULT inj-event(auth_HolderCompletesProtocol(m_handshakeReq,m_handshakeResp,m_did,m_cred)) ==> inj-event(auth_IssuerSendsLastMessageToHolder(m_handshakeReq,m_handshakeResp,m_did,m_cred)) is true.
-- Query inj-event(auth_IssuerCompletesProtocol(m_handshakeReq,m_handshakeResp,m_did)) ==> inj-event(auth_HolderSendsLastMessageToIssuer(m_handshakeReq,m_handshakeResp,m_did)) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (42 with conclusion selected). Queue: 92 rules.
400 rules inserted. Base: 353 rules (79 with conclusion selected). Queue: 85 rules.
600 rules inserted. Base: 545 rules (104 with conclusion selected). Queue: 77 rules.
800 rules inserted. Base: 694 rules (115 with conclusion selected). Queue: 101 rules.
1000 rules inserted. Base: 819 rules (132 with conclusion selected). Queue: 109 rules.
1200 rules inserted. Base: 927 rules (149 with conclusion selected). Queue: 120 rules.
1400 rules inserted. Base: 1091 rules (170 with conclusion selected). Queue: 154 rules.
1600 rules inserted. Base: 1215 rules (192 with conclusion selected). Queue: 124 rules.
1800 rules inserted. Base: 1311 rules (193 with conclusion selected). Queue: 80 rules.
2000 rules inserted. Base: 1387 rules (207 with conclusion selected). Queue: 100 rules.
2200 rules inserted. Base: 1438 rules (224 with conclusion selected). Queue: 149 rules.
2400 rules inserted. Base: 1518 rules (227 with conclusion selected). Queue: 128 rules.
2600 rules inserted. Base: 1623 rules (239 with conclusion selected). Queue: 182 rules.
2800 rules inserted. Base: 1646 rules (245 with conclusion selected). Queue: 144 rules.
3000 rules inserted. Base: 1748 rules (264 with conclusion selected). Queue: 32 rules.
3200 rules inserted. Base: 1785 rules (292 with conclusion selected). Queue: 65 rules.
Starting query inj-event(auth_IssuerCompletesProtocol(m_handshakeReq,m_handshakeResp,m_did)) ==> inj-event(auth_HolderSendsLastMessageToIssuer(m_handshakeReq,m_handshakeResp,m_did))
goal reachable: begin(auth_HolderSendsLastMessageToIssuer(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15))),@occ186_1) -> end(@occ47_1,auth_IssuerCompletesProtocol(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15))))
The hypothesis occurs strictly before the conclusion.
Abbreviations:
n_p_14 = n_p_4[!1 = @sid]
ssk_14 = ssk_4[!1 = @sid]
n_i_6 = n_i[x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
ssk_15 = ssk[x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
@occ47_1 = @occ47[x_1 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)),x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
@occ186_1 = @occ186[x_9 = aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)),!1 = @sid]
goal reachable: begin(auth_HolderSendsLastMessageToIssuer(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15))),@occ109_1) -> end(@occ47_1,auth_IssuerCompletesProtocol(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15))))
The hypothesis occurs strictly before the conclusion.
Abbreviations:
n_p_14 = n_p_2[!1 = @sid]
ssk_14 = ssk_2[!1 = @sid]
n_i_6 = n_i[x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
ssk_15 = ssk[x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
@occ47_1 = @occ47[x_1 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)),x = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_issuer[])),!1 = @sid_1]
@occ109_1 = @occ109[x_4 = aenc(sign((n_p_14,n_i_6,pk(ssk_15)),sk_issuer[]),pk(ssk_14)),!1 = @sid]
RESULT inj-event(auth_IssuerCompletesProtocol(m_handshakeReq,m_handshakeResp,m_did)) ==> inj-event(auth_HolderSendsLastMessageToIssuer(m_handshakeReq,m_handshakeResp,m_did)) is true.
-- Query inj-event(auth_VerifierCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) ==> inj-event(auth_ProverSendsLastMessageToVerifier(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) && inj-event(auth_IssuerSendsLastMessageToHolder(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred)) && inj-event(auth_HolderCompletesProtocol(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred)) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (42 with conclusion selected). Queue: 91 rules.
400 rules inserted. Base: 354 rules (78 with conclusion selected). Queue: 94 rules.
600 rules inserted. Base: 539 rules (102 with conclusion selected). Queue: 73 rules.
800 rules inserted. Base: 699 rules (112 with conclusion selected). Queue: 79 rules.
1000 rules inserted. Base: 819 rules (129 with conclusion selected). Queue: 96 rules.
1200 rules inserted. Base: 963 rules (152 with conclusion selected). Queue: 129 rules.
1400 rules inserted. Base: 1121 rules (165 with conclusion selected). Queue: 112 rules.
1600 rules inserted. Base: 1214 rules (174 with conclusion selected). Queue: 100 rules.
1800 rules inserted. Base: 1310 rules (190 with conclusion selected). Queue: 76 rules.
2000 rules inserted. Base: 1364 rules (203 with conclusion selected). Queue: 153 rules.
2200 rules inserted. Base: 1473 rules (206 with conclusion selected). Queue: 120 rules.
2400 rules inserted. Base: 1571 rules (213 with conclusion selected). Queue: 171 rules.
2600 rules inserted. Base: 1647 rules (217 with conclusion selected). Queue: 103 rules.
2800 rules inserted. Base: 1738 rules (248 with conclusion selected). Queue: 21 rules.
3000 rules inserted. Base: 1798 rules (274 with conclusion selected). Queue: 1 rules.
Starting query inj-event(auth_VerifierCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) ==> inj-event(auth_ProverSendsLastMessageToVerifier(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) && inj-event(auth_IssuerSendsLastMessageToHolder(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred)) && inj-event(auth_HolderCompletesProtocol(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred))
goal reachable: begin(auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),aenc(sign((n_p_14,n_v_8,pk(ssk_15)),sk_verifier[]),pk(ssk_14)),aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_15),pk(ssk_14)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15))),@occ297_2) && begin(auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_15,pk(ssk_16)),ssk_16),pk(sk_otherAgent[])),aenc(sign((n_p_15,n_v_9,pk(sk_70)),sk_otherAgent[]),pk(ssk_16)),aenc(sign((n_v_9,uri),ssk_16),pk(sk_70)),aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_70),pk(ssk_16)),aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_16),pk(sk_70))),@occ220_2) && attacker(n_c_9) && attacker(n_v_9) && begin(auth_IssuerSendsLastMessageToHolder(aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),aenc(sign((n_p_16,n_i_6,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)),aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_18),pk(ssk_17))),@occ44_2) && attacker(sk_70) && attacker(n_issuing_7) && attacker(n_i_7) && attacker(sk_71) -> end(@occ443_2,auth_VerifierCompletesProtocol(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),aenc(sign((n_p_14,n_v_8,pk(ssk_15)),sk_verifier[]),pk(ssk_14)),aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_15),pk(ssk_14)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15))))
Abbreviations:
ssk_19 = ssk_6[!1 = @sid]
n_p_17 = n_p_6[!1 = @sid]
n_p_14 = n_p_7[!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),sk_71),pk(ssk_19)),x_14 = aenc(sign((n_p_17,n_i_7,pk(sk_71)),sk_otherAgent[]),pk(ssk_19)),!1 = @sid]
ssk_14 = ssk_7[!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),sk_71),pk(ssk_19)),x_14 = aenc(sign((n_p_17,n_i_7,pk(sk_71)),sk_otherAgent[]),pk(ssk_19)),!1 = @sid]
n_v_8 = n_v_4[x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_2]
ssk_15 = ssk_10[x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_2]
n_c_8 = n_c_4[x_25 = aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_2]
@occ443_2 = @occ443_1[x_26 = aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_14),pk(ssk_15)),x_25 = aenc(sign((n_v_8,uri),ssk_14),pk(ssk_15)),x_24 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_verifier[])),!1 = @sid_2]
@occ297_2 = @occ297_1[x_17 = aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_15),pk(ssk_14)),x_16 = aenc(sign((n_p_14,n_v_8,pk(ssk_15)),sk_verifier[]),pk(ssk_14)),!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),sk_71),pk(ssk_19)),x_14 = aenc(sign((n_p_17,n_i_7,pk(sk_71)),sk_otherAgent[]),pk(ssk_19)),!1 = @sid]
n_p_16 = n_p_4[!1 = @sid_3]
ssk_17 = ssk_4[!1 = @sid_3]
n_i_6 = n_i[x = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),!1 = @sid_4]
ssk_18 = ssk[x = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),!1 = @sid_4]
n_issuing_6 = n_issuing[x_1 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)),x = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),!1 = @sid_4]
n_p_15 = n_p_5[!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_18),pk(ssk_17)),x_9 = aenc(sign((n_p_16,n_i_6,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),!1 = @sid_3]
ssk_16 = ssk_5[!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_18),pk(ssk_17)),x_9 = aenc(sign((n_p_16,n_i_6,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),!1 = @sid_3]
@occ220_2 = @occ220_1[x_12 = aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_70),pk(ssk_16)),x_11 = aenc(sign((n_p_15,n_v_9,pk(sk_70)),sk_otherAgent[]),pk(ssk_16)),!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),ssk_18),pk(ssk_17)),x_9 = aenc(sign((n_p_16,n_i_6,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),!1 = @sid_3]
@occ44_2 = @occ44_1[x_1 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)),x = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),!1 = @sid_4]

Derivation:
Abbreviations:
ssk_14 = ssk_6[!1 = @sid]
n_p_14 = n_p_6[!1 = @sid]
n_p_15 = n_p_7[!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)),x_14 = aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)),!1 = @sid]
ssk_15 = ssk_7[!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)),x_14 = aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)),!1 = @sid]
n_v_8 = n_v_4[x_24 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),!1 = @sid_2]
ssk_16 = ssk_10[x_24 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),!1 = @sid_2]
n_c_8 = n_c_4[x_25 = aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),x_24 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),!1 = @sid_2]
@occ443_2 = @occ443_1[x_26 = aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16)),x_25 = aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),x_24 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),!1 = @sid_2]
@occ297_2 = @occ297_1[x_17 = aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)),x_16 = aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)),!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)),x_14 = aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)),!1 = @sid]
n_p_16 = n_p_4[!1 = @sid_3]
ssk_17 = ssk_4[!1 = @sid_3]
n_i_7 = n_i[x = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),!1 = @sid_4]
ssk_18 = ssk[x = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),!1 = @sid_4]
n_issuing_7 = n_issuing[x_1 = aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)),x = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),!1 = @sid_4]
ssk_19 = ssk_5[!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)),x_9 = aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),!1 = @sid_3]
n_p_17 = n_p_5[!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)),x_9 = aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),!1 = @sid_3]
@occ220_2 = @occ220_1[x_12 = aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71),pk(ssk_19)),x_11 = aenc(sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[]),pk(ssk_19)),!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)),x_9 = aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),!1 = @sid_3]
@occ44_2 = @occ44_1[x_1 = aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)),x = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),!1 = @sid_4]

1. The attacker initially knows sk_otherAgent[].
attacker(sk_otherAgent[]).

2. The message aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_otherAgent[])) may be sent to the attacker at output {253}.
attacker(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_otherAgent[]))).

3. By 2, the attacker may know aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_otherAgent[])).
By 1, the attacker may know sk_otherAgent[].
Using the function adec the attacker may obtain sign((n_p_14,pk(ssk_14)),ssk_14).
attacker(sign((n_p_14,pk(ssk_14)),ssk_14)).

4. By 3, the attacker may know sign((n_p_14,pk(ssk_14)),ssk_14).
Using the function getMsg the attacker may obtain (n_p_14,pk(ssk_14)).
attacker((n_p_14,pk(ssk_14))).

5. By 4, the attacker may know (n_p_14,pk(ssk_14)).
Using the function 2-proj-2-tuple the attacker may obtain pk(ssk_14).
attacker(pk(ssk_14)).

6. We assume as hypothesis that
attacker(sk_70).

7. By 6, the attacker may know sk_70.
Using the function pk the attacker may obtain pk(sk_70).
attacker(pk(sk_70)).

8. We assume as hypothesis that
attacker(n_i_6).

9. By 4, the attacker may know (n_p_14,pk(ssk_14)).
Using the function 1-proj-2-tuple the attacker may obtain n_p_14.
attacker(n_p_14).

10. By 9, the attacker may know n_p_14.
By 8, the attacker may know n_i_6.
By 7, the attacker may know pk(sk_70).
Using the function 3-tuple the attacker may obtain (n_p_14,n_i_6,pk(sk_70)).
attacker((n_p_14,n_i_6,pk(sk_70))).

11. By 10, the attacker may know (n_p_14,n_i_6,pk(sk_70)).
By 1, the attacker may know sk_otherAgent[].
Using the function sign the attacker may obtain sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]).
attacker(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[])).

12. By 11, the attacker may know sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]).
By 5, the attacker may know pk(ssk_14).
Using the function aenc the attacker may obtain aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)).
attacker(aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14))).

13. We assume as hypothesis that
attacker(n_issuing_6).

14. The message genDID(pk(sk_prover[]),sk_prover[]) may be sent to the attacker at output {7}.
attacker(genDID(pk(sk_prover[]),sk_prover[])).

15. We assume as hypothesis that
attacker(sk_71).

16. The message aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])) may be sent to the attacker at output {176}.
attacker(aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[]))).

17. The message aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])) that the attacker may have by 16 may be received at input {19}.
So the message aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)) may be sent to the attacker at output {28}.
attacker(aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17))).

18. The message aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)) that the attacker may have by 17 may be received at input {177}.
So the message aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)) may be sent to the attacker at output {187}.
attacker(aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18))).

19. The message aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])) that the attacker may have by 16 may be received at input {19}.
The message aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)) that the attacker may have by 18 may be received at input {29}.
The event auth_IssuerSendsLastMessageToHolder(aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)),aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17))) (with occurrence name @occ44_2) may be executed at {44}.
So the message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)) may be sent to the attacker at output {45}.
attacker(aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17))).

20. The message aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)) that the attacker may have by 17 may be received at input {177}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)) that the attacker may have by 19 may be received at input {188}.
So the message aenc(sign((n_p_17,pk(ssk_19)),ssk_19),pk(sk_otherAgent[])) may be sent to the attacker at output {200}.
attacker(aenc(sign((n_p_17,pk(ssk_19)),ssk_19),pk(sk_otherAgent[]))).

21. By 20, the attacker may know aenc(sign((n_p_17,pk(ssk_19)),ssk_19),pk(sk_otherAgent[])).
By 1, the attacker may know sk_otherAgent[].
Using the function adec the attacker may obtain sign((n_p_17,pk(ssk_19)),ssk_19).
attacker(sign((n_p_17,pk(ssk_19)),ssk_19)).

22. By 21, the attacker may know sign((n_p_17,pk(ssk_19)),ssk_19).
Using the function getMsg the attacker may obtain (n_p_17,pk(ssk_19)).
attacker((n_p_17,pk(ssk_19))).

23. By 22, the attacker may know (n_p_17,pk(ssk_19)).
Using the function 2-proj-2-tuple the attacker may obtain pk(ssk_19).
attacker(pk(ssk_19)).

24. By 15, the attacker may know sk_71.
Using the function pk the attacker may obtain pk(sk_71).
attacker(pk(sk_71)).

25. We assume as hypothesis that
attacker(n_v_9).

26. By 22, the attacker may know (n_p_17,pk(ssk_19)).
Using the function 1-proj-2-tuple the attacker may obtain n_p_17.
attacker(n_p_17).

27. By 26, the attacker may know n_p_17.
By 25, the attacker may know n_v_9.
By 24, the attacker may know pk(sk_71).
Using the function 3-tuple the attacker may obtain (n_p_17,n_v_9,pk(sk_71)).
attacker((n_p_17,n_v_9,pk(sk_71))).

28. By 27, the attacker may know (n_p_17,n_v_9,pk(sk_71)).
By 1, the attacker may know sk_otherAgent[].
Using the function sign the attacker may obtain sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[]).
attacker(sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[])).

29. By 28, the attacker may know sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[]).
By 23, the attacker may know pk(ssk_19).
Using the function aenc the attacker may obtain aenc(sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[]),pk(ssk_19)).
attacker(aenc(sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[]),pk(ssk_19))).

30. The message genDID(pk(sk_issuer[]),sk_issuer[]) may be sent to the attacker at output {9}.
attacker(genDID(pk(sk_issuer[]),sk_issuer[])).

31. Using the function attr the attacker may obtain attr.
attacker(attr).

32. By 14, the attacker may know genDID(pk(sk_prover[]),sk_prover[]).
By 31, the attacker may know attr.
By 30, the attacker may know genDID(pk(sk_issuer[]),sk_issuer[]).
Using the function makeRule the attacker may obtain makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[])).
attacker(makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))).

33. We assume as hypothesis that
attacker(n_c_9).

34. By 33, the attacker may know n_c_9.
By 32, the attacker may know makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[])).
Using the function 2-tuple the attacker may obtain (n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))).
attacker((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[])))).

35. By 34, the attacker may know (n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))).
By 15, the attacker may know sk_71.
Using the function sign the attacker may obtain sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71).
attacker(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71)).

36. By 35, the attacker may know sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71).
By 23, the attacker may know pk(ssk_19).
Using the function aenc the attacker may obtain aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71),pk(ssk_19)).
attacker(aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71),pk(ssk_19))).

37. The message aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)) that the attacker may have by 17 may be received at input {177}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)) that the attacker may have by 19 may be received at input {188}.
The message aenc(sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[]),pk(ssk_19)) that the attacker may have by 29 may be received at input {201}.
The message aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71),pk(ssk_19)) that the attacker may have by 36 may be received at input {211}.
The event auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_17,pk(ssk_19)),ssk_19),pk(sk_otherAgent[])),aenc(sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[]),pk(ssk_19)),aenc(sign((n_v_9,uri),ssk_19),pk(sk_71)),aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71),pk(ssk_19)),aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19),pk(sk_71))) (with occurrence name @occ220_2) may be executed at {220}.
So the message aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19),pk(sk_71)) may be sent to the attacker at output {222}.
attacker(aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19),pk(sk_71))).

38. By 37, the attacker may know aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19),pk(sk_71)).
By 15, the attacker may know sk_71.
Using the function adec the attacker may obtain sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19).
attacker(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19)).

39. By 38, the attacker may know sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19).
Using the function getMsg the attacker may obtain sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]).
attacker(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[])).

40. By 39, the attacker may know sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]).
Using the function getMsg the attacker may obtain (n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])).
attacker((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]))).

41. By 40, the attacker may know (n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])).
Using the function 3-proj-3-tuple the attacker may obtain issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]).
attacker(issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])).

42. By 41, the attacker may know issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]).
By 14, the attacker may know genDID(pk(sk_prover[]),sk_prover[]).
By 13, the attacker may know n_issuing_6.
Using the function 3-tuple the attacker may obtain (issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6).
attacker((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6)).

43. By 42, the attacker may know (issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6).
By 6, the attacker may know sk_70.
Using the function sign the attacker may obtain sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70).
attacker(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70)).

44. By 43, the attacker may know sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70).
By 5, the attacker may know pk(ssk_14).
Using the function aenc the attacker may obtain aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)).
attacker(aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14))).

45. The message aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)) that the attacker may have by 12 may be received at input {254}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)) that the attacker may have by 44 may be received at input {265}.
So the message aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])) may be sent to the attacker at output {277}.
attacker(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[]))).

46. The message aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])) that the attacker may have by 45 may be received at input {399}.
So the message aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)) may be sent to the attacker at output {409}.
attacker(aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15))).

47. The message aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)) that the attacker may have by 12 may be received at input {254}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)) that the attacker may have by 44 may be received at input {265}.
The message aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)) that the attacker may have by 46 may be received at input {278}.
So the message aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)) may be sent to the attacker at output {287}.
attacker(aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16))).

48. The message aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])) that the attacker may have by 45 may be received at input {399}.
The message aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)) that the attacker may have by 47 may be received at input {410}.
So the message aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)) may be sent to the attacker at output {421}.
attacker(aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15))).

49. The message aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)) that the attacker may have by 12 may be received at input {254}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)) that the attacker may have by 44 may be received at input {265}.
The message aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)) that the attacker may have by 46 may be received at input {278}.
The message aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)) that the attacker may have by 48 may be received at input {288}.
The event auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)),aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16))) (with occurrence name @occ297_2) may be executed at {297}.
So the message aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16)) may be sent to the attacker at output {299}.
attacker(aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16))).

50. The message aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])) that the attacker may have by 45 may be received at input {399}.
The message aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)) that the attacker may have by 47 may be received at input {410}.
The message aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16)) that the attacker may have by 49 may be received at input {422}.
So event auth_VerifierCompletesProtocol(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)),aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16))) may be executed at {443} in session @sid_2.
end(@occ443_2,auth_VerifierCompletesProtocol(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)),aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16)))).

51. By 50, end(@occ443_2,auth_VerifierCompletesProtocol(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)),aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16)))).
The goal is reached, represented in the following fact:
end(@occ443_2,auth_VerifierCompletesProtocol(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)),aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16)))).


A more detailed output of the traces is available with
  set traceDisplay = long.

new sk_prover: SecretKey creating sk_prover_1 at {1}

new sk_verifier: SecretKey creating sk_verifier_1 at {2}

new sk_issuer: SecretKey creating sk_issuer_1 at {3}

out(h, ~M) with ~M = pk(sk_issuer_1) at {4}

out(h, ~M_1) with ~M_1 = pk(sk_verifier_1) at {5}

out(h, ~M_2) with ~M_2 = pk(sk_prover_1) at {6}

out(h, ~M_3) with ~M_3 = genDID(pk(sk_prover_1),sk_prover_1) at {7}

out(h, ~M_4) with ~M_4 = genDID(pk(sk_verifier_1),sk_verifier_1) at {8}

out(h, ~M_5) with ~M_5 = genDID(pk(sk_issuer_1),sk_issuer_1) at {9}

new ssk_6: SecretKey creating ssk_14 at {248} in copy a

new n_p_6: bitstring creating n_p_14 at {249} in copy a

out(h, ~M_6) with ~M_6 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_otherAgent)) at {253} in copy a

new ssk_4: SecretKey creating ssk_15 at {171} in copy a_1

new n_p_4: bitstring creating n_p_15 at {172} in copy a_1

out(h, ~M_7) with ~M_7 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)) at {176} in copy a_1

in(h, ~M_7) with ~M_7 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)) at {19} in copy a_2

new ssk: SecretKey creating ssk_16 at {24} in copy a_2

new n_i: bitstring creating n_i_6 at {25} in copy a_2

out(h, ~M_8) with ~M_8 = aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)) at {28} in copy a_2

in(h, ~M_8) with ~M_8 = aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)) at {177} in copy a_1

event auth_HolderSendsLastMessageToIssuer(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)),aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16))) at {186} in copy a_1

out(h, ~M_9) with ~M_9 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16)) at {187} in copy a_1

in(h, ~M_9) with ~M_9 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16)) at {29} in copy a_2

new n_issuing: bitstring creating n_issuing_6 at {40} in copy a_2

event auth_IssuerSendsLastMessageToHolder(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)),aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16)),aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_16),pk(ssk_15))) at {44} in copy a_2

out(h, ~M_10) with ~M_10 = aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_16),pk(ssk_15)) at {45} in copy a_2

event auth_IssuerCompletesProtocol(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)),aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16))) at {47} in copy a_2

in(h, ~M_10) with ~M_10 = aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_16),pk(ssk_15)) at {188} in copy a_1

new ssk_5: SecretKey creating ssk_17 at {195} in copy a_1, a_3

new n_p_5: bitstring creating n_p_16 at {196} in copy a_1, a_3

out(h, ~M_11) with ~M_11 = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_otherAgent)) at {200} in copy a_1, a_3

in(h, aenc(sign((1-proj-2-tuple(getMsg(adec(~M_11,sk_otherAgent))),a_4,pk(a_5)),sk_otherAgent),2-proj-2-tuple(getMsg(adec(~M_11,sk_otherAgent))))) with aenc(sign((1-proj-2-tuple(getMsg(adec(~M_11,sk_otherAgent))),a_4,pk(a_5)),sk_otherAgent),2-proj-2-tuple(getMsg(adec(~M_11,sk_otherAgent)))) = aenc(sign((n_p_16,a_4,pk(a_5)),sk_otherAgent),pk(ssk_17)) at {201} in copy a_1, a_3

out(h, ~M_12) with ~M_12 = aenc(sign((a_4,uri),ssk_17),pk(a_5)) at {210} in copy a_1, a_3

in(h, aenc(sign((a_6,makeRule(~M_3,attr,~M_5)),a_5),2-proj-2-tuple(getMsg(adec(~M_11,sk_otherAgent))))) with aenc(sign((a_6,makeRule(~M_3,attr,~M_5)),a_5),2-proj-2-tuple(getMsg(adec(~M_11,sk_otherAgent)))) = aenc(sign((a_6,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),a_5),pk(ssk_17)) at {211} in copy a_1, a_3

event auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_otherAgent)),aenc(sign((n_p_16,a_4,pk(a_5)),sk_otherAgent),pk(ssk_17)),aenc(sign((a_4,uri),ssk_17),pk(a_5)),aenc(sign((a_6,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),a_5),pk(ssk_17)),aenc(sign(sign((a_6,genDID(pk(sk_otherAgent),sk_otherAgent),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_17),pk(a_5))) at {220} in copy a_1, a_3

event auth_ProverSendsLastMessageToVerifierInProtocolFull(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)),aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16)),aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_16),pk(ssk_15)),aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_otherAgent)),aenc(sign((n_p_16,a_4,pk(a_5)),sk_otherAgent),pk(ssk_17)),aenc(sign((a_4,uri),ssk_17),pk(a_5)),aenc(sign((a_6,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),a_5),pk(ssk_17)),aenc(sign(sign((a_6,genDID(pk(sk_otherAgent),sk_otherAgent),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_17),pk(a_5))) at {221} in copy a_1, a_3

out(h, ~M_13) with ~M_13 = aenc(sign(sign((a_6,genDID(pk(sk_otherAgent),sk_otherAgent),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_17),pk(a_5)) at {222} in copy a_1, a_3

in(h, aenc(sign((1-proj-2-tuple(getMsg(adec(~M_6,sk_otherAgent))),a_7,pk(a_8)),sk_otherAgent),2-proj-2-tuple(getMsg(adec(~M_6,sk_otherAgent))))) with aenc(sign((1-proj-2-tuple(getMsg(adec(~M_6,sk_otherAgent))),a_7,pk(a_8)),sk_otherAgent),2-proj-2-tuple(getMsg(adec(~M_6,sk_otherAgent)))) = aenc(sign((n_p_14,a_7,pk(a_8)),sk_otherAgent),pk(ssk_14)) at {254} in copy a

event auth_HolderSendsLastMessageToIssuer(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_otherAgent)),aenc(sign((n_p_14,a_7,pk(a_8)),sk_otherAgent),pk(ssk_14)),aenc(sign(sign((a_7,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_otherAgent),sk_otherAgent)),sk_prover_1),ssk_14),pk(a_8))) at {263} in copy a

out(h, ~M_14) with ~M_14 = aenc(sign(sign((a_7,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_otherAgent),sk_otherAgent)),sk_prover_1),ssk_14),pk(a_8)) at {264} in copy a

in(h, aenc(sign((3-proj-3-tuple(getMsg(getMsg(adec(~M_13,a_5)))),~M_3,a_9),a_8),2-proj-2-tuple(getMsg(adec(~M_6,sk_otherAgent))))) with aenc(sign((3-proj-3-tuple(getMsg(getMsg(adec(~M_13,a_5)))),~M_3,a_9),a_8),2-proj-2-tuple(getMsg(adec(~M_6,sk_otherAgent)))) = aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),a_9),a_8),pk(ssk_14)) at {265} in copy a

new ssk_7: SecretKey creating ssk_18 at {272} in copy a, a_10

new n_p_7: bitstring creating n_p_17 at {273} in copy a, a_10

out(h, ~M_15) with ~M_15 = aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_verifier_1)) at {277} in copy a, a_10

in(h, ~M_15) with ~M_15 = aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_verifier_1)) at {399} in copy a_11

new ssk_10: SecretKey creating ssk_19 at {405} in copy a_11

new n_v_4: bitstring creating n_v_8 at {406} in copy a_11

out(h, ~M_16) with ~M_16 = aenc(sign((n_p_17,n_v_8,pk(ssk_19)),sk_verifier_1),pk(ssk_18)) at {409} in copy a_11

in(h, ~M_16) with ~M_16 = aenc(sign((n_p_17,n_v_8,pk(ssk_19)),sk_verifier_1),pk(ssk_18)) at {278} in copy a, a_10

out(h, ~M_17) with ~M_17 = aenc(sign((n_v_8,uri),ssk_18),pk(ssk_19)) at {287} in copy a, a_10

in(h, ~M_17) with ~M_17 = aenc(sign((n_v_8,uri),ssk_18),pk(ssk_19)) at {410} in copy a_11

new n_c_4: bitstring creating n_c_8 at {417} in copy a_11

out(h, ~M_18) with ~M_18 = aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_19),pk(ssk_18)) at {421} in copy a_11

in(h, ~M_18) with ~M_18 = aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_19),pk(ssk_18)) at {288} in copy a, a_10

event auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_verifier_1)),aenc(sign((n_p_17,n_v_8,pk(ssk_19)),sk_verifier_1),pk(ssk_18)),aenc(sign((n_v_8,uri),ssk_18),pk(ssk_19)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_19),pk(ssk_18)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_19))) at {297} in copy a, a_10

event auth_ProverSendsLastMessageToVerifierInProtocolFull(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_otherAgent)),aenc(sign((n_p_14,a_7,pk(a_8)),sk_otherAgent),pk(ssk_14)),aenc(sign(sign((a_7,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_otherAgent),sk_otherAgent)),sk_prover_1),ssk_14),pk(a_8)),aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),a_9),a_8),pk(ssk_14)),aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_verifier_1)),aenc(sign((n_p_17,n_v_8,pk(ssk_19)),sk_verifier_1),pk(ssk_18)),aenc(sign((n_v_8,uri),ssk_18),pk(ssk_19)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_19),pk(ssk_18)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_19))) at {298} in copy a, a_10

out(h, ~M_19) with ~M_19 = aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_19)) at {299} in copy a, a_10

in(h, ~M_19) with ~M_19 = aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_19)) at {422} in copy a_11

new access_token_4: bitstring creating access_token_8 at {436} in copy a_11

event auth_VerifierSendsLastMessageToProver(aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_verifier_1)),aenc(sign((n_p_17,n_v_8,pk(ssk_19)),sk_verifier_1),pk(ssk_18)),aenc(sign((n_v_8,uri),ssk_18),pk(ssk_19)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_19),pk(ssk_18)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_19)),aenc(sign((genDID(pk(sk_prover_1),sk_prover_1),access_token_8),ssk_19),pk(ssk_18))) at {440} in copy a_11

out(h, ~M_20) with ~M_20 = aenc(sign((genDID(pk(sk_prover_1),sk_prover_1),access_token_8),ssk_19),pk(ssk_18)) at {441} in copy a_11

event auth_VerifierCompletesProtocol(aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_verifier_1)),aenc(sign((n_p_17,n_v_8,pk(ssk_19)),sk_verifier_1),pk(ssk_18)),aenc(sign((n_v_8,uri),ssk_18),pk(ssk_19)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_19),pk(ssk_18)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_19))) at {443} in copy a_11 (goal)

The event auth_VerifierCompletesProtocol(aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_verifier_1)),aenc(sign((n_p_17,n_v_8,pk(ssk_19)),sk_verifier_1),pk(ssk_18)),aenc(sign((n_v_8,uri),ssk_18),pk(ssk_19)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_19),pk(ssk_18)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_19))) is executed at {443} in copy a_11.
A trace has been found.
RESULT inj-event(auth_VerifierCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) ==> inj-event(auth_ProverSendsLastMessageToVerifier(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) && inj-event(auth_IssuerSendsLastMessageToHolder(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred)) && inj-event(auth_HolderCompletesProtocol(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred)) is false.
RESULT (even event(auth_VerifierCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) ==> event(auth_ProverSendsLastMessageToVerifier(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) && event(auth_IssuerSendsLastMessageToHolder(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred)) && event(auth_HolderCompletesProtocol(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred)) is false.)
-- Query event(auth_VerifierCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) ==> event(auth_IssuerSendsLastMessageToHolder(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred)) && event(auth_ProverSendsLastMessageToVerifierInProtocolFull(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred,m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) in process 1.
Translating the process into Horn clauses...
Completing...
200 rules inserted. Base: 197 rules (42 with conclusion selected). Queue: 91 rules.
400 rules inserted. Base: 354 rules (78 with conclusion selected). Queue: 94 rules.
600 rules inserted. Base: 539 rules (102 with conclusion selected). Queue: 73 rules.
800 rules inserted. Base: 699 rules (112 with conclusion selected). Queue: 79 rules.
1000 rules inserted. Base: 819 rules (129 with conclusion selected). Queue: 96 rules.
1200 rules inserted. Base: 963 rules (152 with conclusion selected). Queue: 129 rules.
1400 rules inserted. Base: 1121 rules (165 with conclusion selected). Queue: 112 rules.
1600 rules inserted. Base: 1214 rules (174 with conclusion selected). Queue: 100 rules.
1800 rules inserted. Base: 1310 rules (190 with conclusion selected). Queue: 76 rules.
2000 rules inserted. Base: 1364 rules (203 with conclusion selected). Queue: 153 rules.
2200 rules inserted. Base: 1473 rules (206 with conclusion selected). Queue: 120 rules.
2400 rules inserted. Base: 1571 rules (213 with conclusion selected). Queue: 171 rules.
2600 rules inserted. Base: 1647 rules (217 with conclusion selected). Queue: 103 rules.
2800 rules inserted. Base: 1738 rules (248 with conclusion selected). Queue: 21 rules.
3000 rules inserted. Base: 1798 rules (274 with conclusion selected). Queue: 1 rules.
Starting query event(auth_VerifierCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) ==> event(auth_IssuerSendsLastMessageToHolder(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred)) && event(auth_ProverSendsLastMessageToVerifierInProtocolFull(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred,m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp))
goal reachable: begin(auth_ProverSendsLastMessageToVerifierInProtocolFull(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_otherAgent[])),aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_otherAgent[]),sk_otherAgent[])),sk_prover[]),ssk_14),pk(sk_70)),aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)),aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)),aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16)))) && begin(auth_ProverSendsLastMessageToVerifierInProtocolFull(aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)),aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)),aenc(sign((n_p_17,pk(ssk_19)),ssk_19),pk(sk_otherAgent[])),aenc(sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[]),pk(ssk_19)),aenc(sign((n_v_9,uri),ssk_19),pk(sk_71)),aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71),pk(ssk_19)),aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19),pk(sk_71)))) && attacker(n_c_9) && attacker(n_v_9) && begin(auth_IssuerSendsLastMessageToHolder(aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)),aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)))) && attacker(sk_71) && attacker(n_issuing_6) && attacker(n_i_6) && attacker(sk_70) -> end(auth_VerifierCompletesProtocol(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)),aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16))))
Abbreviations:
ssk_14 = ssk_6[!1 = @sid]
n_p_14 = n_p_6[!1 = @sid]
n_p_15 = n_p_7[!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)),x_14 = aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)),!1 = @sid]
ssk_15 = ssk_7[!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)),x_14 = aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)),!1 = @sid]
n_v_8 = n_v_4[x_24 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),!1 = @sid_2]
ssk_16 = ssk_10[x_24 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),!1 = @sid_2]
n_c_8 = n_c_4[x_25 = aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),x_24 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),!1 = @sid_2]
n_p_16 = n_p_4[!1 = @sid_3]
ssk_17 = ssk_4[!1 = @sid_3]
n_i_7 = n_i[x = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),!1 = @sid_4]
ssk_18 = ssk[x = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),!1 = @sid_4]
n_issuing_7 = n_issuing[x_1 = aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)),x = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),!1 = @sid_4]
n_p_17 = n_p_5[!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)),x_9 = aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),!1 = @sid_3]
ssk_19 = ssk_5[!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)),x_9 = aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),!1 = @sid_3]

Derivation:
Abbreviations:
ssk_14 = ssk_6[!1 = @sid]
n_p_14 = n_p_6[!1 = @sid]
n_p_15 = n_p_7[!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)),x_14 = aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)),!1 = @sid]
ssk_15 = ssk_7[!2 = @sid_1,x_15 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)),x_14 = aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)),!1 = @sid]
n_v_8 = n_v_4[x_24 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),!1 = @sid_2]
ssk_16 = ssk_10[x_24 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),!1 = @sid_2]
n_c_8 = n_c_4[x_25 = aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),x_24 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),!1 = @sid_2]
n_p_16 = n_p_4[!1 = @sid_3]
ssk_17 = ssk_4[!1 = @sid_3]
n_i_7 = n_i[x = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),!1 = @sid_4]
ssk_18 = ssk[x = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),!1 = @sid_4]
n_issuing_7 = n_issuing[x_1 = aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)),x = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),!1 = @sid_4]
ssk_19 = ssk_5[!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)),x_9 = aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),!1 = @sid_3]
n_p_17 = n_p_5[!2 = @sid_5,x_10 = aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)),x_9 = aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),!1 = @sid_3]

1. The attacker initially knows sk_otherAgent[].
attacker(sk_otherAgent[]).

2. The message aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_otherAgent[])) may be sent to the attacker at output {253}.
attacker(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_otherAgent[]))).

3. By 2, the attacker may know aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_otherAgent[])).
By 1, the attacker may know sk_otherAgent[].
Using the function adec the attacker may obtain sign((n_p_14,pk(ssk_14)),ssk_14).
attacker(sign((n_p_14,pk(ssk_14)),ssk_14)).

4. By 3, the attacker may know sign((n_p_14,pk(ssk_14)),ssk_14).
Using the function getMsg the attacker may obtain (n_p_14,pk(ssk_14)).
attacker((n_p_14,pk(ssk_14))).

5. By 4, the attacker may know (n_p_14,pk(ssk_14)).
Using the function 2-proj-2-tuple the attacker may obtain pk(ssk_14).
attacker(pk(ssk_14)).

6. We assume as hypothesis that
attacker(sk_70).

7. By 6, the attacker may know sk_70.
Using the function pk the attacker may obtain pk(sk_70).
attacker(pk(sk_70)).

8. We assume as hypothesis that
attacker(n_i_6).

9. By 4, the attacker may know (n_p_14,pk(ssk_14)).
Using the function 1-proj-2-tuple the attacker may obtain n_p_14.
attacker(n_p_14).

10. By 9, the attacker may know n_p_14.
By 8, the attacker may know n_i_6.
By 7, the attacker may know pk(sk_70).
Using the function 3-tuple the attacker may obtain (n_p_14,n_i_6,pk(sk_70)).
attacker((n_p_14,n_i_6,pk(sk_70))).

11. By 10, the attacker may know (n_p_14,n_i_6,pk(sk_70)).
By 1, the attacker may know sk_otherAgent[].
Using the function sign the attacker may obtain sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]).
attacker(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[])).

12. By 11, the attacker may know sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]).
By 5, the attacker may know pk(ssk_14).
Using the function aenc the attacker may obtain aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)).
attacker(aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14))).

13. We assume as hypothesis that
attacker(n_issuing_6).

14. The message genDID(pk(sk_prover[]),sk_prover[]) may be sent to the attacker at output {7}.
attacker(genDID(pk(sk_prover[]),sk_prover[])).

15. We assume as hypothesis that
attacker(sk_71).

16. The message aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])) may be sent to the attacker at output {176}.
attacker(aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[]))).

17. The message aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])) that the attacker may have by 16 may be received at input {19}.
So the message aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)) may be sent to the attacker at output {28}.
attacker(aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17))).

18. The message aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)) that the attacker may have by 17 may be received at input {177}.
So the message aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)) may be sent to the attacker at output {187}.
attacker(aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18))).

19. The message aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])) that the attacker may have by 16 may be received at input {19}.
The message aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)) that the attacker may have by 18 may be received at input {29}.
The event auth_IssuerSendsLastMessageToHolder(aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)),aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17))) may be executed at {44}.
So the message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)) may be sent to the attacker at output {45}.
attacker(aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17))).

20. The message aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)) that the attacker may have by 17 may be received at input {177}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)) that the attacker may have by 19 may be received at input {188}.
So the message aenc(sign((n_p_17,pk(ssk_19)),ssk_19),pk(sk_otherAgent[])) may be sent to the attacker at output {200}.
attacker(aenc(sign((n_p_17,pk(ssk_19)),ssk_19),pk(sk_otherAgent[]))).

21. By 20, the attacker may know aenc(sign((n_p_17,pk(ssk_19)),ssk_19),pk(sk_otherAgent[])).
By 1, the attacker may know sk_otherAgent[].
Using the function adec the attacker may obtain sign((n_p_17,pk(ssk_19)),ssk_19).
attacker(sign((n_p_17,pk(ssk_19)),ssk_19)).

22. By 21, the attacker may know sign((n_p_17,pk(ssk_19)),ssk_19).
Using the function getMsg the attacker may obtain (n_p_17,pk(ssk_19)).
attacker((n_p_17,pk(ssk_19))).

23. By 22, the attacker may know (n_p_17,pk(ssk_19)).
Using the function 2-proj-2-tuple the attacker may obtain pk(ssk_19).
attacker(pk(ssk_19)).

24. By 15, the attacker may know sk_71.
Using the function pk the attacker may obtain pk(sk_71).
attacker(pk(sk_71)).

25. We assume as hypothesis that
attacker(n_v_9).

26. By 22, the attacker may know (n_p_17,pk(ssk_19)).
Using the function 1-proj-2-tuple the attacker may obtain n_p_17.
attacker(n_p_17).

27. By 26, the attacker may know n_p_17.
By 25, the attacker may know n_v_9.
By 24, the attacker may know pk(sk_71).
Using the function 3-tuple the attacker may obtain (n_p_17,n_v_9,pk(sk_71)).
attacker((n_p_17,n_v_9,pk(sk_71))).

28. By 27, the attacker may know (n_p_17,n_v_9,pk(sk_71)).
By 1, the attacker may know sk_otherAgent[].
Using the function sign the attacker may obtain sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[]).
attacker(sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[])).

29. By 28, the attacker may know sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[]).
By 23, the attacker may know pk(ssk_19).
Using the function aenc the attacker may obtain aenc(sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[]),pk(ssk_19)).
attacker(aenc(sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[]),pk(ssk_19))).

30. The message genDID(pk(sk_issuer[]),sk_issuer[]) may be sent to the attacker at output {9}.
attacker(genDID(pk(sk_issuer[]),sk_issuer[])).

31. Using the function attr the attacker may obtain attr.
attacker(attr).

32. By 14, the attacker may know genDID(pk(sk_prover[]),sk_prover[]).
By 31, the attacker may know attr.
By 30, the attacker may know genDID(pk(sk_issuer[]),sk_issuer[]).
Using the function makeRule the attacker may obtain makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[])).
attacker(makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))).

33. We assume as hypothesis that
attacker(n_c_9).

34. By 33, the attacker may know n_c_9.
By 32, the attacker may know makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[])).
Using the function 2-tuple the attacker may obtain (n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))).
attacker((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[])))).

35. By 34, the attacker may know (n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))).
By 15, the attacker may know sk_71.
Using the function sign the attacker may obtain sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71).
attacker(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71)).

36. By 35, the attacker may know sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71).
By 23, the attacker may know pk(ssk_19).
Using the function aenc the attacker may obtain aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71),pk(ssk_19)).
attacker(aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71),pk(ssk_19))).

37. The message aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)) that the attacker may have by 17 may be received at input {177}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)) that the attacker may have by 19 may be received at input {188}.
The message aenc(sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[]),pk(ssk_19)) that the attacker may have by 29 may be received at input {201}.
The message aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71),pk(ssk_19)) that the attacker may have by 36 may be received at input {211}.
The event auth_ProverSendsLastMessageToVerifierInProtocolFull(aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_issuer[])),aenc(sign((n_p_16,n_i_7,pk(ssk_18)),sk_issuer[]),pk(ssk_17)),aenc(sign(sign((n_i_7,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_issuer[]),sk_issuer[])),sk_prover[]),ssk_17),pk(ssk_18)),aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_7),ssk_18),pk(ssk_17)),aenc(sign((n_p_17,pk(ssk_19)),ssk_19),pk(sk_otherAgent[])),aenc(sign((n_p_17,n_v_9,pk(sk_71)),sk_otherAgent[]),pk(ssk_19)),aenc(sign((n_v_9,uri),ssk_19),pk(sk_71)),aenc(sign((n_c_9,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),sk_71),pk(ssk_19)),aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19),pk(sk_71))) may be executed at {221}.
So the message aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19),pk(sk_71)) may be sent to the attacker at output {222}.
attacker(aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19),pk(sk_71))).

38. By 37, the attacker may know aenc(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19),pk(sk_71)).
By 15, the attacker may know sk_71.
Using the function adec the attacker may obtain sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19).
attacker(sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19)).

39. By 38, the attacker may know sign(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_19).
Using the function getMsg the attacker may obtain sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]).
attacker(sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[])).

40. By 39, the attacker may know sign((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]).
Using the function getMsg the attacker may obtain (n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])).
attacker((n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]))).

41. By 40, the attacker may know (n_c_9,genDID(pk(sk_otherAgent[]),sk_otherAgent[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])).
Using the function 3-proj-3-tuple the attacker may obtain issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]).
attacker(issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])).

42. By 41, the attacker may know issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]).
By 14, the attacker may know genDID(pk(sk_prover[]),sk_prover[]).
By 13, the attacker may know n_issuing_6.
Using the function 3-tuple the attacker may obtain (issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6).
attacker((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6)).

43. By 42, the attacker may know (issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6).
By 6, the attacker may know sk_70.
Using the function sign the attacker may obtain sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70).
attacker(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70)).

44. By 43, the attacker may know sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70).
By 5, the attacker may know pk(ssk_14).
Using the function aenc the attacker may obtain aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)).
attacker(aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14))).

45. The message aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)) that the attacker may have by 12 may be received at input {254}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)) that the attacker may have by 44 may be received at input {265}.
So the message aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])) may be sent to the attacker at output {277}.
attacker(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[]))).

46. The message aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])) that the attacker may have by 45 may be received at input {399}.
So the message aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)) may be sent to the attacker at output {409}.
attacker(aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15))).

47. The message aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)) that the attacker may have by 12 may be received at input {254}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)) that the attacker may have by 44 may be received at input {265}.
The message aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)) that the attacker may have by 46 may be received at input {278}.
So the message aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)) may be sent to the attacker at output {287}.
attacker(aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16))).

48. The message aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])) that the attacker may have by 45 may be received at input {399}.
The message aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)) that the attacker may have by 47 may be received at input {410}.
So the message aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)) may be sent to the attacker at output {421}.
attacker(aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15))).

49. The message aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)) that the attacker may have by 12 may be received at input {254}.
The message aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)) that the attacker may have by 44 may be received at input {265}.
The message aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)) that the attacker may have by 46 may be received at input {278}.
The message aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)) that the attacker may have by 48 may be received at input {288}.
The event auth_ProverSendsLastMessageToVerifierInProtocolFull(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_otherAgent[])),aenc(sign((n_p_14,n_i_6,pk(sk_70)),sk_otherAgent[]),pk(ssk_14)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover[]),sk_prover[]),genDID(pk(sk_otherAgent[]),sk_otherAgent[])),sk_prover[]),ssk_14),pk(sk_70)),aenc(sign((issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[]),genDID(pk(sk_prover[]),sk_prover[]),n_issuing_6),sk_70),pk(ssk_14)),aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)),aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16))) may be executed at {298}.
So the message aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16)) may be sent to the attacker at output {299}.
attacker(aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16))).

50. The message aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])) that the attacker may have by 45 may be received at input {399}.
The message aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)) that the attacker may have by 47 may be received at input {410}.
The message aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16)) that the attacker may have by 49 may be received at input {422}.
So event auth_VerifierCompletesProtocol(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)),aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16))) may be executed at {443}.
end(auth_VerifierCompletesProtocol(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)),aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16)))).

51. By 50, end(auth_VerifierCompletesProtocol(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)),aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16)))).
The goal is reached, represented in the following fact:
end(
    auth_VerifierCompletesProtocol(
        aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_verifier[])),
        aenc(sign((n_p_15,n_v_8,pk(ssk_16)),sk_verifier[]),pk(ssk_15)),
        aenc(sign((n_v_8,uri),ssk_15),pk(ssk_16)),
        aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover[]),sk_prover[]),attr,genDID(pk(sk_issuer[]),sk_issuer[]))),ssk_16),pk(ssk_15)),
        aenc(sign(sign((n_c_8,genDID(pk(sk_verifier[]),sk_verifier[]),issueVC(genDID(pk(sk_prover[]),sk_prover[]),attr,sk_issuer[])),sk_prover[]),ssk_15),pk(ssk_16))
    )
).


A more detailed output of the traces is available with
  set traceDisplay = long.

new sk_prover: SecretKey creating sk_prover_1 at {1}

new sk_verifier: SecretKey creating sk_verifier_1 at {2}

new sk_issuer: SecretKey creating sk_issuer_1 at {3}

out(h, ~M) with ~M = pk(sk_issuer_1) at {4}

out(h, ~M_1) with ~M_1 = pk(sk_verifier_1) at {5}

out(h, ~M_2) with ~M_2 = pk(sk_prover_1) at {6}

out(h, ~M_3) with ~M_3 = genDID(pk(sk_prover_1),sk_prover_1) at {7}

out(h, ~M_4) with ~M_4 = genDID(pk(sk_verifier_1),sk_verifier_1) at {8}

out(h, ~M_5) with ~M_5 = genDID(pk(sk_issuer_1),sk_issuer_1) at {9}

new ssk_6: SecretKey creating ssk_14 at {248} in copy a

new n_p_6: bitstring creating n_p_14 at {249} in copy a

out(h, ~M_6) with ~M_6 = aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_otherAgent)) at {253} in copy a

new ssk_4: SecretKey creating ssk_15 at {171} in copy a_1

new n_p_4: bitstring creating n_p_15 at {172} in copy a_1

out(h, ~M_7) with ~M_7 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)) at {176} in copy a_1

in(h, ~M_7) with ~M_7 = aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)) at {19} in copy a_2

new ssk: SecretKey creating ssk_16 at {24} in copy a_2

new n_i: bitstring creating n_i_6 at {25} in copy a_2

out(h, ~M_8) with ~M_8 = aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)) at {28} in copy a_2

in(h, ~M_8) with ~M_8 = aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)) at {177} in copy a_1

event auth_HolderSendsLastMessageToIssuer(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)),aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16))) at {186} in copy a_1

out(h, ~M_9) with ~M_9 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16)) at {187} in copy a_1

in(h, ~M_9) with ~M_9 = aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16)) at {29} in copy a_2

new n_issuing: bitstring creating n_issuing_6 at {40} in copy a_2

event auth_IssuerSendsLastMessageToHolder(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)),aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16)),aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_16),pk(ssk_15))) at {44} in copy a_2

out(h, ~M_10) with ~M_10 = aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_16),pk(ssk_15)) at {45} in copy a_2

event auth_IssuerCompletesProtocol(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)),aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16))) at {47} in copy a_2

in(h, ~M_10) with ~M_10 = aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_16),pk(ssk_15)) at {188} in copy a_1

new ssk_5: SecretKey creating ssk_17 at {195} in copy a_1, a_3

new n_p_5: bitstring creating n_p_16 at {196} in copy a_1, a_3

out(h, ~M_11) with ~M_11 = aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_otherAgent)) at {200} in copy a_1, a_3

in(h, aenc(sign((1-proj-2-tuple(getMsg(adec(~M_11,sk_otherAgent))),a_4,pk(a_5)),sk_otherAgent),2-proj-2-tuple(getMsg(adec(~M_11,sk_otherAgent))))) with aenc(sign((1-proj-2-tuple(getMsg(adec(~M_11,sk_otherAgent))),a_4,pk(a_5)),sk_otherAgent),2-proj-2-tuple(getMsg(adec(~M_11,sk_otherAgent)))) = aenc(sign((n_p_16,a_4,pk(a_5)),sk_otherAgent),pk(ssk_17)) at {201} in copy a_1, a_3

out(h, ~M_12) with ~M_12 = aenc(sign((a_4,uri),ssk_17),pk(a_5)) at {210} in copy a_1, a_3

in(h, aenc(sign((a_6,makeRule(~M_3,attr,~M_5)),a_5),2-proj-2-tuple(getMsg(adec(~M_11,sk_otherAgent))))) with aenc(sign((a_6,makeRule(~M_3,attr,~M_5)),a_5),2-proj-2-tuple(getMsg(adec(~M_11,sk_otherAgent)))) = aenc(sign((a_6,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),a_5),pk(ssk_17)) at {211} in copy a_1, a_3

event auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_otherAgent)),aenc(sign((n_p_16,a_4,pk(a_5)),sk_otherAgent),pk(ssk_17)),aenc(sign((a_4,uri),ssk_17),pk(a_5)),aenc(sign((a_6,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),a_5),pk(ssk_17)),aenc(sign(sign((a_6,genDID(pk(sk_otherAgent),sk_otherAgent),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_17),pk(a_5))) at {220} in copy a_1, a_3

event auth_ProverSendsLastMessageToVerifierInProtocolFull(aenc(sign((n_p_15,pk(ssk_15)),ssk_15),pk(sk_issuer_1)),aenc(sign((n_p_15,n_i_6,pk(ssk_16)),sk_issuer_1),pk(ssk_15)),aenc(sign(sign((n_i_6,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_issuer_1),sk_issuer_1)),sk_prover_1),ssk_15),pk(ssk_16)),aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),n_issuing_6),ssk_16),pk(ssk_15)),aenc(sign((n_p_16,pk(ssk_17)),ssk_17),pk(sk_otherAgent)),aenc(sign((n_p_16,a_4,pk(a_5)),sk_otherAgent),pk(ssk_17)),aenc(sign((a_4,uri),ssk_17),pk(a_5)),aenc(sign((a_6,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),a_5),pk(ssk_17)),aenc(sign(sign((a_6,genDID(pk(sk_otherAgent),sk_otherAgent),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_17),pk(a_5))) at {221} in copy a_1, a_3

out(h, ~M_13) with ~M_13 = aenc(sign(sign((a_6,genDID(pk(sk_otherAgent),sk_otherAgent),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_17),pk(a_5)) at {222} in copy a_1, a_3

in(h, aenc(sign((1-proj-2-tuple(getMsg(adec(~M_6,sk_otherAgent))),a_7,pk(a_8)),sk_otherAgent),2-proj-2-tuple(getMsg(adec(~M_6,sk_otherAgent))))) with aenc(sign((1-proj-2-tuple(getMsg(adec(~M_6,sk_otherAgent))),a_7,pk(a_8)),sk_otherAgent),2-proj-2-tuple(getMsg(adec(~M_6,sk_otherAgent)))) = aenc(sign((n_p_14,a_7,pk(a_8)),sk_otherAgent),pk(ssk_14)) at {254} in copy a

event auth_HolderSendsLastMessageToIssuer(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_otherAgent)),aenc(sign((n_p_14,a_7,pk(a_8)),sk_otherAgent),pk(ssk_14)),aenc(sign(sign((a_7,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_otherAgent),sk_otherAgent)),sk_prover_1),ssk_14),pk(a_8))) at {263} in copy a

out(h, ~M_14) with ~M_14 = aenc(sign(sign((a_7,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_otherAgent),sk_otherAgent)),sk_prover_1),ssk_14),pk(a_8)) at {264} in copy a

in(h, aenc(sign((3-proj-3-tuple(getMsg(getMsg(adec(~M_13,a_5)))),~M_3,a_9),a_8),2-proj-2-tuple(getMsg(adec(~M_6,sk_otherAgent))))) with aenc(sign((3-proj-3-tuple(getMsg(getMsg(adec(~M_13,a_5)))),~M_3,a_9),a_8),2-proj-2-tuple(getMsg(adec(~M_6,sk_otherAgent)))) = aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),a_9),a_8),pk(ssk_14)) at {265} in copy a

new ssk_7: SecretKey creating ssk_18 at {272} in copy a, a_10

new n_p_7: bitstring creating n_p_17 at {273} in copy a, a_10

out(h, ~M_15) with ~M_15 = aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_verifier_1)) at {277} in copy a, a_10

in(h, ~M_15) with ~M_15 = aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_verifier_1)) at {399} in copy a_11

new ssk_10: SecretKey creating ssk_19 at {405} in copy a_11

new n_v_4: bitstring creating n_v_8 at {406} in copy a_11

out(h, ~M_16) with ~M_16 = aenc(sign((n_p_17,n_v_8,pk(ssk_19)),sk_verifier_1),pk(ssk_18)) at {409} in copy a_11

in(h, ~M_16) with ~M_16 = aenc(sign((n_p_17,n_v_8,pk(ssk_19)),sk_verifier_1),pk(ssk_18)) at {278} in copy a, a_10

out(h, ~M_17) with ~M_17 = aenc(sign((n_v_8,uri),ssk_18),pk(ssk_19)) at {287} in copy a, a_10

in(h, ~M_17) with ~M_17 = aenc(sign((n_v_8,uri),ssk_18),pk(ssk_19)) at {410} in copy a_11

new n_c_4: bitstring creating n_c_8 at {417} in copy a_11

out(h, ~M_18) with ~M_18 = aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_19),pk(ssk_18)) at {421} in copy a_11

in(h, ~M_18) with ~M_18 = aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_19),pk(ssk_18)) at {288} in copy a, a_10

event auth_ProverSendsLastMessageToVerifier(aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_verifier_1)),aenc(sign((n_p_17,n_v_8,pk(ssk_19)),sk_verifier_1),pk(ssk_18)),aenc(sign((n_v_8,uri),ssk_18),pk(ssk_19)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_19),pk(ssk_18)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_19))) at {297} in copy a, a_10

event auth_ProverSendsLastMessageToVerifierInProtocolFull(aenc(sign((n_p_14,pk(ssk_14)),ssk_14),pk(sk_otherAgent)),aenc(sign((n_p_14,a_7,pk(a_8)),sk_otherAgent),pk(ssk_14)),aenc(sign(sign((a_7,genDID(pk(sk_prover_1),sk_prover_1),genDID(pk(sk_otherAgent),sk_otherAgent)),sk_prover_1),ssk_14),pk(a_8)),aenc(sign((issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1),genDID(pk(sk_prover_1),sk_prover_1),a_9),a_8),pk(ssk_14)),aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_verifier_1)),aenc(sign((n_p_17,n_v_8,pk(ssk_19)),sk_verifier_1),pk(ssk_18)),aenc(sign((n_v_8,uri),ssk_18),pk(ssk_19)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_19),pk(ssk_18)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_19))) at {298} in copy a, a_10

out(h, ~M_19) with ~M_19 = aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_19)) at {299} in copy a, a_10

in(h, ~M_19) with ~M_19 = aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_19)) at {422} in copy a_11

new access_token_4: bitstring creating access_token_8 at {436} in copy a_11

event auth_VerifierSendsLastMessageToProver(aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_verifier_1)),aenc(sign((n_p_17,n_v_8,pk(ssk_19)),sk_verifier_1),pk(ssk_18)),aenc(sign((n_v_8,uri),ssk_18),pk(ssk_19)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_19),pk(ssk_18)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_19)),aenc(sign((genDID(pk(sk_prover_1),sk_prover_1),access_token_8),ssk_19),pk(ssk_18))) at {440} in copy a_11

out(h, ~M_20) with ~M_20 = aenc(sign((genDID(pk(sk_prover_1),sk_prover_1),access_token_8),ssk_19),pk(ssk_18)) at {441} in copy a_11

event auth_VerifierCompletesProtocol(aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_verifier_1)),aenc(sign((n_p_17,n_v_8,pk(ssk_19)),sk_verifier_1),pk(ssk_18)),aenc(sign((n_v_8,uri),ssk_18),pk(ssk_19)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_19),pk(ssk_18)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_19))) at {443} in copy a_11 (goal)

The event auth_VerifierCompletesProtocol(aenc(sign((n_p_17,pk(ssk_18)),ssk_18),pk(sk_verifier_1)),aenc(sign((n_p_17,n_v_8,pk(ssk_19)),sk_verifier_1),pk(ssk_18)),aenc(sign((n_v_8,uri),ssk_18),pk(ssk_19)),aenc(sign((n_c_8,makeRule(genDID(pk(sk_prover_1),sk_prover_1),attr,genDID(pk(sk_issuer_1),sk_issuer_1))),ssk_19),pk(ssk_18)),aenc(sign(sign((n_c_8,genDID(pk(sk_verifier_1),sk_verifier_1),issueVC(genDID(pk(sk_prover_1),sk_prover_1),attr,sk_issuer_1)),sk_prover_1),ssk_18),pk(ssk_19))) is executed at {443} in copy a_11.
A trace has been found.
RESULT event(auth_VerifierCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) ==> event(auth_IssuerSendsLastMessageToHolder(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred)) && event(auth_ProverSendsLastMessageToVerifierInProtocolFull(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred,m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) is false.

--------------------------------------------------------------
Verification summary:

Query not attacker(n_p_fromHolder[]) is true.

Query not attacker(n_i_fromHolder[]) is true.

Query not attacker(providingDID_fromHolder[]) is true.

Query not attacker(n_p_fromIssuer[]) is true.

Query not attacker(credIssuing_fromIssuer[]) is true.

Query not attacker(n_p_fromProver[]) is true.

Query not attacker(unsigned_vp_fromProver[]) is true.

Query not attacker(vp_fromProver[]) is true.

Query not attacker(cred_fromProver[]) is true.

Query not attacker(access_token_fromProver[]) is true.

Query not attacker(n_p_fromVerifier[]) is true.

Query not attacker(rule_fromVerifier[]) is false.

Query not attacker(credRequest_fromVerifier[]) is true.

Query not attacker(unauth_vp_fromVerifier[]) is true.

Query not attacker(vp_fromVerifier[]) is true.

Query not attacker(cred_fromVerifier[]) is false.

Query not attacker(access_token_fromVerifier[]) is true.

Query inj-event(auth_ProverCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp,m_accessToken)) ==> inj-event(auth_VerifierSendsLastMessageToProver(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp,m_accessToken)) is true.

Query inj-event(auth_VerifierCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) ==> inj-event(auth_ProverSendsLastMessageToVerifier(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) is true.

Query inj-event(auth_HolderCompletesProtocol(m_handshakeReq,m_handshakeResp,m_did,m_cred)) ==> inj-event(auth_IssuerSendsLastMessageToHolder(m_handshakeReq,m_handshakeResp,m_did,m_cred)) is true.

Query inj-event(auth_IssuerCompletesProtocol(m_handshakeReq,m_handshakeResp,m_did)) ==> inj-event(auth_HolderSendsLastMessageToIssuer(m_handshakeReq,m_handshakeResp,m_did)) is true.

Query inj-event(auth_VerifierCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) ==> inj-event(auth_ProverSendsLastMessageToVerifier(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) && inj-event(auth_IssuerSendsLastMessageToHolder(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred)) && inj-event(auth_HolderCompletesProtocol(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred)) is false.

Query event(auth_VerifierCompletesProtocol(m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) ==> event(auth_IssuerSendsLastMessageToHolder(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred)) && event(auth_ProverSendsLastMessageToVerifierInProtocolFull(m_handshakeReq_2,m_handshakeResp_2,m_did,m_cred,m_handshakeReq,m_handshakeResp,m_uri,m_rule,m_vp)) is false.

--------------------------------------------------------------

